[0m21:13:56.305308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C78B18D210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C78B1E6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C78B1E7A10>]}


============================== 21:13:56.315307 | 8a53165a-8dc9-4bec-9f8e-a1f83f5e8f9b ==============================
[0m21:13:56.315307 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:13:56.318301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m21:13:56.321303 [info ] [MainThread]: dbt version: 1.7.18
[0m21:13:56.322305 [info ] [MainThread]: python version: 3.11.7
[0m21:13:56.324311 [info ] [MainThread]: python path: C:\Users\cortesdata\anaconda3\python.exe
[0m21:13:56.327302 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m21:13:57.006272 [info ] [MainThread]: Using profiles dir at C:\Users\cortesdata\.dbt
[0m21:13:57.008274 [info ] [MainThread]: Using profiles.yml file at C:\Users\cortesdata\.dbt\profiles.yml
[0m21:13:57.009837 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\cortesdata\Documents\Prodia\prodia_dbt\dbt_project.yml
[0m21:13:57.012262 [info ] [MainThread]: adapter type: mysql
[0m21:13:57.014260 [info ] [MainThread]: adapter version: 1.7.0
[0m21:13:57.186223 [info ] [MainThread]: Configuration:
[0m21:13:57.188229 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:13:57.190224 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:13:57.191224 [info ] [MainThread]: Required dependencies:
[0m21:13:57.193228 [debug] [MainThread]: Executing "git --help"
[0m21:13:57.281671 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:13:57.283670 [debug] [MainThread]: STDERR: "b''"
[0m21:13:57.285665 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:13:57.288675 [info ] [MainThread]: Connection:
[0m21:13:57.290672 [info ] [MainThread]:   server: localhost
[0m21:13:57.292672 [info ] [MainThread]:   unix_socket: None
[0m21:13:57.294679 [info ] [MainThread]:   port: 3306
[0m21:13:57.296669 [info ] [MainThread]:   database: None
[0m21:13:57.298664 [info ] [MainThread]:   schema: prodia_test
[0m21:13:57.300679 [info ] [MainThread]:   user: admin
[0m21:13:57.303679 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m21:13:57.307687 [debug] [MainThread]: Acquiring new mysql connection 'debug'
[0m21:13:57.309669 [debug] [MainThread]: Using mysql connection "debug"
[0m21:13:57.312676 [debug] [MainThread]: On debug: select 1 as id
[0m21:13:57.313667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:57.367881 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:13:57.369877 [debug] [MainThread]: On debug: Close
[0m21:13:57.371887 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:13:57.373885 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:13:57.376899 [debug] [MainThread]: Command `dbt debug` succeeded at 21:13:57.376899 after 1.24 seconds
[0m21:13:57.378886 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:13:57.379882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C78B67D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C783EA6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C78B4B6C10>]}
[0m21:13:57.381886 [debug] [MainThread]: Flushing usage events
[0m21:29:51.841058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B066A6AA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06673DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06673D910>]}


============================== 21:29:51.850056 | ef964f66-da8b-4cef-9a1b-5773a668134e ==============================
[0m21:29:51.850056 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:29:51.852058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models staging.my_table', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:29:52.942904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef964f66-da8b-4cef-9a1b-5773a668134e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B067028790>]}
[0m21:29:53.076540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef964f66-da8b-4cef-9a1b-5773a668134e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0670427D0>]}
[0m21:29:53.079536 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m21:29:53.099519 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:29:53.349115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:53.350118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:53.363117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef964f66-da8b-4cef-9a1b-5773a668134e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B067029F50>]}
[0m21:29:53.387969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef964f66-da8b-4cef-9a1b-5773a668134e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B068105D90>]}
[0m21:29:53.389971 [info ] [MainThread]: Found 3 models, 4 tests, 5 seeds, 1 source, 0 exposures, 0 metrics, 385 macros, 0 groups, 0 semantic models
[0m21:29:53.391965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef964f66-da8b-4cef-9a1b-5773a668134e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B066F7DA90>]}
[0m21:29:53.393965 [info ] [MainThread]: 
[0m21:29:53.396473 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m21:29:53.400488 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m21:29:53.424098 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m21:29:53.426097 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "prodia_dbt", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m21:29:53.427100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:53.457596 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m21:29:53.461620 [debug] [ThreadPool]: On list_schemas: Close
[0m21:29:53.466611 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_prodia_test'
[0m21:29:53.479620 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m21:29:53.480596 [debug] [ThreadPool]: On list_None_prodia_test: BEGIN
[0m21:29:53.481611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:53.492599 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.493611 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m21:29:53.495611 [debug] [ThreadPool]: On list_None_prodia_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "prodia_dbt", "target_name": "dev", "connection_name": "list_None_prodia_test"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'prodia_test'
  
[0m21:29:53.502614 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m21:29:53.505620 [debug] [ThreadPool]: On list_None_prodia_test: ROLLBACK
[0m21:29:53.507621 [debug] [ThreadPool]: On list_None_prodia_test: Close
[0m21:29:53.511611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef964f66-da8b-4cef-9a1b-5773a668134e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0664BC5D0>]}
[0m21:29:53.513624 [debug] [MainThread]: Using mysql connection "master"
[0m21:29:53.514611 [debug] [MainThread]: On master: BEGIN
[0m21:29:53.515620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:53.527808 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.528840 [debug] [MainThread]: On master: COMMIT
[0m21:29:53.529838 [debug] [MainThread]: Using mysql connection "master"
[0m21:29:53.530849 [debug] [MainThread]: On master: COMMIT
[0m21:29:53.534257 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.535253 [debug] [MainThread]: On master: Close
[0m21:29:53.537265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:53.539256 [info ] [MainThread]: 
[0m21:29:53.548345 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_table
[0m21:29:53.550355 [info ] [Thread-1 (]: 1 of 1 START sql view model prodia_test.my_table ............................... [RUN]
[0m21:29:53.552325 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.prodia_dbt.my_table'
[0m21:29:53.554340 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_table
[0m21:29:53.571344 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_table"
[0m21:29:53.576347 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_table (compile): 21:29:53.554340 => 21:29:53.575326
[0m21:29:53.577343 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_table
[0m21:29:53.656076 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_table"
[0m21:29:53.661050 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_table"
[0m21:29:53.662069 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: BEGIN
[0m21:29:53.664053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:53.676078 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.677065 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_table"
[0m21:29:53.678066 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "prodia_dbt", "target_name": "dev", "node_id": "model.prodia_dbt.my_table"} */

  create view `prodia_test`.`my_table__dbt_tmp`
    
    
  as (
    -- models/staging/my_table.sql

with source_data as (

    select *
    from `prodia_test`.`patients`

)

select *
from source_data
  );
[0m21:29:53.698183 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.713238 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_table"
[0m21:29:53.715220 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "prodia_dbt", "target_name": "dev", "node_id": "model.prodia_dbt.my_table"} */

    drop view if exists `prodia_test`.`my_table` cascade
  
[0m21:29:53.721220 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.724238 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_table"
[0m21:29:53.726244 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "prodia_dbt", "target_name": "dev", "node_id": "model.prodia_dbt.my_table"} */

    rename table `prodia_test`.`my_table__dbt_tmp` to `prodia_test`.`my_table`
  
[0m21:29:53.734860 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.773876 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: COMMIT
[0m21:29:53.774877 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_table"
[0m21:29:53.776876 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: COMMIT
[0m21:29:53.778854 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.864525 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_table"
[0m21:29:53.865527 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "prodia_dbt", "target_name": "dev", "node_id": "model.prodia_dbt.my_table"} */
drop view if exists `prodia_test`.`my_table__dbt_backup`
[0m21:29:53.869525 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.873524 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_table (execute): 21:29:53.578343 => 21:29:53.872525
[0m21:29:53.874524 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: Close
[0m21:29:53.877528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef964f66-da8b-4cef-9a1b-5773a668134e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06829A9D0>]}
[0m21:29:53.878525 [info ] [Thread-1 (]: 1 of 1 OK created sql view model prodia_test.my_table .......................... [[32mSUCCESS 0[0m in 0.33s]
[0m21:29:53.881525 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_table
[0m21:29:53.884523 [debug] [MainThread]: Using mysql connection "master"
[0m21:29:53.886520 [debug] [MainThread]: On master: BEGIN
[0m21:29:53.887525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:53.898525 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.899532 [debug] [MainThread]: On master: COMMIT
[0m21:29:53.901525 [debug] [MainThread]: Using mysql connection "master"
[0m21:29:53.902524 [debug] [MainThread]: On master: COMMIT
[0m21:29:53.904528 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m21:29:53.905525 [debug] [MainThread]: On master: Close
[0m21:29:53.907525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:53.909519 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m21:29:53.910522 [debug] [MainThread]: Connection 'list_None_prodia_test' was properly closed.
[0m21:29:53.911525 [debug] [MainThread]: Connection 'model.prodia_dbt.my_table' was properly closed.
[0m21:29:53.912527 [info ] [MainThread]: 
[0m21:29:53.913520 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m21:29:53.916526 [debug] [MainThread]: Command end result
[0m21:29:53.937060 [info ] [MainThread]: 
[0m21:29:53.938737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:53.941737 [info ] [MainThread]: 
[0m21:29:53.943743 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:29:53.946749 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:53.946749 after 2.24 seconds
[0m21:29:53.948737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0668A7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F95B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06673E310>]}
[0m21:29:53.950739 [debug] [MainThread]: Flushing usage events
[0m22:32:45.412474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C43FB810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C43FA750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C43FBE10>]}


============================== 22:32:45.422876 | 1754aa17-2a3d-4661-bf54-794a18c58de1 ==============================
[0m22:32:45.422876 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:32:45.425865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target prod --models staging.my_table', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:32:45.480217 [error] [MainThread]: Encountered an error:
Couldn't build proto file into descriptor pool: duplicate file name types.proto
[0m22:32:45.505204 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 166, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\config\runtime.py", line 70, in load_profile
    profile = Profile.render(
              ^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\config\profile.py", line 399, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\config\profile.py", line 365, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\config\profile.py", line 321, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\config\profile.py", line 145, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\adapters\factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\adapters\factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\adapters\postgres\__init__.py", line 4, in <module>
    from dbt.adapters.postgres.connections import PostgresConnectionManager, PostgresCredentials
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\adapters\postgres\connections.py", line 5, in <module>
    from dbt.adapters.contracts.connection import AdapterResponse, Credentials
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\adapters\contracts\connection.py", line 24, in <module>
    from dbt_common.events.contextvars import get_node_info
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt_common\events\__init__.py", line 1, in <module>
    from dbt_common.events.base_types import EventLevel
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt_common\events\base_types.py", line 4, in <module>
    from dbt_common.events import types_pb2
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt_common\events\types_pb2.py", line 17, in <module>
    DESCRIPTOR = _descriptor_pool.Default().AddSerializedFile(b'\n\x0btypes.proto\x12\x0bproto_types\x1a\x1fgoogle/protobuf/timestamp.proto\"\x91\x02\n\tEventInfo\x12\x0c\n\x04name\x18\x01 \x01(\t\x12\x0c\n\x04\x63ode\x18\x02 \x01(\t\x12\x0b\n\x03msg\x18\x03 \x01(\t\x12\r\n\x05level\x18\x04 \x01(\t\x12\x15\n\rinvocation_id\x18\x05 \x01(\t\x12\x0b\n\x03pid\x18\x06 \x01(\x05\x12\x0e\n\x06thread\x18\x07 \x01(\t\x12&\n\x02ts\x18\x08 \x01(\x0b\x32\x1a.google.protobuf.Timestamp\x12\x30\n\x05\x65xtra\x18\t \x03(\x0b\x32!.proto_types.EventInfo.ExtraEntry\x12\x10\n\x08\x63\x61tegory\x18\n \x01(\t\x1a,\n\nExtraEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12\r\n\x05value\x18\x02 \x01(\t:\x02\x38\x01\"6\n\x0eGenericMessage\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\"1\n\x11RetryExternalCall\x12\x0f\n\x07\x61ttempt\x18\x01 \x01(\x05\x12\x0b\n\x03max\x18\x02 \x01(\x05\"j\n\x14RetryExternalCallMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12,\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x1e.proto_types.RetryExternalCall\"#\n\x14RecordRetryException\x12\x0b\n\x03\x65xc\x18\x01 \x01(\t\"p\n\x17RecordRetryExceptionMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12/\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32!.proto_types.RecordRetryException\"@\n\x13SystemCouldNotWrite\x12\x0c\n\x04path\x18\x01 \x01(\t\x12\x0e\n\x06reason\x18\x02 \x01(\t\x12\x0b\n\x03\x65xc\x18\x03 \x01(\t\"n\n\x16SystemCouldNotWriteMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12.\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32 .proto_types.SystemCouldNotWrite\"!\n\x12SystemExecutingCmd\x12\x0b\n\x03\x63md\x18\x01 \x03(\t\"l\n\x15SystemExecutingCmdMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12-\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x1f.proto_types.SystemExecutingCmd\"\x1c\n\x0cSystemStdOut\x12\x0c\n\x04\x62msg\x18\x01 \x01(\t\"`\n\x0fSystemStdOutMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12\'\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x19.proto_types.SystemStdOut\"\x1c\n\x0cSystemStdErr\x12\x0c\n\x04\x62msg\x18\x01 \x01(\t\"`\n\x0fSystemStdErrMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12\'\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x19.proto_types.SystemStdErr\",\n\x16SystemReportReturnCode\x12\x12\n\nreturncode\x18\x01 \x01(\x05\"t\n\x19SystemReportReturnCodeMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12\x31\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32#.proto_types.SystemReportReturnCode\"\x19\n\nFormatting\x12\x0b\n\x03msg\x18\x01 \x01(\t\"\\\n\rFormattingMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12%\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x17.proto_types.Formatting\"\x13\n\x04Note\x12\x0b\n\x03msg\x18\x01 \x01(\t\"P\n\x07NoteMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12\x1f\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x11.proto_types.Noteb\x06proto3')
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Couldn't build proto file into descriptor pool: duplicate file name types.proto

[0m22:32:45.514435 [debug] [MainThread]: Command `dbt run` failed at 22:32:45.513436 after 0.26 seconds
[0m22:32:45.516434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C43F8B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C40463D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C4464510>]}
[0m22:32:45.518436 [debug] [MainThread]: Flushing usage events
[0m22:34:21.709910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C3148090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C3148110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C3149210>]}


============================== 22:34:21.721099 | b1e357eb-98de-48f1-96ef-a2c320393863 ==============================
[0m22:34:21.721099 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:34:21.723305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --target prod', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:21.726099 [info ] [MainThread]: dbt version: 1.7.18
[0m22:34:21.728150 [info ] [MainThread]: python version: 3.11.7
[0m22:34:21.729975 [info ] [MainThread]: python path: C:\Users\cortesdata\anaconda3\python.exe
[0m22:34:21.732414 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:34:21.782491 [error] [MainThread]: Encountered an error:
Couldn't build proto file into descriptor pool: duplicate file name types.proto
[0m22:34:21.805282 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\cli\main.py", line 445, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\task\debug.py", line 123, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\task\debug.py", line 212, in _load_profile
    profile: Profile = Profile.render(
                       ^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\config\profile.py", line 399, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\config\profile.py", line 365, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\config\profile.py", line 321, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\config\profile.py", line 145, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\adapters\factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\adapters\factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cortesdata\anaconda3\Lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\adapters\postgres\__init__.py", line 4, in <module>
    from dbt.adapters.postgres.connections import PostgresConnectionManager, PostgresCredentials
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\adapters\postgres\connections.py", line 5, in <module>
    from dbt.adapters.contracts.connection import AdapterResponse, Credentials
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt\adapters\contracts\connection.py", line 24, in <module>
    from dbt_common.events.contextvars import get_node_info
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt_common\events\__init__.py", line 1, in <module>
    from dbt_common.events.base_types import EventLevel
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt_common\events\base_types.py", line 4, in <module>
    from dbt_common.events import types_pb2
  File "C:\Users\cortesdata\anaconda3\Lib\site-packages\dbt_common\events\types_pb2.py", line 17, in <module>
    DESCRIPTOR = _descriptor_pool.Default().AddSerializedFile(b'\n\x0btypes.proto\x12\x0bproto_types\x1a\x1fgoogle/protobuf/timestamp.proto\"\x91\x02\n\tEventInfo\x12\x0c\n\x04name\x18\x01 \x01(\t\x12\x0c\n\x04\x63ode\x18\x02 \x01(\t\x12\x0b\n\x03msg\x18\x03 \x01(\t\x12\r\n\x05level\x18\x04 \x01(\t\x12\x15\n\rinvocation_id\x18\x05 \x01(\t\x12\x0b\n\x03pid\x18\x06 \x01(\x05\x12\x0e\n\x06thread\x18\x07 \x01(\t\x12&\n\x02ts\x18\x08 \x01(\x0b\x32\x1a.google.protobuf.Timestamp\x12\x30\n\x05\x65xtra\x18\t \x03(\x0b\x32!.proto_types.EventInfo.ExtraEntry\x12\x10\n\x08\x63\x61tegory\x18\n \x01(\t\x1a,\n\nExtraEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12\r\n\x05value\x18\x02 \x01(\t:\x02\x38\x01\"6\n\x0eGenericMessage\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\"1\n\x11RetryExternalCall\x12\x0f\n\x07\x61ttempt\x18\x01 \x01(\x05\x12\x0b\n\x03max\x18\x02 \x01(\x05\"j\n\x14RetryExternalCallMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12,\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x1e.proto_types.RetryExternalCall\"#\n\x14RecordRetryException\x12\x0b\n\x03\x65xc\x18\x01 \x01(\t\"p\n\x17RecordRetryExceptionMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12/\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32!.proto_types.RecordRetryException\"@\n\x13SystemCouldNotWrite\x12\x0c\n\x04path\x18\x01 \x01(\t\x12\x0e\n\x06reason\x18\x02 \x01(\t\x12\x0b\n\x03\x65xc\x18\x03 \x01(\t\"n\n\x16SystemCouldNotWriteMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12.\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32 .proto_types.SystemCouldNotWrite\"!\n\x12SystemExecutingCmd\x12\x0b\n\x03\x63md\x18\x01 \x03(\t\"l\n\x15SystemExecutingCmdMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12-\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x1f.proto_types.SystemExecutingCmd\"\x1c\n\x0cSystemStdOut\x12\x0c\n\x04\x62msg\x18\x01 \x01(\t\"`\n\x0fSystemStdOutMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12\'\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x19.proto_types.SystemStdOut\"\x1c\n\x0cSystemStdErr\x12\x0c\n\x04\x62msg\x18\x01 \x01(\t\"`\n\x0fSystemStdErrMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12\'\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x19.proto_types.SystemStdErr\",\n\x16SystemReportReturnCode\x12\x12\n\nreturncode\x18\x01 \x01(\x05\"t\n\x19SystemReportReturnCodeMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12\x31\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32#.proto_types.SystemReportReturnCode\"\x19\n\nFormatting\x12\x0b\n\x03msg\x18\x01 \x01(\t\"\\\n\rFormattingMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12%\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x17.proto_types.Formatting\"\x13\n\x04Note\x12\x0b\n\x03msg\x18\x01 \x01(\t\"P\n\x07NoteMsg\x12$\n\x04info\x18\x01 \x01(\x0b\x32\x16.proto_types.EventInfo\x12\x1f\n\x04\x64\x61ta\x18\x02 \x01(\x0b\x32\x11.proto_types.Noteb\x06proto3')
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Couldn't build proto file into descriptor pool: duplicate file name types.proto

[0m22:34:21.814653 [debug] [MainThread]: Command `dbt debug` failed at 22:34:21.814121 after 0.27 seconds
[0m22:34:21.816123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C319FB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C3148C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C2D96850>]}
[0m22:34:21.818530 [debug] [MainThread]: Flushing usage events
[0m22:38:52.194747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B2929590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B2929810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B2928AD0>]}


============================== 22:38:52.201294 | 56dde690-31c7-40de-ac70-ef7e459ce636 ==============================
[0m22:38:52.201294 [info ] [MainThread]: Running with dbt=1.5.0
[0m22:38:52.203634 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True'}
[0m22:38:52.206105 [info ] [MainThread]: dbt version: 1.5.0
[0m22:38:52.208235 [info ] [MainThread]: python version: 3.11.7
[0m22:38:52.210231 [info ] [MainThread]: python path: C:\Users\cortesdata\anaconda3\python.exe
[0m22:38:52.213231 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:38:52.215624 [info ] [MainThread]: Using profiles.yml file at C:\Users\cortesdata\.dbt\profiles.yml
[0m22:38:52.217622 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\cortesdata\Documents\Prodia\prodia_dbt\dbt_project.yml
[0m22:38:52.220924 [info ] [MainThread]: Configuration:
[0m22:38:52.458365 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:38:52.531104 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:38:52.533320 [info ] [MainThread]: Required dependencies:
[0m22:38:52.534638 [debug] [MainThread]: Executing "git --help"
[0m22:38:52.627393 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:38:52.628395 [debug] [MainThread]: STDERR: "b''"
[0m22:38:52.630394 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:38:52.632677 [info ] [MainThread]: Connection:
[0m22:38:52.634855 [info ] [MainThread]:   host: localhost
[0m22:38:52.637367 [info ] [MainThread]:   port: 5432
[0m22:38:52.639364 [info ] [MainThread]:   user: postgres
[0m22:38:52.641806 [info ] [MainThread]:   database: prodia_test
[0m22:38:52.643254 [info ] [MainThread]:   schema: public
[0m22:38:52.645973 [info ] [MainThread]:   search_path: None
[0m22:38:52.648342 [info ] [MainThread]:   keepalives_idle: 0
[0m22:38:52.651033 [info ] [MainThread]:   sslmode: None
[0m22:38:52.654337 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:38:52.655659 [debug] [MainThread]: Using postgres connection "debug"
[0m22:38:52.656966 [debug] [MainThread]: On debug: select 1 as id
[0m22:38:52.658423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:38:52.830510 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:52.833540 [debug] [MainThread]: On debug: Close
[0m22:38:52.834544 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:38:52.836900 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:38:52.839134 [debug] [MainThread]: Command `dbt debug` succeeded at 22:38:52.839134 after 0.69 seconds
[0m22:38:52.840153 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:38:52.841197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B157CDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5ABC0BA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5ABCA4650>]}
[0m22:38:52.842201 [debug] [MainThread]: Flushing usage events
[0m22:39:10.638628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B17057DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B17057E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B17057D110>]}


============================== 22:39:10.644401 | 90445b6d-335a-467c-9919-fefe2c88eabb ==============================
[0m22:39:10.644401 [info ] [MainThread]: Running with dbt=1.5.0
[0m22:39:10.647471 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m22:39:10.952023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90445b6d-335a-467c-9919-fefe2c88eabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B16F103AD0>]}
[0m22:39:11.005600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90445b6d-335a-467c-9919-fefe2c88eabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B16F103AD0>]}
[0m22:39:11.036174 [debug] [MainThread]: checksum: 2b6fdde617d5a0a990757f78fa0717194984bf092aff54287207b08feaec457a, vars: {}, profile: , target: prod, version: 1.5.0
[0m22:39:11.171228 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:39:11.173370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90445b6d-335a-467c-9919-fefe2c88eabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1707563D0>]}
[0m22:39:13.072091 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m22:39:13.107555 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m22:39:13.117764 [debug] [MainThread]: 1699: static parser successfully parsed staging\my_table.sql
[0m22:39:13.592115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90445b6d-335a-467c-9919-fefe2c88eabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B170627D90>]}
[0m22:39:13.612545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90445b6d-335a-467c-9919-fefe2c88eabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B17081C4D0>]}
[0m22:39:13.615539 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 5 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m22:39:13.618869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90445b6d-335a-467c-9919-fefe2c88eabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1707A8190>]}
[0m22:39:13.625196 [info ] [MainThread]: 
[0m22:39:13.628699 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:39:13.633289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test'
[0m22:39:13.662191 [debug] [ThreadPool]: Using postgres connection "list_prodia_test"
[0m22:39:13.664184 [debug] [ThreadPool]: On list_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "prod", "connection_name": "list_prodia_test"} */

    select distinct nspname from pg_namespace
  
[0m22:39:13.665287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:13.756403 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:39:13.759424 [debug] [ThreadPool]: On list_prodia_test: Close
[0m22:39:13.764200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test_public'
[0m22:39:13.780496 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m22:39:13.781614 [debug] [ThreadPool]: On list_prodia_test_public: BEGIN
[0m22:39:13.782793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:13.868473 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:39:13.870450 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m22:39:13.871457 [debug] [ThreadPool]: On list_prodia_test_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "prod", "connection_name": "list_prodia_test_public"} */
select
      'prodia_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'prodia_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:39:13.887811 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:39:13.892813 [debug] [ThreadPool]: On list_prodia_test_public: ROLLBACK
[0m22:39:13.894807 [debug] [ThreadPool]: On list_prodia_test_public: Close
[0m22:39:13.908136 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:13.909341 [debug] [MainThread]: On master: BEGIN
[0m22:39:13.910586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:14.063947 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:39:14.066046 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:14.068409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:39:14.095329 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:39:14.098940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90445b6d-335a-467c-9919-fefe2c88eabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1707BBCD0>]}
[0m22:39:14.099958 [debug] [MainThread]: On master: ROLLBACK
[0m22:39:14.102354 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:14.103348 [debug] [MainThread]: On master: BEGIN
[0m22:39:14.105346 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:39:14.107600 [debug] [MainThread]: On master: COMMIT
[0m22:39:14.108596 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:14.110595 [debug] [MainThread]: On master: COMMIT
[0m22:39:14.112604 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:39:14.113970 [debug] [MainThread]: On master: Close
[0m22:39:14.117463 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:39:14.119938 [info ] [MainThread]: 
[0m22:39:14.135144 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_table
[0m22:39:14.138007 [info ] [Thread-1 (]: 1 of 1 START sql table model public.my_table ................................... [RUN]
[0m22:39:14.141371 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.prodia_dbt.my_table'
[0m22:39:14.142366 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_table
[0m22:39:14.149904 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_table"
[0m22:39:14.154034 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_table (compile): 22:39:14.143373 => 22:39:14.153026
[0m22:39:14.156032 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_table
[0m22:39:14.263384 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_table"
[0m22:39:14.266392 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_table"
[0m22:39:14.266392 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: BEGIN
[0m22:39:14.268840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:39:14.346264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:39:14.348264 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_table"
[0m22:39:14.349265 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "prod", "node_id": "model.prodia_dbt.my_table"} */

  
    

  create  table "prodia_test"."public"."my_table__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/my_table.sql

with source_data as (

    select *
    from "prodia_test"."prodia_test"."patients"

)

select *
from source_data
  );
  
[0m22:39:14.360548 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.patients" does not exist
LINE 17:     from "prodia_test"."prodia_test"."patients"
                  ^

[0m22:39:14.362665 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: ROLLBACK
[0m22:39:14.364110 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_table (execute): 22:39:14.157114 => 22:39:14.364110
[0m22:39:14.366495 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: Close
[0m22:39:14.388198 [debug] [Thread-1 (]: Database Error in model my_table (models\staging\my_table.sql)
  relation "prodia_test.patients" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."patients"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\my_table.sql
[0m22:39:14.389886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90445b6d-335a-467c-9919-fefe2c88eabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B17085ACD0>]}
[0m22:39:14.390886 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.my_table .......................... [[31mERROR[0m in 0.25s]
[0m22:39:14.394277 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_table
[0m22:39:14.397768 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:14.398767 [debug] [MainThread]: On master: BEGIN
[0m22:39:14.399773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:39:14.505748 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:39:14.507576 [debug] [MainThread]: On master: COMMIT
[0m22:39:14.509291 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:14.510965 [debug] [MainThread]: On master: COMMIT
[0m22:39:14.512912 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:39:14.514643 [debug] [MainThread]: On master: Close
[0m22:39:14.517545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:14.520079 [debug] [MainThread]: Connection 'list_prodia_test' was properly closed.
[0m22:39:14.522498 [debug] [MainThread]: Connection 'list_prodia_test_public' was properly closed.
[0m22:39:14.523571 [debug] [MainThread]: Connection 'model.prodia_dbt.my_table' was properly closed.
[0m22:39:14.525865 [info ] [MainThread]: 
[0m22:39:14.528651 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m22:39:14.531680 [debug] [MainThread]: Command end result
[0m22:39:14.563381 [info ] [MainThread]: 
[0m22:39:14.568645 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:39:14.574396 [info ] [MainThread]: 
[0m22:39:14.580434 [error] [MainThread]: [33mDatabase Error in model my_table (models\staging\my_table.sql)[0m
[0m22:39:14.587397 [error] [MainThread]:   relation "prodia_test.patients" does not exist
[0m22:39:14.593493 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."patients"
[0m22:39:14.600704 [error] [MainThread]:                     ^
[0m22:39:14.604835 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\my_table.sql
[0m22:39:14.608664 [info ] [MainThread]: 
[0m22:39:14.612837 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:39:14.625939 [debug] [MainThread]: Command `dbt run` failed at 22:39:14.625939 after 4.03 seconds
[0m22:39:14.629502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B169930810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B170573310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B170570A50>]}
[0m22:39:14.634875 [debug] [MainThread]: Flushing usage events
[0m22:46:54.566340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330AFDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330AFE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330AFE390>]}


============================== 22:46:54.576500 | 1c3781cc-1dbc-42d1-a5f2-4d1037d7972f ==============================
[0m22:46:54.576500 [info ] [MainThread]: Running with dbt=1.5.0
[0m22:46:54.580307 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'quiet': 'False', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs'}
[0m22:46:54.876710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c3781cc-1dbc-42d1-a5f2-4d1037d7972f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001732F693950>]}
[0m22:46:54.936280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c3781cc-1dbc-42d1-a5f2-4d1037d7972f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330B8A410>]}
[0m22:46:54.976694 [debug] [MainThread]: checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, vars: {}, profile: , target: postgres, version: 1.5.0
[0m22:46:55.119913 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:46:55.122449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c3781cc-1dbc-42d1-a5f2-4d1037d7972f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330CAE650>]}
[0m22:46:57.018165 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m22:46:57.052960 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m22:46:57.061960 [debug] [MainThread]: 1699: static parser successfully parsed staging\my_table.sql
[0m22:46:57.495202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c3781cc-1dbc-42d1-a5f2-4d1037d7972f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330B07290>]}
[0m22:46:57.513244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c3781cc-1dbc-42d1-a5f2-4d1037d7972f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330D6F410>]}
[0m22:46:57.515512 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 5 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m22:46:57.517936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c3781cc-1dbc-42d1-a5f2-4d1037d7972f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330D25190>]}
[0m22:46:57.522244 [info ] [MainThread]: 
[0m22:46:57.526361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:46:57.531496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test'
[0m22:46:57.564617 [debug] [ThreadPool]: Using postgres connection "list_prodia_test"
[0m22:46:57.565637 [debug] [ThreadPool]: On list_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test"} */

    select distinct nspname from pg_namespace
  
[0m22:46:57.566618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:57.663627 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:46:57.667765 [debug] [ThreadPool]: On list_prodia_test: Close
[0m22:46:57.673591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test_public'
[0m22:46:57.691917 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m22:46:57.692935 [debug] [ThreadPool]: On list_prodia_test_public: BEGIN
[0m22:46:57.695122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:57.783266 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:46:57.784283 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m22:46:57.785715 [debug] [ThreadPool]: On list_prodia_test_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test_public"} */
select
      'prodia_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'prodia_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:46:57.800638 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:46:57.803134 [debug] [ThreadPool]: On list_prodia_test_public: ROLLBACK
[0m22:46:57.805193 [debug] [ThreadPool]: On list_prodia_test_public: Close
[0m22:46:57.817621 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:57.818624 [debug] [MainThread]: On master: BEGIN
[0m22:46:57.820232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:57.908670 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:46:57.909671 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:57.911671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:46:57.930938 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:46:57.934293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c3781cc-1dbc-42d1-a5f2-4d1037d7972f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330C64250>]}
[0m22:46:57.935317 [debug] [MainThread]: On master: ROLLBACK
[0m22:46:57.936316 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:57.937680 [debug] [MainThread]: On master: BEGIN
[0m22:46:57.939722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:46:57.940841 [debug] [MainThread]: On master: COMMIT
[0m22:46:57.941823 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:57.942812 [debug] [MainThread]: On master: COMMIT
[0m22:46:57.945043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:46:57.946048 [debug] [MainThread]: On master: Close
[0m22:46:57.948550 [info ] [MainThread]: Concurrency: 1 threads (target='postgres')
[0m22:46:57.949824 [info ] [MainThread]: 
[0m22:46:57.963244 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m22:46:57.965233 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:46:57.969832 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.prodia_dbt.my_first_dbt_model'
[0m22:46:57.970900 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m22:46:57.977953 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m22:46:57.982669 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 22:46:57.971919 => 22:46:57.981669
[0m22:46:57.984714 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m22:46:58.097436 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m22:46:58.101433 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m22:46:58.104437 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m22:46:58.106965 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:46:58.205128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:58.206710 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m22:46:58.208697 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table "prodia_test"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:46:58.230426 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m22:46:58.254324 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m22:46:58.256360 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:46:58.261839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:58.321636 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m22:46:58.322640 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m22:46:58.324879 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m22:46:58.328264 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:46:58.341646 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m22:46:58.343654 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists "prodia_test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:46:58.346651 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:46:58.350631 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 22:46:57.986105 => 22:46:58.349646
[0m22:46:58.351654 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m22:46:58.355369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c3781cc-1dbc-42d1-a5f2-4d1037d7972f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330D64410>]}
[0m22:46:58.357354 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.39s]
[0m22:46:58.360855 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m22:46:58.363008 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_table
[0m22:46:58.365451 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_table ................................... [RUN]
[0m22:46:58.368429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.my_table)
[0m22:46:58.371074 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_table
[0m22:46:58.379133 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_table"
[0m22:46:58.383435 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_table (compile): 22:46:58.372074 => 22:46:58.382426
[0m22:46:58.385424 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_table
[0m22:46:58.399277 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_table"
[0m22:46:58.401952 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_table"
[0m22:46:58.402968 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: BEGIN
[0m22:46:58.404340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:58.481072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:58.483077 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_table"
[0m22:46:58.484252 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_table"} */

  
    

  create  table "prodia_test"."public"."my_table__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/my_table.sql

with source_data as (

    select *
    from "prodia_test"."prodia_test"."patients"

)

select *
from source_data
  );
  
[0m22:46:58.486450 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.patients" does not exist
LINE 17:     from "prodia_test"."prodia_test"."patients"
                  ^

[0m22:46:58.488470 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: ROLLBACK
[0m22:46:58.490474 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_table (execute): 22:46:58.386781 => 22:46:58.489466
[0m22:46:58.492471 [debug] [Thread-1 (]: On model.prodia_dbt.my_table: Close
[0m22:46:58.512420 [debug] [Thread-1 (]: Database Error in model my_table (models\staging\my_table.sql)
  relation "prodia_test.patients" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."patients"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\my_table.sql
[0m22:46:58.513481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c3781cc-1dbc-42d1-a5f2-4d1037d7972f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330CF3750>]}
[0m22:46:58.516768 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.my_table .......................... [[31mERROR[0m in 0.15s]
[0m22:46:58.519793 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_table
[0m22:46:58.522018 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m22:46:58.524018 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m22:46:58.527018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_table, now model.prodia_dbt.my_second_dbt_model)
[0m22:46:58.529023 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m22:46:58.535997 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m22:46:58.540005 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 22:46:58.530025 => 22:46:58.538998
[0m22:46:58.541927 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m22:46:58.603175 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m22:46:58.607173 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m22:46:58.608172 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m22:46:58.609172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:58.694173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:58.696176 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m22:46:58.697175 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view "prodia_test"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "prodia_test"."public"."my_first_dbt_model"
where id = 1
  );
[0m22:46:58.714170 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:46:58.723900 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m22:46:58.726277 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
alter table "prodia_test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:46:58.729246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:58.735533 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m22:46:58.737538 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m22:46:58.739538 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m22:46:58.743540 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:46:58.752290 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m22:46:58.754292 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists "prodia_test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:46:58.756290 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:46:58.762292 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 22:46:58.543076 => 22:46:58.761290
[0m22:46:58.764290 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m22:46:58.766291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c3781cc-1dbc-42d1-a5f2-4d1037d7972f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330CE2690>]}
[0m22:46:58.769287 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:46:58.772290 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m22:46:58.777290 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:58.778943 [debug] [MainThread]: On master: BEGIN
[0m22:46:58.779981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:58.860685 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:46:58.862854 [debug] [MainThread]: On master: COMMIT
[0m22:46:58.863859 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:58.864841 [debug] [MainThread]: On master: COMMIT
[0m22:46:58.866839 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:46:58.867856 [debug] [MainThread]: On master: Close
[0m22:46:58.869857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:58.870845 [debug] [MainThread]: Connection 'list_prodia_test' was properly closed.
[0m22:46:58.873211 [debug] [MainThread]: Connection 'list_prodia_test_public' was properly closed.
[0m22:46:58.874361 [debug] [MainThread]: Connection 'model.prodia_dbt.my_second_dbt_model' was properly closed.
[0m22:46:58.875726 [info ] [MainThread]: 
[0m22:46:58.877769 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m22:46:58.881125 [debug] [MainThread]: Command end result
[0m22:46:58.900057 [info ] [MainThread]: 
[0m22:46:58.902426 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:46:58.904571 [info ] [MainThread]: 
[0m22:46:58.906577 [error] [MainThread]: [33mDatabase Error in model my_table (models\staging\my_table.sql)[0m
[0m22:46:58.908556 [error] [MainThread]:   relation "prodia_test.patients" does not exist
[0m22:46:58.910558 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."patients"
[0m22:46:58.913348 [error] [MainThread]:                     ^
[0m22:46:58.916332 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\my_table.sql
[0m22:46:58.918333 [info ] [MainThread]: 
[0m22:46:58.921329 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:46:58.924346 [debug] [MainThread]: Command `dbt run` failed at 22:46:58.924346 after 4.45 seconds
[0m22:46:58.925346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017330AFAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017329E24710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017329E24650>]}
[0m22:46:58.927331 [debug] [MainThread]: Flushing usage events
[0m00:10:50.436933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021754E8DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021754E8FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021754E8D690>]}


============================== 00:10:50.445015 | 41a2de56-31f9-4af7-8b24-3e0dca3a6ac6 ==============================
[0m00:10:50.445015 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:10:50.447020 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default'}
[0m00:10:50.716667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41a2de56-31f9-4af7-8b24-3e0dca3a6ac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021753A13E90>]}
[0m00:10:50.767030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41a2de56-31f9-4af7-8b24-3e0dca3a6ac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021753A13E90>]}
[0m00:10:50.797009 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m00:10:51.087115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m00:10:51.089119 [debug] [MainThread]: Partial parsing: added file: prodia_dbt://models\datamart\dm_patient_overview.sql
[0m00:10:51.090119 [debug] [MainThread]: Partial parsing: added file: prodia_dbt://models\datamart\dm_appointment_summary.sql
[0m00:10:51.091117 [debug] [MainThread]: Partial parsing: added file: prodia_dbt://models\intermediate\int_invoice_summary.sql
[0m00:10:51.093118 [debug] [MainThread]: Partial parsing: added file: prodia_dbt://models\intermediate\int_appointment_details.sql
[0m00:10:51.094111 [debug] [MainThread]: Partial parsing: updated file: prodia_dbt://models\intermediate\int_patient_summary.sql
[0m00:10:51.162456 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m00:10:51.195800 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m00:10:51.204190 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m00:10:51.213163 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m00:10:51.222225 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m00:10:51.227677 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.prodia_dbt.int_invoice_summary' (models\intermediate\int_invoice_summary.sql) depends on a node named 'stg_invoices' which was not found
[0m00:10:51.233970 [debug] [MainThread]: Command `dbt run` failed at 00:10:51.229654 after 0.83 seconds
[0m00:10:51.235977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021754E8DE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174E194990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174E194910>]}
[0m00:10:51.236977 [debug] [MainThread]: Flushing usage events
[0m00:13:04.380175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A28DDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A28DE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A28DF450>]}


============================== 00:13:04.386314 | 100a0381-9701-4b4e-bc90-09578b757b82 ==============================
[0m00:13:04.386314 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:13:04.389301 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m00:13:04.663357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A14739D0>]}
[0m00:13:04.715940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A29AB1D0>]}
[0m00:13:04.743992 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m00:13:05.041091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:13:05.042091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:13:05.059090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A2A29910>]}
[0m00:13:05.080186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A29B46D0>]}
[0m00:13:05.081382 [info ] [MainThread]: Found 12 models, 4 tests, 0 snapshots, 0 analyses, 318 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:13:05.083754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A2B03F90>]}
[0m00:13:05.088262 [info ] [MainThread]: 
[0m00:13:05.091283 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:13:05.100938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test'
[0m00:13:05.147509 [debug] [ThreadPool]: Using postgres connection "list_prodia_test"
[0m00:13:05.148508 [debug] [ThreadPool]: On list_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test"} */

    select distinct nspname from pg_namespace
  
[0m00:13:05.149516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:05.294794 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:13:05.299186 [debug] [ThreadPool]: On list_prodia_test: Close
[0m00:13:05.306714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test_public'
[0m00:13:05.325717 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m00:13:05.327717 [debug] [ThreadPool]: On list_prodia_test_public: BEGIN
[0m00:13:05.328719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:05.421722 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:13:05.423193 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m00:13:05.424245 [debug] [ThreadPool]: On list_prodia_test_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test_public"} */
select
      'prodia_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'prodia_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:13:05.456040 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:13:05.459029 [debug] [ThreadPool]: On list_prodia_test_public: ROLLBACK
[0m00:13:05.461518 [debug] [ThreadPool]: On list_prodia_test_public: Close
[0m00:13:05.478685 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:05.479685 [debug] [MainThread]: On master: BEGIN
[0m00:13:05.480686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:13:05.557589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:13:05.558593 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:05.559593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:13:05.585118 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m00:13:05.589118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A1E2CC50>]}
[0m00:13:05.591122 [debug] [MainThread]: On master: ROLLBACK
[0m00:13:05.592290 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:05.593636 [debug] [MainThread]: On master: BEGIN
[0m00:13:05.595135 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:13:05.596612 [debug] [MainThread]: On master: COMMIT
[0m00:13:05.597923 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:05.598974 [debug] [MainThread]: On master: COMMIT
[0m00:13:05.599974 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:13:05.601003 [debug] [MainThread]: On master: Close
[0m00:13:05.603004 [info ] [MainThread]: Concurrency: 1 threads (target='postgres')
[0m00:13:05.605015 [info ] [MainThread]: 
[0m00:13:05.620028 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m00:13:05.623019 [info ] [Thread-1 (]: 1 of 12 START sql table model public.my_first_dbt_model ........................ [RUN]
[0m00:13:05.625352 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.prodia_dbt.my_first_dbt_model'
[0m00:13:05.627676 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m00:13:05.633848 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m00:13:05.636867 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 00:13:05.627676 => 00:13:05.636358
[0m00:13:05.637909 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m00:13:05.749917 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m00:13:05.753909 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m00:13:05.755007 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m00:13:05.757322 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:13:05.834102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:13:05.836426 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m00:13:05.837482 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table "prodia_test"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m00:13:05.861054 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m00:13:05.875419 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m00:13:05.877404 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m00:13:05.880184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:13:05.888944 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m00:13:05.890949 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m00:13:05.893327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:13:05.948324 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:13:05.950327 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m00:13:05.951332 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:13:05.954972 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:13:05.968243 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m00:13:05.969241 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists "prodia_test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m00:13:05.980598 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:13:05.984698 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 00:13:05.640447 => 00:13:05.983712
[0m00:13:05.986815 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m00:13:05.988911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A2B1C990>]}
[0m00:13:05.991910 [info ] [Thread-1 (]: 1 of 12 OK created sql table model public.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.36s]
[0m00:13:05.995912 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m00:13:05.998909 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m00:13:06.000972 [info ] [Thread-1 (]: 2 of 12 START sql table model public.stg_appointments .......................... [RUN]
[0m00:13:06.004975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m00:13:06.005979 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m00:13:06.018033 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m00:13:06.021474 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 00:13:06.008342 => 00:13:06.021474
[0m00:13:06.023857 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m00:13:06.036275 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m00:13:06.040048 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m00:13:06.041062 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m00:13:06.043061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:06.126548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:13:06.127553 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m00:13:06.128720 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table "prodia_test"."public"."stg_appointments__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_appointments.sql



    select *
    from "prodia_test"."prodia_test"."appointments"

  );
  
[0m00:13:06.139346 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.appointments" does not exist
LINE 17:     from "prodia_test"."prodia_test"."appointments"
                  ^

[0m00:13:06.140394 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: ROLLBACK
[0m00:13:06.142378 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 00:13:06.025999 => 00:13:06.141395
[0m00:13:06.144375 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m00:13:06.168467 [debug] [Thread-1 (]: Database Error in model stg_appointments (models\staging\stg_appointments.sql)
  relation "prodia_test.appointments" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."appointments"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\stg_appointments.sql
[0m00:13:06.169463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A2A91B10>]}
[0m00:13:06.171458 [error] [Thread-1 (]: 2 of 12 ERROR creating sql table model public.stg_appointments ................. [[31mERROR[0m in 0.17s]
[0m00:13:06.173457 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m00:13:06.175507 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_billings
[0m00:13:06.176780 [info ] [Thread-1 (]: 3 of 12 START sql table model public.stg_billings .............................. [RUN]
[0m00:13:06.180027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_billings)
[0m00:13:06.181541 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_billings
[0m00:13:06.190040 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_billings"
[0m00:13:06.196211 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_billings (compile): 00:13:06.182986 => 00:13:06.195219
[0m00:13:06.198228 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_billings
[0m00:13:06.207259 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_billings"
[0m00:13:06.211704 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_billings"
[0m00:13:06.213700 [debug] [Thread-1 (]: On model.prodia_dbt.stg_billings: BEGIN
[0m00:13:06.214697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:06.297381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:13:06.298381 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_billings"
[0m00:13:06.299386 [debug] [Thread-1 (]: On model.prodia_dbt.stg_billings: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_billings"} */

  
    

  create  table "prodia_test"."public"."stg_billings__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_billings.sql



    select *
    from "prodia_test"."prodia_test"."billings"

  );
  
[0m00:13:06.302383 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.billings" does not exist
LINE 17:     from "prodia_test"."prodia_test"."billings"
                  ^

[0m00:13:06.303381 [debug] [Thread-1 (]: On model.prodia_dbt.stg_billings: ROLLBACK
[0m00:13:06.305381 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_billings (execute): 00:13:06.199206 => 00:13:06.305381
[0m00:13:06.307386 [debug] [Thread-1 (]: On model.prodia_dbt.stg_billings: Close
[0m00:13:06.314021 [debug] [Thread-1 (]: Database Error in model stg_billings (models\staging\stg_billings.sql)
  relation "prodia_test.billings" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."billings"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\stg_billings.sql
[0m00:13:06.315020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A2987A50>]}
[0m00:13:06.317040 [error] [Thread-1 (]: 3 of 12 ERROR creating sql table model public.stg_billings ..................... [[31mERROR[0m in 0.14s]
[0m00:13:06.319093 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_billings
[0m00:13:06.320088 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m00:13:06.322080 [info ] [Thread-1 (]: 4 of 12 START sql table model public.stg_doctors ............................... [RUN]
[0m00:13:06.325539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_billings, now model.prodia_dbt.stg_doctors)
[0m00:13:06.326838 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m00:13:06.333333 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m00:13:06.342430 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 00:13:06.326838 => 00:13:06.342430
[0m00:13:06.344438 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m00:13:06.353440 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m00:13:06.355784 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m00:13:06.357421 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m00:13:06.359420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:06.438726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:13:06.439726 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m00:13:06.441184 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table "prodia_test"."public"."stg_doctors__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_doctors.sql



    select *
    from "prodia_test"."prodia_test"."doctors"

  );
  
[0m00:13:06.443241 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.doctors" does not exist
LINE 17:     from "prodia_test"."prodia_test"."doctors"
                  ^

[0m00:13:06.445216 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: ROLLBACK
[0m00:13:06.446215 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 00:13:06.345442 => 00:13:06.446215
[0m00:13:06.448584 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m00:13:06.456584 [debug] [Thread-1 (]: Database Error in model stg_doctors (models\staging\stg_doctors.sql)
  relation "prodia_test.doctors" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."doctors"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\stg_doctors.sql
[0m00:13:06.458583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A2957D10>]}
[0m00:13:06.460604 [error] [Thread-1 (]: 4 of 12 ERROR creating sql table model public.stg_doctors ...................... [[31mERROR[0m in 0.13s]
[0m00:13:06.462743 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m00:13:06.463791 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m00:13:06.465890 [info ] [Thread-1 (]: 5 of 12 START sql table model public.stg_patients .............................. [RUN]
[0m00:13:06.469299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_patients)
[0m00:13:06.470302 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m00:13:06.477740 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m00:13:06.479788 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 00:13:06.471314 => 00:13:06.479788
[0m00:13:06.482235 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m00:13:06.491240 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m00:13:06.494611 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m00:13:06.495615 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m00:13:06.497957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:06.577031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:13:06.578039 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m00:13:06.580030 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table "prodia_test"."public"."stg_patients__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_patients.sql



    select *
    from "prodia_test"."prodia_test"."patients"

  );
  
[0m00:13:06.582348 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.patients" does not exist
LINE 17:     from "prodia_test"."prodia_test"."patients"
                  ^

[0m00:13:06.583346 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: ROLLBACK
[0m00:13:06.585761 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 00:13:06.483251 => 00:13:06.584711
[0m00:13:06.587764 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m00:13:06.596207 [debug] [Thread-1 (]: Database Error in model stg_patients (models\staging\stg_patients.sql)
  relation "prodia_test.patients" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."patients"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\stg_patients.sql
[0m00:13:06.598227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A2C249D0>]}
[0m00:13:06.599206 [error] [Thread-1 (]: 5 of 12 ERROR creating sql table model public.stg_patients ..................... [[31mERROR[0m in 0.13s]
[0m00:13:06.601641 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m00:13:06.603640 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m00:13:06.605646 [info ] [Thread-1 (]: 6 of 12 START sql table model public.stg_procedures ............................ [RUN]
[0m00:13:06.609641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m00:13:06.611647 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m00:13:06.619642 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m00:13:06.623636 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 00:13:06.612635 => 00:13:06.622641
[0m00:13:06.625641 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m00:13:06.635906 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m00:13:06.640934 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m00:13:06.642932 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m00:13:06.643934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:06.728318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:13:06.730469 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m00:13:06.731484 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table "prodia_test"."public"."stg_procedures__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_procedures.sql



    select *
    from "prodia_test"."prodia_test"."procedures"

  );
  
[0m00:13:06.734013 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.procedures" does not exist
LINE 17:     from "prodia_test"."prodia_test"."procedures"
                  ^

[0m00:13:06.735007 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: ROLLBACK
[0m00:13:06.737011 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 00:13:06.627914 => 00:13:06.737011
[0m00:13:06.739007 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m00:13:06.745392 [debug] [Thread-1 (]: Database Error in model stg_procedures (models\staging\stg_procedures.sql)
  relation "prodia_test.procedures" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."procedures"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\stg_procedures.sql
[0m00:13:06.747907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A2BB2E50>]}
[0m00:13:06.748905 [error] [Thread-1 (]: 6 of 12 ERROR creating sql table model public.stg_procedures ................... [[31mERROR[0m in 0.14s]
[0m00:13:06.751028 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m00:13:06.753179 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m00:13:06.754604 [info ] [Thread-1 (]: 7 of 12 START sql view model public.my_second_dbt_model ........................ [RUN]
[0m00:13:06.758771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m00:13:06.759801 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m00:13:06.767669 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m00:13:06.770897 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 00:13:06.762178 => 00:13:06.769644
[0m00:13:06.772914 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m00:13:06.825682 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m00:13:06.831437 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m00:13:06.832438 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m00:13:06.834435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:06.911045 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:13:06.912063 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m00:13:06.913064 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view "prodia_test"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "prodia_test"."public"."my_first_dbt_model"
where id = 1
  );
[0m00:13:06.927614 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:13:06.936310 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m00:13:06.938312 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
alter table "prodia_test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m00:13:06.940319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:13:06.946319 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:13:06.948320 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m00:13:06.950313 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:13:06.953542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:13:06.960851 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m00:13:06.962847 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists "prodia_test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m00:13:06.965848 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:13:06.970877 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 00:13:06.773902 => 00:13:06.969868
[0m00:13:06.971878 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m00:13:06.974844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100a0381-9701-4b4e-bc90-09578b757b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A2C134D0>]}
[0m00:13:06.976877 [info ] [Thread-1 (]: 7 of 12 OK created sql view model public.my_second_dbt_model ................... [[32mCREATE VIEW[0m in 0.22s]
[0m00:13:06.980208 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m00:13:06.982210 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m00:13:06.984209 [info ] [Thread-1 (]: 8 of 12 SKIP relation public.int_invoice_summary ............................... [[33mSKIP[0m]
[0m00:13:06.987220 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m00:13:06.989249 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m00:13:06.991408 [info ] [Thread-1 (]: 9 of 12 SKIP relation public.int_patient_summary ............................... [[33mSKIP[0m]
[0m00:13:06.995408 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m00:13:06.997432 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m00:13:06.998947 [info ] [Thread-1 (]: 10 of 12 SKIP relation public.int_appointment_details .......................... [[33mSKIP[0m]
[0m00:13:07.003037 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m00:13:07.005236 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m00:13:07.007750 [info ] [Thread-1 (]: 11 of 12 SKIP relation public.dm_patient_overview .............................. [[33mSKIP[0m]
[0m00:13:07.010760 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m00:13:07.012764 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m00:13:07.013821 [info ] [Thread-1 (]: 12 of 12 SKIP relation public.dm_appointment_summary ........................... [[33mSKIP[0m]
[0m00:13:07.018225 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m00:13:07.022362 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:07.024704 [debug] [MainThread]: On master: BEGIN
[0m00:13:07.026693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:13:07.112292 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:13:07.113370 [debug] [MainThread]: On master: COMMIT
[0m00:13:07.114459 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:07.115463 [debug] [MainThread]: On master: COMMIT
[0m00:13:07.116479 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:13:07.117483 [debug] [MainThread]: On master: Close
[0m00:13:07.119458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:07.121473 [debug] [MainThread]: Connection 'list_prodia_test' was properly closed.
[0m00:13:07.121473 [debug] [MainThread]: Connection 'list_prodia_test_public' was properly closed.
[0m00:13:07.122509 [debug] [MainThread]: Connection 'model.prodia_dbt.my_second_dbt_model' was properly closed.
[0m00:13:07.123987 [info ] [MainThread]: 
[0m00:13:07.126234 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m00:13:07.130617 [debug] [MainThread]: Command end result
[0m00:13:07.150776 [info ] [MainThread]: 
[0m00:13:07.153775 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m00:13:07.156399 [info ] [MainThread]: 
[0m00:13:07.158857 [error] [MainThread]: [33mDatabase Error in model stg_appointments (models\staging\stg_appointments.sql)[0m
[0m00:13:07.161002 [error] [MainThread]:   relation "prodia_test.appointments" does not exist
[0m00:13:07.162997 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."appointments"
[0m00:13:07.164989 [error] [MainThread]:                     ^
[0m00:13:07.167735 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_appointments.sql
[0m00:13:07.169992 [info ] [MainThread]: 
[0m00:13:07.171259 [error] [MainThread]: [33mDatabase Error in model stg_billings (models\staging\stg_billings.sql)[0m
[0m00:13:07.173537 [error] [MainThread]:   relation "prodia_test.billings" does not exist
[0m00:13:07.175811 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."billings"
[0m00:13:07.177810 [error] [MainThread]:                     ^
[0m00:13:07.179813 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_billings.sql
[0m00:13:07.182126 [info ] [MainThread]: 
[0m00:13:07.184959 [error] [MainThread]: [33mDatabase Error in model stg_doctors (models\staging\stg_doctors.sql)[0m
[0m00:13:07.186977 [error] [MainThread]:   relation "prodia_test.doctors" does not exist
[0m00:13:07.188962 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."doctors"
[0m00:13:07.191416 [error] [MainThread]:                     ^
[0m00:13:07.193413 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_doctors.sql
[0m00:13:07.195413 [info ] [MainThread]: 
[0m00:13:07.197849 [error] [MainThread]: [33mDatabase Error in model stg_patients (models\staging\stg_patients.sql)[0m
[0m00:13:07.198854 [error] [MainThread]:   relation "prodia_test.patients" does not exist
[0m00:13:07.201106 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."patients"
[0m00:13:07.203112 [error] [MainThread]:                     ^
[0m00:13:07.205599 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_patients.sql
[0m00:13:07.208089 [info ] [MainThread]: 
[0m00:13:07.209498 [error] [MainThread]: [33mDatabase Error in model stg_procedures (models\staging\stg_procedures.sql)[0m
[0m00:13:07.212665 [error] [MainThread]:   relation "prodia_test.procedures" does not exist
[0m00:13:07.214772 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."procedures"
[0m00:13:07.217069 [error] [MainThread]:                     ^
[0m00:13:07.218264 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_procedures.sql
[0m00:13:07.220272 [info ] [MainThread]: 
[0m00:13:07.222276 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=5 TOTAL=12
[0m00:13:07.225776 [debug] [MainThread]: Command `dbt run` failed at 00:13:07.225776 after 2.88 seconds
[0m00:13:07.227773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001739BBE4990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001739BBE4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001739F39B6D0>]}
[0m00:13:07.228772 [debug] [MainThread]: Flushing usage events
[0m00:15:37.459360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A2C881E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A2C88E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A2C88DD90>]}


============================== 00:15:37.465362 | 62be9c56-1995-43a0-888f-7f185e920715 ==============================
[0m00:15:37.465362 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:15:37.467371 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'quiet': 'False', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'warn_error': 'None'}
[0m00:15:37.476440 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'prodia_dbt' does not have a target named 'mysql'. The valid target names for this profile are:
   - postgres
[0m00:15:37.479448 [debug] [MainThread]: Command `dbt run` failed at 00:15:37.479448 after 0.06 seconds
[0m00:15:37.482162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A2C29BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A25B80A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A2C891510>]}
[0m00:15:37.483165 [debug] [MainThread]: Flushing usage events
[0m00:16:13.422093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB9F2DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB99834D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB8C97450>]}


============================== 00:16:13.429173 | fdf8abdc-87d1-4c28-af80-aa98b9d1d262 ==============================
[0m00:16:13.429173 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:16:13.431174 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'log_format': 'default', 'version_check': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m00:16:14.387426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB9E00210>]}
[0m00:16:14.442187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB9E00210>]}
[0m00:16:14.472171 [debug] [MainThread]: checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, vars: {}, profile: , target: mysql, version: 1.5.0
[0m00:16:14.580935 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:16:14.583913 [debug] [MainThread]: previous checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m00:16:14.585171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA59B390>]}
[0m00:16:16.329485 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m00:16:16.361045 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m00:16:16.370045 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:16:16.379046 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:16:16.387356 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m00:16:16.396491 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m00:16:16.404749 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m00:16:16.412749 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m00:16:16.428185 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m00:16:16.433177 [debug] [MainThread]: 1603: static parser failed on staging\stg_billings.sql
[0m00:16:16.444729 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_billings.sql
[0m00:16:16.449734 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m00:16:16.460715 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m00:16:16.465203 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m00:16:16.476223 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m00:16:16.482206 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m00:16:16.493725 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m00:16:16.883356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA52A490>]}
[0m00:16:16.904720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA62A0D0>]}
[0m00:16:16.905731 [info ] [MainThread]: Found 12 models, 4 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:16:16.908835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA62AE10>]}
[0m00:16:16.914288 [info ] [MainThread]: 
[0m00:16:16.919286 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m00:16:16.926136 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m00:16:16.955028 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m00:16:16.957007 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m00:16:16.958037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:17.045132 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m00:16:17.048135 [debug] [ThreadPool]: On list_schemas: Close
[0m00:16:17.054685 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_prodia_test'
[0m00:16:17.067690 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:16:17.069669 [debug] [ThreadPool]: On list_None_prodia_test: BEGIN
[0m00:16:17.069669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:17.084610 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.085611 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:16:17.086610 [debug] [ThreadPool]: On list_None_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_None_prodia_test"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'prodia_test'
  
[0m00:16:17.092664 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:16:17.096659 [debug] [ThreadPool]: On list_None_prodia_test: ROLLBACK
[0m00:16:17.097662 [debug] [ThreadPool]: On list_None_prodia_test: Close
[0m00:16:17.106321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB97DBCD0>]}
[0m00:16:17.107322 [debug] [MainThread]: Using mysql connection "master"
[0m00:16:17.109320 [debug] [MainThread]: On master: BEGIN
[0m00:16:17.110320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:17.124801 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.126804 [debug] [MainThread]: On master: COMMIT
[0m00:16:17.127998 [debug] [MainThread]: Using mysql connection "master"
[0m00:16:17.129003 [debug] [MainThread]: On master: COMMIT
[0m00:16:17.132417 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.133420 [debug] [MainThread]: On master: Close
[0m00:16:17.136803 [info ] [MainThread]: Concurrency: 1 threads (target='mysql')
[0m00:16:17.138841 [info ] [MainThread]: 
[0m00:16:17.156450 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m00:16:17.159739 [info ] [Thread-1 (]: 1 of 12 START sql table model prodia_test.my_first_dbt_model ................... [RUN]
[0m00:16:17.163239 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.prodia_dbt.my_first_dbt_model'
[0m00:16:17.165235 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m00:16:17.172868 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m00:16:17.176862 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 00:16:17.167233 => 00:16:17.175861
[0m00:16:17.178863 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m00:16:17.269956 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m00:16:17.271942 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:16:17.272939 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m00:16:17.274019 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:16:17.287082 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.288082 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:16:17.289078 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table
    `prodia_test`.`my_first_dbt_model__dbt_tmp`
    
    
      as
    
    (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

  
[0m00:16:17.357024 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:16:17.373577 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:16:17.375573 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model` cascade
  
[0m00:16:17.381107 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.384544 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:16:17.385595 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model__dbt_tmp` to `prodia_test`.`my_first_dbt_model`
  
[0m00:16:17.409771 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.457832 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:16:17.459877 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:16:17.460834 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:16:17.463825 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.476010 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:16:17.478009 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup`
[0m00:16:17.482645 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.487138 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 00:16:17.180863 => 00:16:17.487138
[0m00:16:17.488138 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m00:16:17.491539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA5A05D0>]}
[0m00:16:17.492593 [info ] [Thread-1 (]: 1 of 12 OK created sql table model prodia_test.my_first_dbt_model .............. [[32mSUCCESS 2[0m in 0.33s]
[0m00:16:17.496093 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m00:16:17.498076 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m00:16:17.500626 [info ] [Thread-1 (]: 2 of 12 START sql table model prodia_test.stg_appointments ..................... [RUN]
[0m00:16:17.503605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m00:16:17.505608 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m00:16:17.514867 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m00:16:17.518857 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 00:16:17.507608 => 00:16:17.517860
[0m00:16:17.520158 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m00:16:17.532496 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m00:16:17.535890 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:16:17.537887 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m00:16:17.539887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:17.554193 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.555185 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:16:17.557181 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table
    `prodia_test`.`stg_appointments__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_appointments.sql



    select *
    from `prodia_test`.`appointments`

    )

  
[0m00:16:17.622556 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:16:17.629366 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:16:17.631360 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments` cascade
  
[0m00:16:17.635344 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.639387 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:16:17.640390 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments__dbt_tmp` to `prodia_test`.`stg_appointments`
  
[0m00:16:17.658468 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.662456 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:16:17.664480 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:16:17.666480 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:16:17.667895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.674222 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:16:17.676215 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */
drop table if exists `prodia_test`.`stg_appointments__dbt_backup`
[0m00:16:17.681558 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.685330 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 00:16:17.521394 => 00:16:17.684277
[0m00:16:17.686330 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m00:16:17.689453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA6A8850>]}
[0m00:16:17.690506 [info ] [Thread-1 (]: 2 of 12 OK created sql table model prodia_test.stg_appointments ................ [[32mSUCCESS 1000[0m in 0.19s]
[0m00:16:17.693510 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m00:16:17.695485 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_billings
[0m00:16:17.697505 [info ] [Thread-1 (]: 3 of 12 START sql table model prodia_test.stg_billings ......................... [RUN]
[0m00:16:17.700490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_billings)
[0m00:16:17.702487 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_billings
[0m00:16:17.712715 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_billings"
[0m00:16:17.715716 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_billings (compile): 00:16:17.703488 => 00:16:17.714710
[0m00:16:17.716717 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_billings
[0m00:16:17.726299 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_billings"
[0m00:16:17.729300 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_billings"
[0m00:16:17.731305 [debug] [Thread-1 (]: On model.prodia_dbt.stg_billings: BEGIN
[0m00:16:17.732309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:17.746720 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.748741 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_billings"
[0m00:16:17.749719 [debug] [Thread-1 (]: On model.prodia_dbt.stg_billings: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_billings"} */

  
    

  create  table
    `prodia_test`.`stg_billings__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_billings.sql



    select *
    from `prodia_test`.`billings`

    )

  
[0m00:16:17.754745 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1146 (42S02): Table 'prodia_test.billings' doesn't exist
[0m00:16:17.757730 [debug] [Thread-1 (]: On model.prodia_dbt.stg_billings: ROLLBACK
[0m00:16:17.759966 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_billings (execute): 00:16:17.717758 => 00:16:17.758726
[0m00:16:17.762208 [debug] [Thread-1 (]: On model.prodia_dbt.stg_billings: Close
[0m00:16:17.789062 [debug] [Thread-1 (]: Database Error in model stg_billings (models\staging\stg_billings.sql)
  1146 (42S02): Table 'prodia_test.billings' doesn't exist
  compiled Code at target\run\prodia_dbt\models\staging\stg_billings.sql
[0m00:16:17.791069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA5FAB90>]}
[0m00:16:17.793064 [error] [Thread-1 (]: 3 of 12 ERROR creating sql table model prodia_test.stg_billings ................ [[31mERROR[0m in 0.09s]
[0m00:16:17.794745 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_billings
[0m00:16:17.796762 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m00:16:17.799281 [info ] [Thread-1 (]: 4 of 12 START sql table model prodia_test.stg_doctors .......................... [RUN]
[0m00:16:17.802562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_billings, now model.prodia_dbt.stg_doctors)
[0m00:16:17.803557 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m00:16:17.812989 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m00:16:17.815479 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 00:16:17.804561 => 00:16:17.814046
[0m00:16:17.816678 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m00:16:17.826175 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m00:16:17.829265 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:16:17.830516 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m00:16:17.832017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:17.845846 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.846849 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:16:17.848845 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table
    `prodia_test`.`stg_doctors__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_doctors.sql



    select *
    from `prodia_test`.`doctors`

    )

  
[0m00:16:17.931980 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:16:17.943422 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:16:17.946180 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors` cascade
  
[0m00:16:17.952254 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.955694 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:16:17.957692 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors__dbt_tmp` to `prodia_test`.`stg_doctors`
  
[0m00:16:17.978833 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:17.985825 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:16:17.986829 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:16:17.990821 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:16:17.994827 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.008979 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:16:18.009977 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */
drop table if exists `prodia_test`.`stg_doctors__dbt_backup`
[0m00:16:18.016441 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.022810 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 00:16:17.817728 => 00:16:18.021443
[0m00:16:18.024803 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m00:16:18.029801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA5A05D0>]}
[0m00:16:18.031806 [info ] [Thread-1 (]: 4 of 12 OK created sql table model prodia_test.stg_doctors ..................... [[32mSUCCESS 1000[0m in 0.23s]
[0m00:16:18.036579 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m00:16:18.039087 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m00:16:18.041083 [info ] [Thread-1 (]: 5 of 12 START sql table model prodia_test.stg_patients ......................... [RUN]
[0m00:16:18.045780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_patients)
[0m00:16:18.047780 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m00:16:18.057423 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m00:16:18.062652 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 00:16:18.048780 => 00:16:18.061259
[0m00:16:18.065133 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m00:16:18.080124 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m00:16:18.083528 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:16:18.084958 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m00:16:18.085967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:18.103446 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.104441 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:16:18.106564 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table
    `prodia_test`.`stg_patients__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_patients.sql



    select *
    from `prodia_test`.`patients`

    )

  
[0m00:16:18.175485 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:16:18.184825 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:16:18.185966 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients` cascade
  
[0m00:16:18.191745 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.195335 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:16:18.196328 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients__dbt_tmp` to `prodia_test`.`stg_patients`
  
[0m00:16:18.216546 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.221549 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:16:18.223543 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:16:18.224544 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:16:18.227073 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.234828 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:16:18.235834 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */
drop table if exists `prodia_test`.`stg_patients__dbt_backup`
[0m00:16:18.240895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.245603 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 00:16:18.066579 => 00:16:18.244578
[0m00:16:18.246990 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m00:16:18.248156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBB7AFAD0>]}
[0m00:16:18.250768 [info ] [Thread-1 (]: 5 of 12 OK created sql table model prodia_test.stg_patients .................... [[32mSUCCESS 998[0m in 0.20s]
[0m00:16:18.254330 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m00:16:18.255379 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m00:16:18.256864 [info ] [Thread-1 (]: 6 of 12 START sql table model prodia_test.stg_procedures ....................... [RUN]
[0m00:16:18.260768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m00:16:18.261968 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m00:16:18.270710 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m00:16:18.274150 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 00:16:18.262999 => 00:16:18.273152
[0m00:16:18.275154 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m00:16:18.286673 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m00:16:18.289868 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:16:18.291887 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m00:16:18.294263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:18.308471 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.309454 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:16:18.311782 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table
    `prodia_test`.`stg_procedures__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_procedures.sql



    select *
    from `prodia_test`.`procedures`

    )

  
[0m00:16:18.377972 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:16:18.386074 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:16:18.387126 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures` cascade
  
[0m00:16:18.392621 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.395617 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:16:18.397621 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures__dbt_tmp` to `prodia_test`.`stg_procedures`
  
[0m00:16:18.415178 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.419525 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:16:18.420578 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:16:18.421579 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:16:18.424558 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.430729 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:16:18.431729 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */
drop table if exists `prodia_test`.`stg_procedures__dbt_backup`
[0m00:16:18.436221 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.440307 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 00:16:18.277154 => 00:16:18.439299
[0m00:16:18.441814 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m00:16:18.443233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBB7B1F10>]}
[0m00:16:18.445565 [info ] [Thread-1 (]: 6 of 12 OK created sql table model prodia_test.stg_procedures .................. [[32mSUCCESS 1000[0m in 0.18s]
[0m00:16:18.448632 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m00:16:18.450752 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m00:16:18.451772 [info ] [Thread-1 (]: 7 of 12 START sql view model prodia_test.my_second_dbt_model ................... [RUN]
[0m00:16:18.455177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m00:16:18.456383 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m00:16:18.462963 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m00:16:18.465247 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 00:16:18.457420 => 00:16:18.465247
[0m00:16:18.467258 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m00:16:18.514905 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m00:16:18.516902 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:16:18.518219 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m00:16:18.519253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:18.531500 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.532504 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:16:18.533491 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view `prodia_test`.`my_second_dbt_model__dbt_tmp`
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from `prodia_test`.`my_first_dbt_model`
where id = 1
  );
[0m00:16:18.544039 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.551093 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:16:18.552093 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model` cascade
  
[0m00:16:18.556094 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.559093 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:16:18.561247 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model__dbt_tmp` to `prodia_test`.`my_second_dbt_model`
  
[0m00:16:18.567037 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.571137 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:16:18.572132 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:16:18.573137 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:16:18.575114 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.581185 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:16:18.583171 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup`
[0m00:16:18.586548 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.590591 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 00:16:18.467258 => 00:16:18.589561
[0m00:16:18.591610 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m00:16:18.594305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA5DEFD0>]}
[0m00:16:18.596302 [info ] [Thread-1 (]: 7 of 12 OK created sql view model prodia_test.my_second_dbt_model .............. [[32mSUCCESS 0[0m in 0.14s]
[0m00:16:18.598332 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m00:16:18.600906 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m00:16:18.602881 [info ] [Thread-1 (]: 8 of 12 SKIP relation prodia_test.int_invoice_summary .......................... [[33mSKIP[0m]
[0m00:16:18.605102 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m00:16:18.606099 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m00:16:18.608517 [info ] [Thread-1 (]: 9 of 12 START sql table model prodia_test.int_patient_summary .................. [RUN]
[0m00:16:18.611455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_second_dbt_model, now model.prodia_dbt.int_patient_summary)
[0m00:16:18.612552 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_patient_summary
[0m00:16:18.621836 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_patient_summary"
[0m00:16:18.625258 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (compile): 00:16:18.613608 => 00:16:18.623837
[0m00:16:18.627508 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_patient_summary
[0m00:16:18.639282 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_patient_summary"
[0m00:16:18.644181 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:16:18.645176 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: BEGIN
[0m00:16:18.647190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:18.660749 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.661929 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:16:18.663949 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

  
    

  create  table
    `prodia_test`.`int_patient_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_patient_summary.sql


with patient_appointments as (
    select
        p.PatientID,
        p.firstname,
        p.lastname,
        count(a.AppointmentID) as total_appointments
    from
        `prodia_test`.`stg_patients` p
    left join
        `prodia_test`.`stg_appointments` a on p.PatientID = a.PatientID
    group by
        p.PatientID,
        p.firstname,
        p.lastname
)

select * from patient_appointments
    )

  
[0m00:16:18.732649 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:16:18.739643 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:16:18.741801 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary` cascade
  
[0m00:16:18.747862 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.750924 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:16:18.751922 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary__dbt_tmp` to `prodia_test`.`int_patient_summary`
  
[0m00:16:18.769198 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.772752 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:16:18.774753 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:16:18.776753 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:16:18.778749 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.785743 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:16:18.786770 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */
drop table if exists `prodia_test`.`int_patient_summary__dbt_backup`
[0m00:16:18.792404 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.796407 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (execute): 00:16:18.628913 => 00:16:18.796407
[0m00:16:18.798394 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: Close
[0m00:16:18.800576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBB7C5C50>]}
[0m00:16:18.802572 [info ] [Thread-1 (]: 9 of 12 OK created sql table model prodia_test.int_patient_summary ............. [[32mSUCCESS 998[0m in 0.19s]
[0m00:16:18.805575 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m00:16:18.808058 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m00:16:18.810175 [info ] [Thread-1 (]: 10 of 12 START sql table model prodia_test.int_appointment_details ............. [RUN]
[0m00:16:18.813268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_patient_summary, now model.prodia_dbt.int_appointment_details)
[0m00:16:18.814266 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_appointment_details
[0m00:16:18.825264 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_appointment_details"
[0m00:16:18.828382 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (compile): 00:16:18.816270 => 00:16:18.827378
[0m00:16:18.830623 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_appointment_details
[0m00:16:18.841401 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_appointment_details"
[0m00:16:18.844440 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:16:18.845723 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: BEGIN
[0m00:16:18.848132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:18.860526 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.862944 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:16:18.864053 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

  
    

  create  table
    `prodia_test`.`int_appointment_details__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_appointment_details.sql



with appointment_info as (
    select
        a.AppointmentID,
        a.AppointmentDate,
        a.AppointmentTime,
        p.PatientID,
        concat(p.firstname, ' ', p.lastname) as patient_name,
        d.DoctorName,
        pr.ProcedureName
    from
        `prodia_test`.`stg_appointments` a
    join
        `prodia_test`.`stg_patients` p on a.PatientID = p.PatientID
    join
        `prodia_test`.`stg_doctors` d on a.DoctorID = d.DoctorID
    left join
        `prodia_test`.`stg_procedures` pr on a.AppointmentID = pr.AppointmentID
)

select * from appointment_info
    )

  
[0m00:16:18.964949 [debug] [Thread-1 (]: SQL status: SUCCESS 1367 in 0.0 seconds
[0m00:16:18.975158 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:16:18.976156 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details` cascade
  
[0m00:16:18.980952 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:18.984458 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:16:18.985449 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details__dbt_tmp` to `prodia_test`.`int_appointment_details`
  
[0m00:16:19.003972 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:19.009413 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:16:19.011584 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:16:19.012583 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:16:19.015583 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:19.021857 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:16:19.024833 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */
drop table if exists `prodia_test`.`int_appointment_details__dbt_backup`
[0m00:16:19.029364 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:19.034633 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (execute): 00:16:18.831618 => 00:16:19.033635
[0m00:16:19.035624 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: Close
[0m00:16:19.037618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBB7E7E90>]}
[0m00:16:19.039665 [info ] [Thread-1 (]: 10 of 12 OK created sql table model prodia_test.int_appointment_details ........ [[32mSUCCESS 1367[0m in 0.23s]
[0m00:16:19.044002 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m00:16:19.045989 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m00:16:19.047393 [info ] [Thread-1 (]: 11 of 12 SKIP relation prodia_test.dm_patient_overview ......................... [[33mSKIP[0m]
[0m00:16:19.049644 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m00:16:19.053076 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m00:16:19.054052 [info ] [Thread-1 (]: 12 of 12 START sql table model prodia_test.dm_appointment_summary .............. [RUN]
[0m00:16:19.058509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_appointment_details, now model.prodia_dbt.dm_appointment_summary)
[0m00:16:19.059521 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_appointment_summary
[0m00:16:19.067101 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_appointment_summary"
[0m00:16:19.071316 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (compile): 00:16:19.060529 => 00:16:19.070320
[0m00:16:19.073491 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_appointment_summary
[0m00:16:19.089119 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_appointment_summary"
[0m00:16:19.097114 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:16:19.100123 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: BEGIN
[0m00:16:19.102123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:19.119428 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:19.121881 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:16:19.123877 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

  
    

  create  table
    `prodia_test`.`dm_appointment_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_appointment_summary.sql



with appointment_summary as (
    select
        ad.AppointmentDate,
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        COUNT(DISTINCT ad.ProcedureName) AS total_procedures
    from
        `prodia_test`.`int_appointment_details` ad
    group by
        ad.AppointmentDate, 
        ad.DoctorName
)
CREATE TABLE datamart.appointment_summary AS
    )

  
[0m00:16:19.127880 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE datamart.appointment_summary AS
    )' at line 29
[0m00:16:19.129879 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: ROLLBACK
[0m00:16:19.132878 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (execute): 00:16:19.074534 => 00:16:19.132878
[0m00:16:19.136877 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: Close
[0m00:16:19.145522 [debug] [Thread-1 (]: Database Error in model dm_appointment_summary (models\datamart\dm_appointment_summary.sql)
  1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE datamart.appointment_summary AS
      )' at line 29
  compiled Code at target\run\prodia_dbt\models\datamart\dm_appointment_summary.sql
[0m00:16:19.148559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf8abdc-87d1-4c28-af80-aa98b9d1d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA62C410>]}
[0m00:16:19.150554 [error] [Thread-1 (]: 12 of 12 ERROR creating sql table model prodia_test.dm_appointment_summary ..... [[31mERROR[0m in 0.09s]
[0m00:16:19.154547 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m00:16:19.159648 [debug] [MainThread]: Using mysql connection "master"
[0m00:16:19.159648 [debug] [MainThread]: On master: BEGIN
[0m00:16:19.162034 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:19.173423 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:19.175651 [debug] [MainThread]: On master: COMMIT
[0m00:16:19.176655 [debug] [MainThread]: Using mysql connection "master"
[0m00:16:19.178657 [debug] [MainThread]: On master: COMMIT
[0m00:16:19.180663 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:16:19.182172 [debug] [MainThread]: On master: Close
[0m00:16:19.184300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:19.185299 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m00:16:19.186351 [debug] [MainThread]: Connection 'list_None_prodia_test' was properly closed.
[0m00:16:19.187353 [debug] [MainThread]: Connection 'model.prodia_dbt.dm_appointment_summary' was properly closed.
[0m00:16:19.188327 [info ] [MainThread]: 
[0m00:16:19.190683 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m00:16:19.197482 [debug] [MainThread]: Command end result
[0m00:16:19.217439 [info ] [MainThread]: 
[0m00:16:19.219428 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:16:19.221442 [info ] [MainThread]: 
[0m00:16:19.222441 [error] [MainThread]: [33mDatabase Error in model stg_billings (models\staging\stg_billings.sql)[0m
[0m00:16:19.224421 [error] [MainThread]:   1146 (42S02): Table 'prodia_test.billings' doesn't exist
[0m00:16:19.225819 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_billings.sql
[0m00:16:19.228001 [info ] [MainThread]: 
[0m00:16:19.230013 [error] [MainThread]: [33mDatabase Error in model dm_appointment_summary (models\datamart\dm_appointment_summary.sql)[0m
[0m00:16:19.232014 [error] [MainThread]:   1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE datamart.appointment_summary AS
[0m00:16:19.233015 [error] [MainThread]:       )' at line 29
[0m00:16:19.235512 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_appointment_summary.sql
[0m00:16:19.236947 [info ] [MainThread]: 
[0m00:16:19.239105 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=2 TOTAL=12
[0m00:16:19.242109 [debug] [MainThread]: Command `dbt run` failed at 00:16:19.242109 after 5.86 seconds
[0m00:16:19.243223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB3210A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB3210890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA465990>]}
[0m00:16:19.245531 [debug] [MainThread]: Flushing usage events
[0m00:17:57.406345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D1A40390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D3173710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D3173C10>]}


============================== 00:17:57.411731 | 0f0948f0-68de-442c-b948-f4fad8609ac0 ==============================
[0m00:17:57.411731 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:17:57.414764 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'write_json': 'True', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'target_path': 'None', 'static_parser': 'True', 'no_print': 'None'}
[0m00:17:58.344661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D317EE50>]}
[0m00:17:58.398831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D3180410>]}
[0m00:17:58.433820 [debug] [MainThread]: checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, vars: {}, profile: , target: mysql, version: 1.5.0
[0m00:17:58.574122 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:17:58.578977 [debug] [MainThread]: previous checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m00:17:58.580975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D37EB310>]}
[0m00:18:00.435287 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m00:18:00.468548 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m00:18:00.476739 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:18:00.485919 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:18:00.494903 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m00:18:00.503948 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m00:18:00.512620 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m00:18:00.521638 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m00:18:00.534903 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m00:18:00.540384 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m00:18:00.550571 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m00:18:00.555566 [debug] [MainThread]: 1603: static parser failed on staging\stg_invoices.sql
[0m00:18:00.566731 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_invoices.sql
[0m00:18:00.571734 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m00:18:00.582711 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m00:18:00.587963 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m00:18:00.599213 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m00:18:00.981894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D3491B50>]}
[0m00:18:01.002335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D379A490>]}
[0m00:18:01.003332 [info ] [MainThread]: Found 12 models, 4 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:18:01.005331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D3799850>]}
[0m00:18:01.011723 [info ] [MainThread]: 
[0m00:18:01.014938 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m00:18:01.020135 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m00:18:01.054045 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m00:18:01.056031 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m00:18:01.057399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:01.086771 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m00:18:01.090198 [debug] [ThreadPool]: On list_schemas: Close
[0m00:18:01.097014 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_prodia_test'
[0m00:18:01.115412 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:18:01.117419 [debug] [ThreadPool]: On list_None_prodia_test: BEGIN
[0m00:18:01.119417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:01.131183 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.133973 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:18:01.135973 [debug] [ThreadPool]: On list_None_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_None_prodia_test"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'prodia_test'
  
[0m00:18:01.140359 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m00:18:01.143361 [debug] [ThreadPool]: On list_None_prodia_test: ROLLBACK
[0m00:18:01.145342 [debug] [ThreadPool]: On list_None_prodia_test: Close
[0m00:18:01.155283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D376D2D0>]}
[0m00:18:01.157259 [debug] [MainThread]: Using mysql connection "master"
[0m00:18:01.158704 [debug] [MainThread]: On master: BEGIN
[0m00:18:01.159735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:01.171784 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.174102 [debug] [MainThread]: On master: COMMIT
[0m00:18:01.175353 [debug] [MainThread]: Using mysql connection "master"
[0m00:18:01.176383 [debug] [MainThread]: On master: COMMIT
[0m00:18:01.177682 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.179682 [debug] [MainThread]: On master: Close
[0m00:18:01.182097 [info ] [MainThread]: Concurrency: 1 threads (target='mysql')
[0m00:18:01.183527 [info ] [MainThread]: 
[0m00:18:01.200091 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m00:18:01.202094 [info ] [Thread-1 (]: 1 of 12 START sql table model prodia_test.my_first_dbt_model ................... [RUN]
[0m00:18:01.206083 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.prodia_dbt.my_first_dbt_model'
[0m00:18:01.209090 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m00:18:01.219028 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m00:18:01.222248 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 00:18:01.211173 => 00:18:01.221256
[0m00:18:01.224288 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m00:18:01.334606 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m00:18:01.337856 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:01.338873 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m00:18:01.340231 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:01.353431 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.354429 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:01.355430 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table
    `prodia_test`.`my_first_dbt_model__dbt_tmp`
    
    
      as
    
    (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

  
[0m00:18:01.380981 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:18:01.404735 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:01.407189 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup` cascade
  
[0m00:18:01.412821 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.416827 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:01.417831 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model` to `prodia_test`.`my_first_dbt_model__dbt_backup`
  
[0m00:18:01.438833 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.446702 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:01.449014 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model` cascade
  
[0m00:18:01.454678 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.457664 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:01.459674 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model__dbt_tmp` to `prodia_test`.`my_first_dbt_model`
  
[0m00:18:01.479104 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.556660 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:18:01.558844 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:01.560145 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:18:01.562150 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.575341 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:01.577318 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup`
[0m00:18:01.595779 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.599396 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 00:18:01.225286 => 00:18:01.599396
[0m00:18:01.601444 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m00:18:01.604164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D4848A10>]}
[0m00:18:01.605328 [info ] [Thread-1 (]: 1 of 12 OK created sql table model prodia_test.my_first_dbt_model .............. [[32mSUCCESS 2[0m in 0.40s]
[0m00:18:01.608382 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m00:18:01.610377 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m00:18:01.612772 [info ] [Thread-1 (]: 2 of 12 START sql table model prodia_test.stg_appointments ..................... [RUN]
[0m00:18:01.615804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m00:18:01.617058 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m00:18:01.626005 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m00:18:01.628185 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 00:18:01.618093 => 00:18:01.628185
[0m00:18:01.630419 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m00:18:01.640874 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m00:18:01.642898 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:01.644880 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m00:18:01.645906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:01.658182 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.660164 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:01.661187 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table
    `prodia_test`.`stg_appointments__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_appointments.sql



    select *
    from `prodia_test`.`appointments`

    )

  
[0m00:18:01.706008 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:18:01.713992 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:01.714997 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments__dbt_backup` cascade
  
[0m00:18:01.719860 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.723251 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:01.724465 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments` to `prodia_test`.`stg_appointments__dbt_backup`
  
[0m00:18:01.741981 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.750154 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:01.751243 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments` cascade
  
[0m00:18:01.756321 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.759360 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:01.760339 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments__dbt_tmp` to `prodia_test`.`stg_appointments`
  
[0m00:18:01.778815 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.782809 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:18:01.784816 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:01.785811 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:18:01.787826 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.795027 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:01.796027 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */
drop table if exists `prodia_test`.`stg_appointments__dbt_backup`
[0m00:18:01.812332 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.816332 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 00:18:01.630419 => 00:18:01.815333
[0m00:18:01.817334 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m00:18:01.819332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D48A8650>]}
[0m00:18:01.821332 [info ] [Thread-1 (]: 2 of 12 OK created sql table model prodia_test.stg_appointments ................ [[32mSUCCESS 1000[0m in 0.20s]
[0m00:18:01.824060 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m00:18:01.826047 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m00:18:01.827212 [info ] [Thread-1 (]: 3 of 12 START sql table model prodia_test.stg_doctors .......................... [RUN]
[0m00:18:01.830256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_doctors)
[0m00:18:01.831259 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m00:18:01.840275 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m00:18:01.843353 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 00:18:01.832260 => 00:18:01.842275
[0m00:18:01.844275 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m00:18:01.855275 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m00:18:01.858275 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:01.859275 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m00:18:01.861275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:01.874275 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.875275 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:01.877275 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table
    `prodia_test`.`stg_doctors__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_doctors.sql



    select *
    from `prodia_test`.`doctors`

    )

  
[0m00:18:01.955838 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:18:01.962815 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:01.964819 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors__dbt_backup` cascade
  
[0m00:18:01.969059 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:01.972056 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:01.974056 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors` to `prodia_test`.`stg_doctors__dbt_backup`
  
[0m00:18:01.992990 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.001775 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:02.002836 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors` cascade
  
[0m00:18:02.007062 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.010088 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:02.011125 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors__dbt_tmp` to `prodia_test`.`stg_doctors`
  
[0m00:18:02.034102 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.041106 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:18:02.043104 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:02.045099 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:18:02.047107 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.054101 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:02.056102 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */
drop table if exists `prodia_test`.`stg_doctors__dbt_backup`
[0m00:18:02.077191 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.082637 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 00:18:01.845275 => 00:18:02.081193
[0m00:18:02.084932 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m00:18:02.087928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D4963A10>]}
[0m00:18:02.089958 [info ] [Thread-1 (]: 3 of 12 OK created sql table model prodia_test.stg_doctors ..................... [[32mSUCCESS 1000[0m in 0.26s]
[0m00:18:02.093585 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m00:18:02.096309 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_invoices
[0m00:18:02.098310 [info ] [Thread-1 (]: 4 of 12 START sql table model prodia_test.stg_invoices ......................... [RUN]
[0m00:18:02.101604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_invoices)
[0m00:18:02.103827 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_invoices
[0m00:18:02.113055 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_invoices"
[0m00:18:02.116141 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (compile): 00:18:02.105148 => 00:18:02.115054
[0m00:18:02.119097 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_invoices
[0m00:18:02.135274 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_invoices"
[0m00:18:02.137275 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:02.139271 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: BEGIN
[0m00:18:02.141278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:02.154782 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.155776 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:02.156781 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

  
    

  create  table
    `prodia_test`.`stg_invoices__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_billings.sql



    select *
    from `prodia_test`.`invoices`

    )

  
[0m00:18:02.224781 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:18:02.232816 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:02.234129 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    drop table if exists `prodia_test`.`stg_invoices` cascade
  
[0m00:18:02.238353 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.241426 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:02.243427 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    rename table `prodia_test`.`stg_invoices__dbt_tmp` to `prodia_test`.`stg_invoices`
  
[0m00:18:02.262656 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.266820 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m00:18:02.269301 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:02.270301 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m00:18:02.272362 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.279338 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:02.280338 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */
drop table if exists `prodia_test`.`stg_invoices__dbt_backup`
[0m00:18:02.285255 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.289259 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (execute): 00:18:02.121444 => 00:18:02.288259
[0m00:18:02.291323 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: Close
[0m00:18:02.293539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D4963D90>]}
[0m00:18:02.295161 [info ] [Thread-1 (]: 4 of 12 OK created sql table model prodia_test.stg_invoices .................... [[32mSUCCESS 1000[0m in 0.19s]
[0m00:18:02.298140 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_invoices
[0m00:18:02.300429 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m00:18:02.301778 [info ] [Thread-1 (]: 5 of 12 START sql table model prodia_test.stg_patients ......................... [RUN]
[0m00:18:02.304675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_invoices, now model.prodia_dbt.stg_patients)
[0m00:18:02.306068 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m00:18:02.313933 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m00:18:02.315937 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 00:18:02.307107 => 00:18:02.315937
[0m00:18:02.318366 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m00:18:02.331086 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m00:18:02.334275 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:02.335267 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m00:18:02.337561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:02.351962 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.353340 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:02.355357 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table
    `prodia_test`.`stg_patients__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_patients.sql



    select *
    from `prodia_test`.`patients`

    )

  
[0m00:18:02.413524 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:18:02.420899 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:02.422904 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients__dbt_backup` cascade
  
[0m00:18:02.427553 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.430558 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:02.431649 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients` to `prodia_test`.`stg_patients__dbt_backup`
  
[0m00:18:02.447938 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.456132 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:02.457301 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients` cascade
  
[0m00:18:02.462432 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.465432 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:02.466432 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients__dbt_tmp` to `prodia_test`.`stg_patients`
  
[0m00:18:02.482229 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.487644 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:18:02.488645 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:02.490647 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:18:02.493108 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.499106 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:02.501108 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */
drop table if exists `prodia_test`.`stg_patients__dbt_backup`
[0m00:18:02.515515 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.520006 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 00:18:02.319362 => 00:18:02.519019
[0m00:18:02.521010 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m00:18:02.522517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D49425D0>]}
[0m00:18:02.525130 [info ] [Thread-1 (]: 5 of 12 OK created sql table model prodia_test.stg_patients .................... [[32mSUCCESS 998[0m in 0.22s]
[0m00:18:02.528424 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m00:18:02.531437 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m00:18:02.532886 [info ] [Thread-1 (]: 6 of 12 START sql table model prodia_test.stg_procedures ....................... [RUN]
[0m00:18:02.535962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m00:18:02.537269 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m00:18:02.547326 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m00:18:02.549377 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 00:18:02.539277 => 00:18:02.549377
[0m00:18:02.551447 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m00:18:02.560684 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m00:18:02.564683 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:02.566660 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m00:18:02.567660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:02.581693 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.582870 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:02.584679 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table
    `prodia_test`.`stg_procedures__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_procedures.sql



    select *
    from `prodia_test`.`procedures`

    )

  
[0m00:18:02.642464 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:18:02.649478 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:02.650480 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures__dbt_backup` cascade
  
[0m00:18:02.656023 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.659023 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:02.660028 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures` to `prodia_test`.`stg_procedures__dbt_backup`
  
[0m00:18:02.676314 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.683385 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:02.685383 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures` cascade
  
[0m00:18:02.688939 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.692099 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:02.694099 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures__dbt_tmp` to `prodia_test`.`stg_procedures`
  
[0m00:18:02.750262 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.758316 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:18:02.759316 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:02.760321 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:18:02.763771 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.769804 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:02.770803 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */
drop table if exists `prodia_test`.`stg_procedures__dbt_backup`
[0m00:18:02.785568 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.789754 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 00:18:02.553472 => 00:18:02.789754
[0m00:18:02.790751 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m00:18:02.793769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D499D3D0>]}
[0m00:18:02.795771 [info ] [Thread-1 (]: 6 of 12 OK created sql table model prodia_test.stg_procedures .................. [[32mSUCCESS 1000[0m in 0.26s]
[0m00:18:02.798276 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m00:18:02.800329 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m00:18:02.801308 [info ] [Thread-1 (]: 7 of 12 START sql view model prodia_test.my_second_dbt_model ................... [RUN]
[0m00:18:02.804024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m00:18:02.805338 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m00:18:02.814244 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m00:18:02.816246 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 00:18:02.807374 => 00:18:02.816246
[0m00:18:02.818558 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m00:18:02.866648 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m00:18:02.869995 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:02.871016 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m00:18:02.872013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:02.884427 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.886634 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:02.887708 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view `prodia_test`.`my_second_dbt_model__dbt_tmp`
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from `prodia_test`.`my_first_dbt_model`
where id = 1
  );
[0m00:18:02.895975 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.902277 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:02.904252 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup` cascade
  
[0m00:18:02.908421 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.911442 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:02.912498 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model` to `prodia_test`.`my_second_dbt_model__dbt_backup`
  
[0m00:18:02.919170 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.927229 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:02.928230 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model` cascade
  
[0m00:18:02.932753 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.935746 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:02.936745 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model__dbt_tmp` to `prodia_test`.`my_second_dbt_model`
  
[0m00:18:02.943888 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.947931 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:18:02.949926 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:02.950934 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:18:02.952936 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.959936 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:02.960923 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup`
[0m00:18:02.965966 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:02.970042 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 00:18:02.819572 => 00:18:02.970042
[0m00:18:02.971040 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m00:18:02.974042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D498B590>]}
[0m00:18:02.975041 [info ] [Thread-1 (]: 7 of 12 OK created sql view model prodia_test.my_second_dbt_model .............. [[32mSUCCESS 0[0m in 0.17s]
[0m00:18:02.977703 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m00:18:02.979870 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m00:18:02.980919 [info ] [Thread-1 (]: 8 of 12 START sql table model prodia_test.int_invoice_summary .................. [RUN]
[0m00:18:02.984388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_second_dbt_model, now model.prodia_dbt.int_invoice_summary)
[0m00:18:02.985408 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_invoice_summary
[0m00:18:02.994387 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_invoice_summary"
[0m00:18:02.997604 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (compile): 00:18:02.986389 => 00:18:02.996586
[0m00:18:02.998604 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_invoice_summary
[0m00:18:03.008601 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_invoice_summary"
[0m00:18:03.012010 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:03.013006 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: BEGIN
[0m00:18:03.014011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:03.027512 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.028529 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:03.029685 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

  
    

  create  table
    `prodia_test`.`int_invoice_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_invoice_summary.sql



with invoice_summary as (
    select
        i.InvoiceID,
        i.PatientID,
        sum(i.Amount) as total_amount,
        count(i.Items) as item_count
    from
        `prodia_test`.`stg_invoices` i
    group by
        i.InvoiceID,
        i.PatientID
)

select * from invoice_summary
    )

  
[0m00:18:03.092349 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:18:03.099367 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:03.101372 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    drop table if exists `prodia_test`.`int_invoice_summary` cascade
  
[0m00:18:03.106901 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.110189 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:03.111189 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    rename table `prodia_test`.`int_invoice_summary__dbt_tmp` to `prodia_test`.`int_invoice_summary`
  
[0m00:18:03.128599 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.134607 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m00:18:03.135609 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:03.137079 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m00:18:03.140034 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.146030 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:03.148031 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */
drop table if exists `prodia_test`.`int_invoice_summary__dbt_backup`
[0m00:18:03.152344 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.156405 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (execute): 00:18:02.999604 => 00:18:03.156405
[0m00:18:03.157409 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: Close
[0m00:18:03.159398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D37A9AD0>]}
[0m00:18:03.161985 [info ] [Thread-1 (]: 8 of 12 OK created sql table model prodia_test.int_invoice_summary ............. [[32mSUCCESS 1000[0m in 0.18s]
[0m00:18:03.164971 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m00:18:03.166968 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m00:18:03.168970 [info ] [Thread-1 (]: 9 of 12 START sql table model prodia_test.int_patient_summary .................. [RUN]
[0m00:18:03.172970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_invoice_summary, now model.prodia_dbt.int_patient_summary)
[0m00:18:03.174013 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_patient_summary
[0m00:18:03.184136 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_patient_summary"
[0m00:18:03.187142 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (compile): 00:18:03.176137 => 00:18:03.186135
[0m00:18:03.189156 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_patient_summary
[0m00:18:03.199522 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_patient_summary"
[0m00:18:03.202512 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:03.204517 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: BEGIN
[0m00:18:03.205512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:03.218750 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.220784 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:03.222789 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

  
    

  create  table
    `prodia_test`.`int_patient_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_patient_summary.sql


with patient_appointments as (
    select
        p.PatientID,
        p.firstname,
        p.lastname,
        count(a.AppointmentID) as total_appointments
    from
        `prodia_test`.`stg_patients` p
    left join
        `prodia_test`.`stg_appointments` a on p.PatientID = a.PatientID
    group by
        p.PatientID,
        p.firstname,
        p.lastname
)

select * from patient_appointments
    )

  
[0m00:18:03.276216 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:18:03.283711 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:03.285701 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary__dbt_backup` cascade
  
[0m00:18:03.289619 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.292711 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:03.294707 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary` to `prodia_test`.`int_patient_summary__dbt_backup`
  
[0m00:18:03.310951 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.320927 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:03.322939 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary` cascade
  
[0m00:18:03.326930 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.330517 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:03.332540 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary__dbt_tmp` to `prodia_test`.`int_patient_summary`
  
[0m00:18:03.351477 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.356915 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:18:03.357910 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:03.359915 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:18:03.361922 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.369915 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:03.371952 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */
drop table if exists `prodia_test`.`int_patient_summary__dbt_backup`
[0m00:18:03.388111 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.394201 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (execute): 00:18:03.190132 => 00:18:03.393199
[0m00:18:03.396197 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: Close
[0m00:18:03.398202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D4962E90>]}
[0m00:18:03.400660 [info ] [Thread-1 (]: 9 of 12 OK created sql table model prodia_test.int_patient_summary ............. [[32mSUCCESS 998[0m in 0.23s]
[0m00:18:03.404236 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m00:18:03.405290 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m00:18:03.406749 [info ] [Thread-1 (]: 10 of 12 START sql table model prodia_test.int_appointment_details ............. [RUN]
[0m00:18:03.411260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_patient_summary, now model.prodia_dbt.int_appointment_details)
[0m00:18:03.413261 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_appointment_details
[0m00:18:03.425590 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_appointment_details"
[0m00:18:03.428127 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (compile): 00:18:03.414585 => 00:18:03.426643
[0m00:18:03.430137 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_appointment_details
[0m00:18:03.443296 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_appointment_details"
[0m00:18:03.446295 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:03.447295 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: BEGIN
[0m00:18:03.448814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:03.462307 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.464304 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:03.465301 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

  
    

  create  table
    `prodia_test`.`int_appointment_details__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_appointment_details.sql



with appointment_info as (
    select
        a.AppointmentID,
        a.AppointmentDate,
        a.AppointmentTime,
        p.PatientID,
        concat(p.firstname, ' ', p.lastname) as patient_name,
        d.DoctorName,
        pr.ProcedureName
    from
        `prodia_test`.`stg_appointments` a
    join
        `prodia_test`.`stg_patients` p on a.PatientID = p.PatientID
    join
        `prodia_test`.`stg_doctors` d on a.DoctorID = d.DoctorID
    left join
        `prodia_test`.`stg_procedures` pr on a.AppointmentID = pr.AppointmentID
)

select * from appointment_info
    )

  
[0m00:18:03.554371 [debug] [Thread-1 (]: SQL status: SUCCESS 1367 in 0.0 seconds
[0m00:18:03.561373 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:03.562373 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details__dbt_backup` cascade
  
[0m00:18:03.567944 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.569947 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:03.571933 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details` to `prodia_test`.`int_appointment_details__dbt_backup`
  
[0m00:18:03.589304 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.597845 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:03.598849 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details` cascade
  
[0m00:18:03.602818 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.606146 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:03.608229 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details__dbt_tmp` to `prodia_test`.`int_appointment_details`
  
[0m00:18:03.625253 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.630377 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:18:03.631378 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:03.633355 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:18:03.635357 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.642426 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:03.643426 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */
drop table if exists `prodia_test`.`int_appointment_details__dbt_backup`
[0m00:18:03.659660 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.663660 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (execute): 00:18:03.432137 => 00:18:03.662659
[0m00:18:03.664657 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: Close
[0m00:18:03.667877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D495F9D0>]}
[0m00:18:03.669870 [info ] [Thread-1 (]: 10 of 12 OK created sql table model prodia_test.int_appointment_details ........ [[32mSUCCESS 1367[0m in 0.26s]
[0m00:18:03.673194 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m00:18:03.674233 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m00:18:03.676248 [info ] [Thread-1 (]: 11 of 12 START sql table model prodia_test.dm_patient_overview ................. [RUN]
[0m00:18:03.679826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_appointment_details, now model.prodia_dbt.dm_patient_overview)
[0m00:18:03.682256 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_patient_overview
[0m00:18:03.691695 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_patient_overview"
[0m00:18:03.694846 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (compile): 00:18:03.683254 => 00:18:03.693732
[0m00:18:03.695899 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_patient_overview
[0m00:18:03.705933 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_patient_overview"
[0m00:18:03.709345 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:18:03.711334 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: BEGIN
[0m00:18:03.712353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:03.725209 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.726210 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:18:03.727213 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_patient_overview"} */

  
    

  create  table
    `prodia_test`.`dm_patient_overview__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_patient_overview.sql



with patient_overview as (
    select
        ps.PatientID,
        ps.firstname,
        ps.lastname,
        ps.total_appointments,
        COALESCE(SUM(is.total_amount), 0) AS total_spent
    from
        `prodia_test`.`int_patient_summary` ps
    left join
        `prodia_test`.`int_invoice_summary` is on ps.PatientID = is.PatientID
    group by
        ps.PatientID, 
        ps.firstname, 
        ps.lastname
)

select * from patient_overview
    )

  
[0m00:18:03.730514 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'is on ps.PatientID = is.PatientID
    group by
        ps.PatientID, 
        ps' at line 27
[0m00:18:03.731516 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: ROLLBACK
[0m00:18:03.734923 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (execute): 00:18:03.696894 => 00:18:03.733870
[0m00:18:03.735926 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: Close
[0m00:18:03.760779 [debug] [Thread-1 (]: Database Error in model dm_patient_overview (models\datamart\dm_patient_overview.sql)
  1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'is on ps.PatientID = is.PatientID
      group by
          ps.PatientID, 
          ps' at line 27
  compiled Code at target\run\prodia_dbt\models\datamart\dm_patient_overview.sql
[0m00:18:03.762818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D383FC90>]}
[0m00:18:03.764817 [error] [Thread-1 (]: 11 of 12 ERROR creating sql table model prodia_test.dm_patient_overview ........ [[31mERROR[0m in 0.08s]
[0m00:18:03.766955 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m00:18:03.769000 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m00:18:03.769993 [info ] [Thread-1 (]: 12 of 12 START sql table model prodia_test.dm_appointment_summary .............. [RUN]
[0m00:18:03.773018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_patient_overview, now model.prodia_dbt.dm_appointment_summary)
[0m00:18:03.775340 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_appointment_summary
[0m00:18:03.784472 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_appointment_summary"
[0m00:18:03.787645 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (compile): 00:18:03.776837 => 00:18:03.786652
[0m00:18:03.788645 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_appointment_summary
[0m00:18:03.799231 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_appointment_summary"
[0m00:18:03.803318 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:18:03.804320 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: BEGIN
[0m00:18:03.806815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:03.820614 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.822614 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:18:03.823885 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

  
    

  create  table
    `prodia_test`.`dm_appointment_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_appointment_summary.sql



with appointment_summary as (
    select
        ad.AppointmentDate,
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        COUNT(DISTINCT ad.ProcedureName) AS total_procedures
    from
        `prodia_test`.`int_appointment_details` ad
    group by
        ad.AppointmentDate, 
        ad.DoctorName
)
CREATE TABLE datamart.appointment_summary AS
    )

  
[0m00:18:03.826416 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE datamart.appointment_summary AS
    )' at line 29
[0m00:18:03.827414 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: ROLLBACK
[0m00:18:03.830044 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (execute): 00:18:03.790141 => 00:18:03.830044
[0m00:18:03.832203 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: Close
[0m00:18:03.840467 [debug] [Thread-1 (]: Database Error in model dm_appointment_summary (models\datamart\dm_appointment_summary.sql)
  1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE datamart.appointment_summary AS
      )' at line 29
  compiled Code at target\run\prodia_dbt\models\datamart\dm_appointment_summary.sql
[0m00:18:03.842451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0948f0-68de-442c-b948-f4fad8609ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D486D490>]}
[0m00:18:03.843469 [error] [Thread-1 (]: 12 of 12 ERROR creating sql table model prodia_test.dm_appointment_summary ..... [[31mERROR[0m in 0.07s]
[0m00:18:03.846043 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m00:18:03.850576 [debug] [MainThread]: Using mysql connection "master"
[0m00:18:03.851615 [debug] [MainThread]: On master: BEGIN
[0m00:18:03.852616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:03.866155 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.867158 [debug] [MainThread]: On master: COMMIT
[0m00:18:03.868160 [debug] [MainThread]: Using mysql connection "master"
[0m00:18:03.870157 [debug] [MainThread]: On master: COMMIT
[0m00:18:03.873425 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:03.874431 [debug] [MainThread]: On master: Close
[0m00:18:03.877607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:03.878602 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m00:18:03.879604 [debug] [MainThread]: Connection 'list_None_prodia_test' was properly closed.
[0m00:18:03.880969 [debug] [MainThread]: Connection 'model.prodia_dbt.dm_appointment_summary' was properly closed.
[0m00:18:03.882063 [info ] [MainThread]: 
[0m00:18:03.885062 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m00:18:03.893556 [debug] [MainThread]: Command end result
[0m00:18:03.921307 [info ] [MainThread]: 
[0m00:18:03.923351 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:18:03.925956 [info ] [MainThread]: 
[0m00:18:03.927975 [error] [MainThread]: [33mDatabase Error in model dm_patient_overview (models\datamart\dm_patient_overview.sql)[0m
[0m00:18:03.930006 [error] [MainThread]:   1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'is on ps.PatientID = is.PatientID
[0m00:18:03.931028 [error] [MainThread]:       group by
[0m00:18:03.934969 [error] [MainThread]:           ps.PatientID, 
[0m00:18:03.936960 [error] [MainThread]:           ps' at line 27
[0m00:18:03.938970 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_patient_overview.sql
[0m00:18:03.940960 [info ] [MainThread]: 
[0m00:18:03.944300 [error] [MainThread]: [33mDatabase Error in model dm_appointment_summary (models\datamart\dm_appointment_summary.sql)[0m
[0m00:18:03.946295 [error] [MainThread]:   1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE datamart.appointment_summary AS
[0m00:18:03.948294 [error] [MainThread]:       )' at line 29
[0m00:18:03.950508 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_appointment_summary.sql
[0m00:18:03.952861 [info ] [MainThread]: 
[0m00:18:03.955487 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m00:18:03.959287 [debug] [MainThread]: Command `dbt run` failed at 00:18:03.959287 after 6.59 seconds
[0m00:18:03.960762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D1EE3510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D3181D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D3181390>]}
[0m00:18:03.961816 [debug] [MainThread]: Flushing usage events
[0m00:18:37.163723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DEDF0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DF3CE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DF3CF410>]}


============================== 00:18:37.170181 | 89bbb1ec-20a7-4829-a075-7e57fab9138f ==============================
[0m00:18:37.170181 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:18:37.172340 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'introspect': 'True', 'version_check': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'log_format': 'default', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'debug': 'False'}
[0m00:18:38.105755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DF6DC350>]}
[0m00:18:38.155755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DF6DC350>]}
[0m00:18:38.183697 [debug] [MainThread]: checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, vars: {}, profile: , target: mysql, version: 1.5.0
[0m00:18:38.285770 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:18:38.288767 [debug] [MainThread]: previous checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m00:18:38.289768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0A0B950>]}
[0m00:18:39.963363 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m00:18:39.995708 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m00:18:40.004748 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:18:40.014010 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:18:40.023098 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m00:18:40.031186 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m00:18:40.040160 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m00:18:40.050340 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m00:18:40.063870 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m00:18:40.068868 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m00:18:40.080915 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m00:18:40.086560 [debug] [MainThread]: 1603: static parser failed on staging\stg_invoices.sql
[0m00:18:40.097017 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_invoices.sql
[0m00:18:40.102017 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m00:18:40.113314 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m00:18:40.118356 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m00:18:40.130370 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m00:18:40.514731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0A2F210>]}
[0m00:18:40.536734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0A9C9D0>]}
[0m00:18:40.538733 [info ] [MainThread]: Found 12 models, 4 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:18:40.541103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0A9C5D0>]}
[0m00:18:40.546097 [info ] [MainThread]: 
[0m00:18:40.549363 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m00:18:40.557641 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m00:18:40.584615 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m00:18:40.586603 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m00:18:40.587602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:40.615186 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m00:18:40.619159 [debug] [ThreadPool]: On list_schemas: Close
[0m00:18:40.625795 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_prodia_test'
[0m00:18:40.638793 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:18:40.639792 [debug] [ThreadPool]: On list_None_prodia_test: BEGIN
[0m00:18:40.640799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:40.652350 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:40.654711 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:18:40.655710 [debug] [ThreadPool]: On list_None_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_None_prodia_test"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'prodia_test'
  
[0m00:18:40.659795 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.0 seconds
[0m00:18:40.663793 [debug] [ThreadPool]: On list_None_prodia_test: ROLLBACK
[0m00:18:40.665816 [debug] [ThreadPool]: On list_None_prodia_test: Close
[0m00:18:40.674819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DF3D1310>]}
[0m00:18:40.675820 [debug] [MainThread]: Using mysql connection "master"
[0m00:18:40.677131 [debug] [MainThread]: On master: BEGIN
[0m00:18:40.678188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:40.691212 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:40.692386 [debug] [MainThread]: On master: COMMIT
[0m00:18:40.693384 [debug] [MainThread]: Using mysql connection "master"
[0m00:18:40.695388 [debug] [MainThread]: On master: COMMIT
[0m00:18:40.696384 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:40.698825 [debug] [MainThread]: On master: Close
[0m00:18:40.700831 [info ] [MainThread]: Concurrency: 1 threads (target='mysql')
[0m00:18:40.703066 [info ] [MainThread]: 
[0m00:18:40.716481 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m00:18:40.717482 [info ] [Thread-1 (]: 1 of 12 START sql table model prodia_test.my_first_dbt_model ................... [RUN]
[0m00:18:40.720487 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.prodia_dbt.my_first_dbt_model'
[0m00:18:40.725996 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m00:18:40.733402 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m00:18:40.737086 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 00:18:40.727299 => 00:18:40.735630
[0m00:18:40.739967 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m00:18:40.842520 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m00:18:40.844576 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:40.846553 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m00:18:40.847720 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:40.860868 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:40.863529 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:40.864543 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table
    `prodia_test`.`my_first_dbt_model__dbt_tmp`
    
    
      as
    
    (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

  
[0m00:18:40.889317 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:18:40.905316 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:40.907317 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup` cascade
  
[0m00:18:40.912568 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:40.915616 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:40.916669 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model` to `prodia_test`.`my_first_dbt_model__dbt_backup`
  
[0m00:18:40.934284 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:40.942547 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:40.943581 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model` cascade
  
[0m00:18:40.948345 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:40.951374 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:40.953373 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model__dbt_tmp` to `prodia_test`.`my_first_dbt_model`
  
[0m00:18:40.970036 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.026545 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:18:41.027532 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:41.029041 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:18:41.031605 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.043852 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:18:41.045850 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup`
[0m00:18:41.058944 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.064978 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 00:18:40.740963 => 00:18:41.063984
[0m00:18:41.065980 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m00:18:41.068986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0A98FD0>]}
[0m00:18:41.070443 [info ] [Thread-1 (]: 1 of 12 OK created sql table model prodia_test.my_first_dbt_model .............. [[32mSUCCESS 2[0m in 0.35s]
[0m00:18:41.073880 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m00:18:41.076879 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m00:18:41.077872 [info ] [Thread-1 (]: 2 of 12 START sql table model prodia_test.stg_appointments ..................... [RUN]
[0m00:18:41.081779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m00:18:41.083814 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m00:18:41.092516 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m00:18:41.096509 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 00:18:41.084816 => 00:18:41.095512
[0m00:18:41.098513 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m00:18:41.110429 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m00:18:41.113647 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:41.114681 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m00:18:41.116683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:41.129965 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.132165 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:41.133162 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table
    `prodia_test`.`stg_appointments__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_appointments.sql



    select *
    from `prodia_test`.`appointments`

    )

  
[0m00:18:41.193800 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:18:41.201379 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:41.203382 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments__dbt_backup` cascade
  
[0m00:18:41.207361 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.210359 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:41.212370 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments` to `prodia_test`.`stg_appointments__dbt_backup`
  
[0m00:18:41.229701 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.237769 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:41.238770 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments` cascade
  
[0m00:18:41.243771 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.246801 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:41.247801 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments__dbt_tmp` to `prodia_test`.`stg_appointments`
  
[0m00:18:41.267449 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.271672 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:18:41.273674 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:41.274679 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:18:41.277682 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.283675 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:18:41.285675 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */
drop table if exists `prodia_test`.`stg_appointments__dbt_backup`
[0m00:18:41.300470 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.304469 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 00:18:41.099613 => 00:18:41.304469
[0m00:18:41.306460 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m00:18:41.308643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0A0AF90>]}
[0m00:18:41.310682 [info ] [Thread-1 (]: 2 of 12 OK created sql table model prodia_test.stg_appointments ................ [[32mSUCCESS 1000[0m in 0.23s]
[0m00:18:41.313979 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m00:18:41.314978 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m00:18:41.316965 [info ] [Thread-1 (]: 3 of 12 START sql table model prodia_test.stg_doctors .......................... [RUN]
[0m00:18:41.319964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_doctors)
[0m00:18:41.321961 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m00:18:41.330640 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m00:18:41.333635 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 00:18:41.323144 => 00:18:41.333635
[0m00:18:41.334962 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m00:18:41.346312 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m00:18:41.349304 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:41.351300 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m00:18:41.353305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:41.367037 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.368034 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:41.369036 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table
    `prodia_test`.`stg_doctors__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_doctors.sql



    select *
    from `prodia_test`.`doctors`

    )

  
[0m00:18:41.429023 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:18:41.435518 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:41.436759 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors__dbt_backup` cascade
  
[0m00:18:41.441791 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.444791 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:41.445791 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors` to `prodia_test`.`stg_doctors__dbt_backup`
  
[0m00:18:41.462565 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.470051 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:41.471051 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors` cascade
  
[0m00:18:41.475833 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.479320 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:41.480369 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors__dbt_tmp` to `prodia_test`.`stg_doctors`
  
[0m00:18:41.499274 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.509340 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:18:41.511335 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:41.512608 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:18:41.516001 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.522520 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:18:41.524522 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */
drop table if exists `prodia_test`.`stg_doctors__dbt_backup`
[0m00:18:41.541669 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.546674 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 00:18:41.335961 => 00:18:41.545675
[0m00:18:41.548671 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m00:18:41.552672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0BB3C50>]}
[0m00:18:41.554672 [info ] [Thread-1 (]: 3 of 12 OK created sql table model prodia_test.stg_doctors ..................... [[32mSUCCESS 1000[0m in 0.23s]
[0m00:18:41.557924 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m00:18:41.560002 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_invoices
[0m00:18:41.561428 [info ] [Thread-1 (]: 4 of 12 START sql table model prodia_test.stg_invoices ......................... [RUN]
[0m00:18:41.563845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_invoices)
[0m00:18:41.566215 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_invoices
[0m00:18:41.576817 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_invoices"
[0m00:18:41.579819 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (compile): 00:18:41.568218 => 00:18:41.578820
[0m00:18:41.580823 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_invoices
[0m00:18:41.591901 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_invoices"
[0m00:18:41.595896 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:41.596900 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: BEGIN
[0m00:18:41.598900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:41.613519 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.614499 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:41.616518 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

  
    

  create  table
    `prodia_test`.`stg_invoices__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_billings.sql



    select *
    from `prodia_test`.`invoices`

    )

  
[0m00:18:41.679717 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:18:41.687969 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:41.689005 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    drop table if exists `prodia_test`.`stg_invoices__dbt_backup` cascade
  
[0m00:18:41.693776 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.696829 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:41.697830 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    rename table `prodia_test`.`stg_invoices` to `prodia_test`.`stg_invoices__dbt_backup`
  
[0m00:18:41.714246 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.722245 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:41.724251 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    drop table if exists `prodia_test`.`stg_invoices` cascade
  
[0m00:18:41.728294 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.731295 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:41.732294 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    rename table `prodia_test`.`stg_invoices__dbt_tmp` to `prodia_test`.`stg_invoices`
  
[0m00:18:41.750618 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.757617 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m00:18:41.759620 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:41.761618 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m00:18:41.763614 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.770731 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:18:41.772730 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */
drop table if exists `prodia_test`.`stg_invoices__dbt_backup`
[0m00:18:41.787051 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.792053 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (execute): 00:18:41.581824 => 00:18:41.791050
[0m00:18:41.794074 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: Close
[0m00:18:41.796167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0BB0190>]}
[0m00:18:41.798187 [info ] [Thread-1 (]: 4 of 12 OK created sql table model prodia_test.stg_invoices .................... [[32mSUCCESS 1000[0m in 0.23s]
[0m00:18:41.801214 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_invoices
[0m00:18:41.803273 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m00:18:41.804254 [info ] [Thread-1 (]: 5 of 12 START sql table model prodia_test.stg_patients ......................... [RUN]
[0m00:18:41.808582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_invoices, now model.prodia_dbt.stg_patients)
[0m00:18:41.810744 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m00:18:41.819764 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m00:18:41.824599 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 00:18:41.811739 => 00:18:41.823596
[0m00:18:41.825602 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m00:18:41.835447 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m00:18:41.838536 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:41.840577 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m00:18:41.842576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:41.857684 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.859676 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:41.860861 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table
    `prodia_test`.`stg_patients__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_patients.sql



    select *
    from `prodia_test`.`patients`

    )

  
[0m00:18:41.921020 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:18:41.929151 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:41.930152 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients__dbt_backup` cascade
  
[0m00:18:41.935910 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.938914 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:41.939911 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients` to `prodia_test`.`stg_patients__dbt_backup`
  
[0m00:18:41.957422 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.964446 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:41.966425 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients` cascade
  
[0m00:18:41.970903 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:41.975021 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:41.976022 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients__dbt_tmp` to `prodia_test`.`stg_patients`
  
[0m00:18:41.995301 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.000307 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:18:42.002308 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:42.003309 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:18:42.005664 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.012763 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:18:42.013764 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */
drop table if exists `prodia_test`.`stg_patients__dbt_backup`
[0m00:18:42.029682 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.033709 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 00:18:41.826639 => 00:18:42.033709
[0m00:18:42.035711 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m00:18:42.037714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0BB0190>]}
[0m00:18:42.039779 [info ] [Thread-1 (]: 5 of 12 OK created sql table model prodia_test.stg_patients .................... [[32mSUCCESS 998[0m in 0.23s]
[0m00:18:42.042819 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m00:18:42.043816 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m00:18:42.045827 [info ] [Thread-1 (]: 6 of 12 START sql table model prodia_test.stg_procedures ....................... [RUN]
[0m00:18:42.049651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m00:18:42.050656 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m00:18:42.059933 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m00:18:42.063940 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 00:18:42.053126 => 00:18:42.062937
[0m00:18:42.064938 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m00:18:42.074933 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m00:18:42.076936 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:42.078937 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m00:18:42.080936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:42.095060 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.097120 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:42.098142 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table
    `prodia_test`.`stg_procedures__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_procedures.sql



    select *
    from `prodia_test`.`procedures`

    )

  
[0m00:18:42.156472 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:18:42.163483 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:42.164483 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures__dbt_backup` cascade
  
[0m00:18:42.170863 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.173229 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:42.177232 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures` to `prodia_test`.`stg_procedures__dbt_backup`
  
[0m00:18:42.196437 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.204431 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:42.205433 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures` cascade
  
[0m00:18:42.209491 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.212515 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:42.214495 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures__dbt_tmp` to `prodia_test`.`stg_procedures`
  
[0m00:18:42.233079 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.238663 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:18:42.240660 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:42.241660 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:18:42.244659 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.252781 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:18:42.253584 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */
drop table if exists `prodia_test`.`stg_procedures__dbt_backup`
[0m00:18:42.270023 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.275022 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 00:18:42.065938 => 00:18:42.274023
[0m00:18:42.276023 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m00:18:42.278028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DF986250>]}
[0m00:18:42.280208 [info ] [Thread-1 (]: 6 of 12 OK created sql table model prodia_test.stg_procedures .................. [[32mSUCCESS 1000[0m in 0.23s]
[0m00:18:42.283440 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m00:18:42.285558 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m00:18:42.287074 [info ] [Thread-1 (]: 7 of 12 START sql view model prodia_test.my_second_dbt_model ................... [RUN]
[0m00:18:42.291554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m00:18:42.292557 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m00:18:42.303219 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m00:18:42.306658 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 00:18:42.294554 => 00:18:42.306658
[0m00:18:42.309137 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m00:18:42.358911 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m00:18:42.361112 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:42.362462 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m00:18:42.363713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:42.375901 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.376901 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:42.378889 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view `prodia_test`.`my_second_dbt_model__dbt_tmp`
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from `prodia_test`.`my_first_dbt_model`
where id = 1
  );
[0m00:18:42.384821 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.392546 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:42.393547 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup` cascade
  
[0m00:18:42.397459 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.400534 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:42.402510 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model` to `prodia_test`.`my_second_dbt_model__dbt_backup`
  
[0m00:18:42.407996 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.416076 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:42.417078 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model` cascade
  
[0m00:18:42.420829 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.423985 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:42.425065 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model__dbt_tmp` to `prodia_test`.`my_second_dbt_model`
  
[0m00:18:42.432055 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.436049 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:18:42.438048 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:42.439109 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:18:42.440142 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.447673 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:18:42.448678 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup`
[0m00:18:42.454903 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.458033 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 00:18:42.310138 => 00:18:42.458033
[0m00:18:42.460038 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m00:18:42.462024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0AFF150>]}
[0m00:18:42.464040 [info ] [Thread-1 (]: 7 of 12 OK created sql view model prodia_test.my_second_dbt_model .............. [[32mSUCCESS 0[0m in 0.17s]
[0m00:18:42.467518 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m00:18:42.468753 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m00:18:42.470260 [info ] [Thread-1 (]: 8 of 12 START sql table model prodia_test.int_invoice_summary .................. [RUN]
[0m00:18:42.474294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_second_dbt_model, now model.prodia_dbt.int_invoice_summary)
[0m00:18:42.476312 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_invoice_summary
[0m00:18:42.485855 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_invoice_summary"
[0m00:18:42.490308 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (compile): 00:18:42.478291 => 00:18:42.489308
[0m00:18:42.492302 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_invoice_summary
[0m00:18:42.502496 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_invoice_summary"
[0m00:18:42.509266 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:42.511266 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: BEGIN
[0m00:18:42.512540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:42.526333 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.527332 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:42.528336 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

  
    

  create  table
    `prodia_test`.`int_invoice_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_invoice_summary.sql



with invoice_summary as (
    select
        i.InvoiceID,
        i.PatientID,
        sum(i.Amount) as total_amount,
        count(i.Items) as item_count
    from
        `prodia_test`.`stg_invoices` i
    group by
        i.InvoiceID,
        i.PatientID
)

select * from invoice_summary
    )

  
[0m00:18:42.579689 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:18:42.586980 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:42.587981 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    drop table if exists `prodia_test`.`int_invoice_summary__dbt_backup` cascade
  
[0m00:18:42.594285 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.597290 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:42.598383 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    rename table `prodia_test`.`int_invoice_summary` to `prodia_test`.`int_invoice_summary__dbt_backup`
  
[0m00:18:42.614919 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.621929 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:42.623939 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    drop table if exists `prodia_test`.`int_invoice_summary` cascade
  
[0m00:18:42.629129 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.632124 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:42.633171 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    rename table `prodia_test`.`int_invoice_summary__dbt_tmp` to `prodia_test`.`int_invoice_summary`
  
[0m00:18:42.651486 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.657506 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m00:18:42.658507 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:42.659508 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m00:18:42.662707 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.667699 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:18:42.670068 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */
drop table if exists `prodia_test`.`int_invoice_summary__dbt_backup`
[0m00:18:42.684695 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.688764 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (execute): 00:18:42.493456 => 00:18:42.688764
[0m00:18:42.690758 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: Close
[0m00:18:42.692740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0ABE610>]}
[0m00:18:42.694881 [info ] [Thread-1 (]: 8 of 12 OK created sql table model prodia_test.int_invoice_summary ............. [[32mSUCCESS 1000[0m in 0.22s]
[0m00:18:42.697253 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m00:18:42.699307 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m00:18:42.701500 [info ] [Thread-1 (]: 9 of 12 START sql table model prodia_test.int_patient_summary .................. [RUN]
[0m00:18:42.704897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_invoice_summary, now model.prodia_dbt.int_patient_summary)
[0m00:18:42.705889 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_patient_summary
[0m00:18:42.715484 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_patient_summary"
[0m00:18:42.718003 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (compile): 00:18:42.707192 => 00:18:42.718003
[0m00:18:42.720003 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_patient_summary
[0m00:18:42.732529 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_patient_summary"
[0m00:18:42.734610 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:42.736608 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: BEGIN
[0m00:18:42.737607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:42.751311 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.753419 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:42.755827 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

  
    

  create  table
    `prodia_test`.`int_patient_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_patient_summary.sql


with patient_appointments as (
    select
        p.PatientID,
        p.firstname,
        p.lastname,
        count(a.AppointmentID) as total_appointments
    from
        `prodia_test`.`stg_patients` p
    left join
        `prodia_test`.`stg_appointments` a on p.PatientID = a.PatientID
    group by
        p.PatientID,
        p.firstname,
        p.lastname
)

select * from patient_appointments
    )

  
[0m00:18:42.812518 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:18:42.819519 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:42.820520 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary__dbt_backup` cascade
  
[0m00:18:42.824491 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.828280 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:42.829329 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary` to `prodia_test`.`int_patient_summary__dbt_backup`
  
[0m00:18:42.847119 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.854142 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:42.856124 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary` cascade
  
[0m00:18:42.860662 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.864766 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:42.866767 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary__dbt_tmp` to `prodia_test`.`int_patient_summary`
  
[0m00:18:42.887697 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.893147 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:18:42.895145 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:42.896139 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:18:42.899492 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.908855 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:18:42.909830 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */
drop table if exists `prodia_test`.`int_patient_summary__dbt_backup`
[0m00:18:42.926561 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.931917 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (execute): 00:18:42.720997 => 00:18:42.930564
[0m00:18:42.934340 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: Close
[0m00:18:42.936545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0B95E50>]}
[0m00:18:42.938547 [info ] [Thread-1 (]: 9 of 12 OK created sql table model prodia_test.int_patient_summary ............. [[32mSUCCESS 998[0m in 0.23s]
[0m00:18:42.941817 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m00:18:42.943826 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m00:18:42.944844 [info ] [Thread-1 (]: 10 of 12 START sql table model prodia_test.int_appointment_details ............. [RUN]
[0m00:18:42.948867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_patient_summary, now model.prodia_dbt.int_appointment_details)
[0m00:18:42.949847 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_appointment_details
[0m00:18:42.961469 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_appointment_details"
[0m00:18:42.965592 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (compile): 00:18:42.952170 => 00:18:42.964462
[0m00:18:42.967614 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_appointment_details
[0m00:18:42.978879 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_appointment_details"
[0m00:18:42.982849 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:42.983850 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: BEGIN
[0m00:18:42.984847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:42.998299 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:42.999560 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:43.000540 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

  
    

  create  table
    `prodia_test`.`int_appointment_details__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_appointment_details.sql



with appointment_info as (
    select
        a.AppointmentID,
        a.AppointmentDate,
        a.AppointmentTime,
        p.PatientID,
        concat(p.firstname, ' ', p.lastname) as patient_name,
        d.DoctorName,
        pr.ProcedureName
    from
        `prodia_test`.`stg_appointments` a
    join
        `prodia_test`.`stg_patients` p on a.PatientID = p.PatientID
    join
        `prodia_test`.`stg_doctors` d on a.DoctorID = d.DoctorID
    left join
        `prodia_test`.`stg_procedures` pr on a.AppointmentID = pr.AppointmentID
)

select * from appointment_info
    )

  
[0m00:18:43.075433 [debug] [Thread-1 (]: SQL status: SUCCESS 1367 in 0.0 seconds
[0m00:18:43.083424 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:43.084426 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details__dbt_backup` cascade
  
[0m00:18:43.088230 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.091961 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:43.092960 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details` to `prodia_test`.`int_appointment_details__dbt_backup`
  
[0m00:18:43.111751 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.119300 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:43.121296 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details` cascade
  
[0m00:18:43.126436 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.128452 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:43.130453 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details__dbt_tmp` to `prodia_test`.`int_appointment_details`
  
[0m00:18:43.148550 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.153562 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:18:43.154560 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:43.155561 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:18:43.158562 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.164635 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:18:43.166637 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */
drop table if exists `prodia_test`.`int_appointment_details__dbt_backup`
[0m00:18:43.181279 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.186275 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (execute): 00:18:42.969593 => 00:18:43.185272
[0m00:18:43.188272 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: Close
[0m00:18:43.190273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0B60850>]}
[0m00:18:43.192273 [info ] [Thread-1 (]: 10 of 12 OK created sql table model prodia_test.int_appointment_details ........ [[32mSUCCESS 1367[0m in 0.24s]
[0m00:18:43.195330 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m00:18:43.196333 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m00:18:43.198315 [info ] [Thread-1 (]: 11 of 12 START sql table model prodia_test.dm_patient_overview ................. [RUN]
[0m00:18:43.201423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_appointment_details, now model.prodia_dbt.dm_patient_overview)
[0m00:18:43.203700 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_patient_overview
[0m00:18:43.212506 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_patient_overview"
[0m00:18:43.215482 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (compile): 00:18:43.204987 => 00:18:43.214482
[0m00:18:43.217481 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_patient_overview
[0m00:18:43.227480 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_patient_overview"
[0m00:18:43.230487 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:18:43.233064 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: BEGIN
[0m00:18:43.234056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:43.246825 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.249366 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:18:43.250747 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_patient_overview"} */

  
    

  create  table
    `prodia_test`.`dm_patient_overview__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_patient_overview.sql



with patient_overview as (
    select
        ps.PatientID,
        ps.firstname,
        ps.lastname,
        ps.total_appointments,
        COALESCE(SUM(is.total_amount), 0) AS total_spent
    from
        `prodia_test`.`int_patient_summary` ps
    left join
        `prodia_test`.`int_invoice_summary` is on ps.PatientID = is.PatientID
    group by
        ps.PatientID, 
        ps.firstname, 
        ps.lastname
)

select * from patient_overview
    )

  
[0m00:18:43.253023 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'is on ps.PatientID = is.PatientID
    group by
        ps.PatientID, 
        ps' at line 27
[0m00:18:43.254032 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: ROLLBACK
[0m00:18:43.257026 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (execute): 00:18:43.218488 => 00:18:43.257026
[0m00:18:43.259026 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: Close
[0m00:18:43.285091 [debug] [Thread-1 (]: Database Error in model dm_patient_overview (models\datamart\dm_patient_overview.sql)
  1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'is on ps.PatientID = is.PatientID
      group by
          ps.PatientID, 
          ps' at line 27
  compiled Code at target\run\prodia_dbt\models\datamart\dm_patient_overview.sql
[0m00:18:43.286095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0AF8490>]}
[0m00:18:43.288661 [error] [Thread-1 (]: 11 of 12 ERROR creating sql table model prodia_test.dm_patient_overview ........ [[31mERROR[0m in 0.09s]
[0m00:18:43.290987 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m00:18:43.292123 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m00:18:43.293924 [info ] [Thread-1 (]: 12 of 12 START sql table model prodia_test.dm_appointment_summary .............. [RUN]
[0m00:18:43.297965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_patient_overview, now model.prodia_dbt.dm_appointment_summary)
[0m00:18:43.299005 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_appointment_summary
[0m00:18:43.308351 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_appointment_summary"
[0m00:18:43.311354 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (compile): 00:18:43.300317 => 00:18:43.310348
[0m00:18:43.313353 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_appointment_summary
[0m00:18:43.324686 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_appointment_summary"
[0m00:18:43.326772 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:18:43.328900 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: BEGIN
[0m00:18:43.330086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:43.343169 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.344397 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:18:43.346428 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

  
    

  create  table
    `prodia_test`.`dm_appointment_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_appointment_summary.sql



with appointment_summary as (
    select
        ad.AppointmentDate,
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        COUNT(DISTINCT ad.ProcedureName) AS total_procedures
    from
        `prodia_test`.`int_appointment_details` ad
    group by
        ad.AppointmentDate, 
        ad.DoctorName
)

select * from appointment_summary
    )

  
[0m00:18:43.402942 [debug] [Thread-1 (]: SQL status: SUCCESS 999 in 0.0 seconds
[0m00:18:43.409959 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:18:43.410963 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    drop table if exists `prodia_test`.`dm_appointment_summary` cascade
  
[0m00:18:43.415992 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.418983 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:18:43.421193 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    rename table `prodia_test`.`dm_appointment_summary__dbt_tmp` to `prodia_test`.`dm_appointment_summary`
  
[0m00:18:43.437988 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.442985 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m00:18:43.449986 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:18:43.450985 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m00:18:43.452987 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.458983 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:18:43.460984 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
drop table if exists `prodia_test`.`dm_appointment_summary__dbt_backup`
[0m00:18:43.464979 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.468983 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (execute): 00:18:43.314347 => 00:18:43.468983
[0m00:18:43.469983 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: Close
[0m00:18:43.473066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89bbb1ec-20a7-4829-a075-7e57fab9138f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0CED4D0>]}
[0m00:18:43.474987 [info ] [Thread-1 (]: 12 of 12 OK created sql table model prodia_test.dm_appointment_summary ......... [[32mSUCCESS 999[0m in 0.18s]
[0m00:18:43.478985 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m00:18:43.482985 [debug] [MainThread]: Using mysql connection "master"
[0m00:18:43.483984 [debug] [MainThread]: On master: BEGIN
[0m00:18:43.485017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:43.497992 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.499992 [debug] [MainThread]: On master: COMMIT
[0m00:18:43.501989 [debug] [MainThread]: Using mysql connection "master"
[0m00:18:43.502992 [debug] [MainThread]: On master: COMMIT
[0m00:18:43.506998 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:18:43.507990 [debug] [MainThread]: On master: Close
[0m00:18:43.510229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:43.511985 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m00:18:43.511985 [debug] [MainThread]: Connection 'list_None_prodia_test' was properly closed.
[0m00:18:43.513985 [debug] [MainThread]: Connection 'model.prodia_dbt.dm_appointment_summary' was properly closed.
[0m00:18:43.515225 [info ] [MainThread]: 
[0m00:18:43.516992 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m00:18:43.527993 [debug] [MainThread]: Command end result
[0m00:18:43.550991 [info ] [MainThread]: 
[0m00:18:43.553998 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:18:43.557992 [info ] [MainThread]: 
[0m00:18:43.560992 [error] [MainThread]: [33mDatabase Error in model dm_patient_overview (models\datamart\dm_patient_overview.sql)[0m
[0m00:18:43.562990 [error] [MainThread]:   1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'is on ps.PatientID = is.PatientID
[0m00:18:43.564985 [error] [MainThread]:       group by
[0m00:18:43.566959 [error] [MainThread]:           ps.PatientID, 
[0m00:18:43.568963 [error] [MainThread]:           ps' at line 27
[0m00:18:43.572015 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_patient_overview.sql
[0m00:18:43.575303 [info ] [MainThread]: 
[0m00:18:43.576587 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m00:18:43.580558 [debug] [MainThread]: Command `dbt run` failed at 00:18:43.579022 after 6.45 seconds
[0m00:18:43.582047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D8700A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267D8700890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E0AE45D0>]}
[0m00:18:43.582578 [debug] [MainThread]: Flushing usage events
[0m00:19:16.872284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD800DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD815FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD815F4D0>]}


============================== 00:19:16.878644 | a6646c3d-edbe-4b71-97b7-ef49e462f163 ==============================
[0m00:19:16.878644 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:19:16.880868 [debug] [MainThread]: running dbt with arguments {'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'version_check': 'True', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m00:19:17.810068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD7156D90>]}
[0m00:19:17.860073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD7156D90>]}
[0m00:19:17.887930 [debug] [MainThread]: checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, vars: {}, profile: , target: mysql, version: 1.5.0
[0m00:19:18.000699 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:19:18.002676 [debug] [MainThread]: previous checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m00:19:18.003676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD87CB7D0>]}
[0m00:19:19.694843 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m00:19:19.726637 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m00:19:19.736048 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:19:19.744047 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:19:19.753508 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m00:19:19.762105 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m00:19:19.770733 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m00:19:19.779231 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m00:19:19.792811 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m00:19:19.797810 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m00:19:19.809090 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m00:19:19.813516 [debug] [MainThread]: 1603: static parser failed on staging\stg_invoices.sql
[0m00:19:19.825089 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_invoices.sql
[0m00:19:19.830089 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m00:19:19.841306 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m00:19:19.845860 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m00:19:19.858024 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m00:19:20.247494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD87023D0>]}
[0m00:19:20.267474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD8846910>]}
[0m00:19:20.269474 [info ] [MainThread]: Found 12 models, 4 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:19:20.271476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD86CF250>]}
[0m00:19:20.276977 [info ] [MainThread]: 
[0m00:19:20.280300 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m00:19:20.288031 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m00:19:20.318265 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m00:19:20.319267 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m00:19:20.320268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:20.349577 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m00:19:20.352984 [debug] [ThreadPool]: On list_schemas: Close
[0m00:19:20.359359 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_prodia_test'
[0m00:19:20.372356 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:19:20.374354 [debug] [ThreadPool]: On list_None_prodia_test: BEGIN
[0m00:19:20.375746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:20.387368 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.389356 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:19:20.389356 [debug] [ThreadPool]: On list_None_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_None_prodia_test"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'prodia_test'
  
[0m00:19:20.393974 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 0.0 seconds
[0m00:19:20.397956 [debug] [ThreadPool]: On list_None_prodia_test: ROLLBACK
[0m00:19:20.399959 [debug] [ThreadPool]: On list_None_prodia_test: Close
[0m00:19:20.410443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD86B4CD0>]}
[0m00:19:20.412428 [debug] [MainThread]: Using mysql connection "master"
[0m00:19:20.413596 [debug] [MainThread]: On master: BEGIN
[0m00:19:20.414657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:20.426711 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.427712 [debug] [MainThread]: On master: COMMIT
[0m00:19:20.429237 [debug] [MainThread]: Using mysql connection "master"
[0m00:19:20.430286 [debug] [MainThread]: On master: COMMIT
[0m00:19:20.432876 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.433851 [debug] [MainThread]: On master: Close
[0m00:19:20.436264 [info ] [MainThread]: Concurrency: 1 threads (target='mysql')
[0m00:19:20.438261 [info ] [MainThread]: 
[0m00:19:20.452179 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m00:19:20.454247 [info ] [Thread-1 (]: 1 of 12 START sql table model prodia_test.my_first_dbt_model ................... [RUN]
[0m00:19:20.460277 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.prodia_dbt.my_first_dbt_model'
[0m00:19:20.462366 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m00:19:20.469315 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m00:19:20.473300 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 00:19:20.463558 => 00:19:20.471293
[0m00:19:20.474301 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m00:19:20.574612 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m00:19:20.577070 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:20.579178 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m00:19:20.580187 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:19:20.592745 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.593745 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:20.595749 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table
    `prodia_test`.`my_first_dbt_model__dbt_tmp`
    
    
      as
    
    (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

  
[0m00:19:20.618070 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:19:20.636954 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:20.637954 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup` cascade
  
[0m00:19:20.642502 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.645983 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:20.647035 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model` to `prodia_test`.`my_first_dbt_model__dbt_backup`
  
[0m00:19:20.666155 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.673370 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:20.675348 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model` cascade
  
[0m00:19:20.678824 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.681999 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:20.683429 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model__dbt_tmp` to `prodia_test`.`my_first_dbt_model`
  
[0m00:19:20.701127 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.755419 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:19:20.756419 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:20.758420 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:19:20.760584 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.773817 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:20.775795 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup`
[0m00:19:20.789316 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.794324 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 00:19:20.476574 => 00:19:20.794324
[0m00:19:20.796322 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m00:19:20.798776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD86F4350>]}
[0m00:19:20.800822 [info ] [Thread-1 (]: 1 of 12 OK created sql table model prodia_test.my_first_dbt_model .............. [[32mSUCCESS 2[0m in 0.34s]
[0m00:19:20.804277 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m00:19:20.805277 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m00:19:20.808271 [info ] [Thread-1 (]: 2 of 12 START sql table model prodia_test.stg_appointments ..................... [RUN]
[0m00:19:20.811264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m00:19:20.813409 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m00:19:20.822433 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m00:19:20.827414 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 00:19:20.815412 => 00:19:20.826409
[0m00:19:20.830417 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m00:19:20.840742 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m00:19:20.844512 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:20.847418 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m00:19:20.848427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:20.862314 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.863440 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:20.865439 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table
    `prodia_test`.`stg_appointments__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_appointments.sql



    select *
    from `prodia_test`.`appointments`

    )

  
[0m00:19:20.928604 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:19:20.936452 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:20.938429 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments__dbt_backup` cascade
  
[0m00:19:20.943372 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.945847 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:20.947917 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments` to `prodia_test`.`stg_appointments__dbt_backup`
  
[0m00:19:20.964703 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.972702 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:20.974704 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments` cascade
  
[0m00:19:20.979137 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:20.982179 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:20.983215 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments__dbt_tmp` to `prodia_test`.`stg_appointments`
  
[0m00:19:21.001983 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.005975 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:19:21.007981 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:21.008979 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:19:21.011985 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.018978 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:21.019979 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */
drop table if exists `prodia_test`.`stg_appointments__dbt_backup`
[0m00:19:21.034035 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.039041 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 00:19:20.831418 => 00:19:21.039041
[0m00:19:21.040040 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m00:19:21.043039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD878BB10>]}
[0m00:19:21.045054 [info ] [Thread-1 (]: 2 of 12 OK created sql table model prodia_test.stg_appointments ................ [[32mSUCCESS 1000[0m in 0.23s]
[0m00:19:21.048055 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m00:19:21.050033 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m00:19:21.051170 [info ] [Thread-1 (]: 3 of 12 START sql table model prodia_test.stg_doctors .......................... [RUN]
[0m00:19:21.054690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_doctors)
[0m00:19:21.058256 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m00:19:21.067275 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m00:19:21.070257 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 00:19:21.060254 => 00:19:21.069253
[0m00:19:21.071268 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m00:19:21.081769 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m00:19:21.084220 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:21.086498 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m00:19:21.087500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:21.100503 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.102927 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:21.103932 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table
    `prodia_test`.`stg_doctors__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_doctors.sql



    select *
    from `prodia_test`.`doctors`

    )

  
[0m00:19:21.163819 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:19:21.172948 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:21.175375 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors__dbt_backup` cascade
  
[0m00:19:21.179187 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.182843 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:21.185123 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors` to `prodia_test`.`stg_doctors__dbt_backup`
  
[0m00:19:21.201965 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.210158 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:21.211159 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors` cascade
  
[0m00:19:21.215337 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.218355 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:21.219355 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors__dbt_tmp` to `prodia_test`.`stg_doctors`
  
[0m00:19:21.237736 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.243116 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:19:21.245286 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:21.246285 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:19:21.249291 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.256547 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:21.257861 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */
drop table if exists `prodia_test`.`stg_doctors__dbt_backup`
[0m00:19:21.274444 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.279645 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 00:19:21.072719 => 00:19:21.278672
[0m00:19:21.281648 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m00:19:21.283652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD86F4350>]}
[0m00:19:21.285648 [info ] [Thread-1 (]: 3 of 12 OK created sql table model prodia_test.stg_doctors ..................... [[32mSUCCESS 1000[0m in 0.23s]
[0m00:19:21.289051 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m00:19:21.291055 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_invoices
[0m00:19:21.292716 [info ] [Thread-1 (]: 4 of 12 START sql table model prodia_test.stg_invoices ......................... [RUN]
[0m00:19:21.295981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_invoices)
[0m00:19:21.298198 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_invoices
[0m00:19:21.307758 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_invoices"
[0m00:19:21.315110 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (compile): 00:19:21.300255 => 00:19:21.315110
[0m00:19:21.316476 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_invoices
[0m00:19:21.330407 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_invoices"
[0m00:19:21.333833 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:21.334838 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: BEGIN
[0m00:19:21.336842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:21.349973 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.351108 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:21.352846 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

  
    

  create  table
    `prodia_test`.`stg_invoices__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_billings.sql



    select *
    from `prodia_test`.`invoices`

    )

  
[0m00:19:21.422365 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:19:21.429380 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:21.430383 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    drop table if exists `prodia_test`.`stg_invoices__dbt_backup` cascade
  
[0m00:19:21.434383 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.437568 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:21.439568 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    rename table `prodia_test`.`stg_invoices` to `prodia_test`.`stg_invoices__dbt_backup`
  
[0m00:19:21.456549 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.463541 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:21.464539 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    drop table if exists `prodia_test`.`stg_invoices` cascade
  
[0m00:19:21.469053 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.472201 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:21.474207 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    rename table `prodia_test`.`stg_invoices__dbt_tmp` to `prodia_test`.`stg_invoices`
  
[0m00:19:21.492152 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.498158 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m00:19:21.500149 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:21.501149 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m00:19:21.504150 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.511151 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:21.512149 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */
drop table if exists `prodia_test`.`stg_invoices__dbt_backup`
[0m00:19:21.526245 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.530225 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (execute): 00:19:21.317699 => 00:19:21.530225
[0m00:19:21.532230 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: Close
[0m00:19:21.535231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD7A1BD10>]}
[0m00:19:21.536231 [info ] [Thread-1 (]: 4 of 12 OK created sql table model prodia_test.stg_invoices .................... [[32mSUCCESS 1000[0m in 0.24s]
[0m00:19:21.539519 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_invoices
[0m00:19:21.541499 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m00:19:21.543506 [info ] [Thread-1 (]: 5 of 12 START sql table model prodia_test.stg_patients ......................... [RUN]
[0m00:19:21.547259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_invoices, now model.prodia_dbt.stg_patients)
[0m00:19:21.549715 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m00:19:21.561502 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m00:19:21.564502 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 00:19:21.550712 => 00:19:21.563500
[0m00:19:21.566500 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m00:19:21.577885 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m00:19:21.581242 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:21.582253 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m00:19:21.584246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:21.596032 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.598415 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:21.599413 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table
    `prodia_test`.`stg_patients__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_patients.sql



    select *
    from `prodia_test`.`patients`

    )

  
[0m00:19:21.692558 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:19:21.700011 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:21.701010 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients__dbt_backup` cascade
  
[0m00:19:21.705738 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.708824 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:21.709829 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients` to `prodia_test`.`stg_patients__dbt_backup`
  
[0m00:19:21.726504 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.734018 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:21.736134 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients` cascade
  
[0m00:19:21.739786 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.742976 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:21.745031 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients__dbt_tmp` to `prodia_test`.`stg_patients`
  
[0m00:19:21.762928 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.767927 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:19:21.768951 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:21.769952 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:19:21.772431 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.781011 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:21.782008 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */
drop table if exists `prodia_test`.`stg_patients__dbt_backup`
[0m00:19:21.797383 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.801671 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 00:19:21.568502 => 00:19:21.800613
[0m00:19:21.802668 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m00:19:21.805670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD86287D0>]}
[0m00:19:21.807195 [info ] [Thread-1 (]: 5 of 12 OK created sql table model prodia_test.stg_patients .................... [[32mSUCCESS 998[0m in 0.26s]
[0m00:19:21.811139 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m00:19:21.812139 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m00:19:21.813464 [info ] [Thread-1 (]: 6 of 12 START sql table model prodia_test.stg_procedures ....................... [RUN]
[0m00:19:21.816679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m00:19:21.819059 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m00:19:21.828015 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m00:19:21.831016 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 00:19:21.820505 => 00:19:21.830021
[0m00:19:21.832018 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m00:19:21.843420 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m00:19:21.846424 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:21.847770 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m00:19:21.848990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:21.862734 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.863731 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:21.864730 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table
    `prodia_test`.`stg_procedures__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_procedures.sql



    select *
    from `prodia_test`.`procedures`

    )

  
[0m00:19:21.923095 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:19:21.932091 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:21.933095 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures__dbt_backup` cascade
  
[0m00:19:21.938414 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.941411 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:21.942421 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures` to `prodia_test`.`stg_procedures__dbt_backup`
  
[0m00:19:21.960043 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.968054 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:21.970039 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures` cascade
  
[0m00:19:21.975044 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:21.978707 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:21.979715 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures__dbt_tmp` to `prodia_test`.`stg_procedures`
  
[0m00:19:21.997696 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.004711 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:19:22.005700 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:22.008707 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:19:22.011711 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.021704 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:22.023705 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */
drop table if exists `prodia_test`.`stg_procedures__dbt_backup`
[0m00:19:22.038595 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.042599 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 00:19:21.833062 => 00:19:22.042599
[0m00:19:22.044606 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m00:19:22.046580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD8776F50>]}
[0m00:19:22.048779 [info ] [Thread-1 (]: 6 of 12 OK created sql table model prodia_test.stg_procedures .................. [[32mSUCCESS 1000[0m in 0.23s]
[0m00:19:22.051773 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m00:19:22.052776 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m00:19:22.055178 [info ] [Thread-1 (]: 7 of 12 START sql view model prodia_test.my_second_dbt_model ................... [RUN]
[0m00:19:22.058243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m00:19:22.060353 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m00:19:22.066968 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m00:19:22.069961 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 00:19:22.061349 => 00:19:22.069961
[0m00:19:22.072077 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m00:19:22.122492 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m00:19:22.124495 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:22.126688 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m00:19:22.127731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:22.140289 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.141288 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:22.142341 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view `prodia_test`.`my_second_dbt_model__dbt_tmp`
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from `prodia_test`.`my_first_dbt_model`
where id = 1
  );
[0m00:19:22.148971 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.157259 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:22.158349 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup` cascade
  
[0m00:19:22.161889 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.165474 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:22.166526 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model` to `prodia_test`.`my_second_dbt_model__dbt_backup`
  
[0m00:19:22.172879 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.180855 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:22.181862 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model` cascade
  
[0m00:19:22.187665 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.190664 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:22.191662 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model__dbt_tmp` to `prodia_test`.`my_second_dbt_model`
  
[0m00:19:22.196963 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.201398 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:19:22.203379 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:22.204400 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:19:22.206377 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.213429 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:22.215413 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup`
[0m00:19:22.219985 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.224425 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 00:19:22.073082 => 00:19:22.224425
[0m00:19:22.225424 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m00:19:22.228410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD87F4610>]}
[0m00:19:22.229835 [info ] [Thread-1 (]: 7 of 12 OK created sql view model prodia_test.my_second_dbt_model .............. [[32mSUCCESS 0[0m in 0.17s]
[0m00:19:22.232875 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m00:19:22.235105 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m00:19:22.236097 [info ] [Thread-1 (]: 8 of 12 START sql table model prodia_test.int_invoice_summary .................. [RUN]
[0m00:19:22.240091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_second_dbt_model, now model.prodia_dbt.int_invoice_summary)
[0m00:19:22.242087 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_invoice_summary
[0m00:19:22.251223 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_invoice_summary"
[0m00:19:22.254667 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (compile): 00:19:22.244203 => 00:19:22.253210
[0m00:19:22.256670 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_invoice_summary
[0m00:19:22.269855 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_invoice_summary"
[0m00:19:22.272854 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:22.275051 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: BEGIN
[0m00:19:22.277237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:22.290211 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.292187 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:22.294193 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

  
    

  create  table
    `prodia_test`.`int_invoice_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_invoice_summary.sql



with invoice_summary as (
    select
        i.InvoiceID,
        i.PatientID,
        sum(i.Amount) as total_amount,
        count(i.Items) as item_count
    from
        `prodia_test`.`stg_invoices` i
    group by
        i.InvoiceID,
        i.PatientID
)

select * from invoice_summary
    )

  
[0m00:19:22.352649 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:19:22.360476 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:22.361476 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    drop table if exists `prodia_test`.`int_invoice_summary__dbt_backup` cascade
  
[0m00:19:22.365471 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.369431 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:22.370431 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    rename table `prodia_test`.`int_invoice_summary` to `prodia_test`.`int_invoice_summary__dbt_backup`
  
[0m00:19:22.388917 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.397230 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:22.398230 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    drop table if exists `prodia_test`.`int_invoice_summary` cascade
  
[0m00:19:22.403782 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.406800 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:22.407799 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    rename table `prodia_test`.`int_invoice_summary__dbt_tmp` to `prodia_test`.`int_invoice_summary`
  
[0m00:19:22.424118 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.429117 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m00:19:22.431126 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:22.433127 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m00:19:22.436126 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.442141 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:22.444138 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */
drop table if exists `prodia_test`.`int_invoice_summary__dbt_backup`
[0m00:19:22.457327 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.462981 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (execute): 00:19:22.258667 => 00:19:22.461793
[0m00:19:22.464038 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: Close
[0m00:19:22.466024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD7A1BD10>]}
[0m00:19:22.468038 [info ] [Thread-1 (]: 8 of 12 OK created sql table model prodia_test.int_invoice_summary ............. [[32mSUCCESS 1000[0m in 0.23s]
[0m00:19:22.471591 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m00:19:22.472594 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m00:19:22.474591 [info ] [Thread-1 (]: 9 of 12 START sql table model prodia_test.int_patient_summary .................. [RUN]
[0m00:19:22.478623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_invoice_summary, now model.prodia_dbt.int_patient_summary)
[0m00:19:22.479631 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_patient_summary
[0m00:19:22.488692 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_patient_summary"
[0m00:19:22.492134 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (compile): 00:19:22.481028 => 00:19:22.490673
[0m00:19:22.494135 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_patient_summary
[0m00:19:22.504129 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_patient_summary"
[0m00:19:22.507130 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:22.508772 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: BEGIN
[0m00:19:22.510973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:22.524528 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.526530 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:22.528527 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

  
    

  create  table
    `prodia_test`.`int_patient_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_patient_summary.sql


with patient_appointments as (
    select
        p.PatientID,
        p.firstname,
        p.lastname,
        count(a.AppointmentID) as total_appointments
    from
        `prodia_test`.`stg_patients` p
    left join
        `prodia_test`.`stg_appointments` a on p.PatientID = a.PatientID
    group by
        p.PatientID,
        p.firstname,
        p.lastname
)

select * from patient_appointments
    )

  
[0m00:19:22.580087 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:19:22.588117 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:22.592116 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary__dbt_backup` cascade
  
[0m00:19:22.596341 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.599732 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:22.600732 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary` to `prodia_test`.`int_patient_summary__dbt_backup`
  
[0m00:19:22.620701 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.629703 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:22.630710 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary` cascade
  
[0m00:19:22.636728 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.639766 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:22.640764 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary__dbt_tmp` to `prodia_test`.`int_patient_summary`
  
[0m00:19:22.659058 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.667318 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:19:22.668316 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:22.670316 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:19:22.672322 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.679853 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:22.680859 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */
drop table if exists `prodia_test`.`int_patient_summary__dbt_backup`
[0m00:19:22.696905 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.701070 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (execute): 00:19:22.495134 => 00:19:22.701070
[0m00:19:22.702075 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: Close
[0m00:19:22.705073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD8849290>]}
[0m00:19:22.707076 [info ] [Thread-1 (]: 9 of 12 OK created sql table model prodia_test.int_patient_summary ............. [[32mSUCCESS 998[0m in 0.23s]
[0m00:19:22.710607 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m00:19:22.713601 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m00:19:22.714596 [info ] [Thread-1 (]: 10 of 12 START sql table model prodia_test.int_appointment_details ............. [RUN]
[0m00:19:22.718879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_patient_summary, now model.prodia_dbt.int_appointment_details)
[0m00:19:22.720881 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_appointment_details
[0m00:19:22.733373 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_appointment_details"
[0m00:19:22.735375 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (compile): 00:19:22.722875 => 00:19:22.735375
[0m00:19:22.738081 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_appointment_details
[0m00:19:22.749119 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_appointment_details"
[0m00:19:22.752115 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:22.753110 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: BEGIN
[0m00:19:22.754116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:22.767393 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.768373 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:22.770372 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

  
    

  create  table
    `prodia_test`.`int_appointment_details__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_appointment_details.sql



with appointment_info as (
    select
        a.AppointmentID,
        a.AppointmentDate,
        a.AppointmentTime,
        p.PatientID,
        concat(p.firstname, ' ', p.lastname) as patient_name,
        d.DoctorName,
        pr.ProcedureName
    from
        `prodia_test`.`stg_appointments` a
    join
        `prodia_test`.`stg_patients` p on a.PatientID = p.PatientID
    join
        `prodia_test`.`stg_doctors` d on a.DoctorID = d.DoctorID
    left join
        `prodia_test`.`stg_procedures` pr on a.AppointmentID = pr.AppointmentID
)

select * from appointment_info
    )

  
[0m00:19:22.848572 [debug] [Thread-1 (]: SQL status: SUCCESS 1367 in 0.0 seconds
[0m00:19:22.855569 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:22.856571 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details__dbt_backup` cascade
  
[0m00:19:22.861132 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.864217 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:22.865218 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details` to `prodia_test`.`int_appointment_details__dbt_backup`
  
[0m00:19:22.884325 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.892330 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:22.893330 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details` cascade
  
[0m00:19:22.898599 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.902004 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:22.903003 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details__dbt_tmp` to `prodia_test`.`int_appointment_details`
  
[0m00:19:22.920556 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.924556 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:19:22.926555 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:22.927576 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:19:22.930579 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.937073 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:22.939053 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */
drop table if exists `prodia_test`.`int_appointment_details__dbt_backup`
[0m00:19:22.954119 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:22.958462 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (execute): 00:19:22.739075 => 00:19:22.957458
[0m00:19:22.959459 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: Close
[0m00:19:22.962463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD8906590>]}
[0m00:19:22.964468 [info ] [Thread-1 (]: 10 of 12 OK created sql table model prodia_test.int_appointment_details ........ [[32mSUCCESS 1367[0m in 0.25s]
[0m00:19:22.967234 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m00:19:22.969269 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m00:19:22.970682 [info ] [Thread-1 (]: 11 of 12 START sql table model prodia_test.dm_patient_overview ................. [RUN]
[0m00:19:22.975195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_appointment_details, now model.prodia_dbt.dm_patient_overview)
[0m00:19:22.978224 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_patient_overview
[0m00:19:22.988224 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_patient_overview"
[0m00:19:22.993644 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (compile): 00:19:22.981229 => 00:19:22.991641
[0m00:19:22.995539 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_patient_overview
[0m00:19:23.005588 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_patient_overview"
[0m00:19:23.009911 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:19:23.012112 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: BEGIN
[0m00:19:23.014145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:23.028882 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:23.029873 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:19:23.031874 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_patient_overview"} */

  
    

  create  table
    `prodia_test`.`dm_patient_overview__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_patient_overview.sql



with patient_overview as (
    select
        ps.PatientID,
        ps.firstname,
        ps.lastname,
        ps.total_appointments,
        COALESCE(SUM(is.total_amount), 0) AS total_spent
    from
        `prodia_test`.`int_patient_summary` ps
    left join
        `prodia_test`.`int_invoice_summary` ins on ps.PatientID = ins.PatientID
    group by
        ps.PatientID, 
        ps.firstname, 
        ps.lastname
)

select * from patient_overview
    )

  
[0m00:19:23.041073 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1054 (42S22): Unknown column 'is.total_amount' in 'field list'
[0m00:19:23.043190 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: ROLLBACK
[0m00:19:23.045214 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (execute): 00:19:22.996565 => 00:19:23.044188
[0m00:19:23.047260 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: Close
[0m00:19:23.071052 [debug] [Thread-1 (]: Database Error in model dm_patient_overview (models\datamart\dm_patient_overview.sql)
  1054 (42S22): Unknown column 'is.total_amount' in 'field list'
  compiled Code at target\run\prodia_dbt\models\datamart\dm_patient_overview.sql
[0m00:19:23.073104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD9958310>]}
[0m00:19:23.074105 [error] [Thread-1 (]: 11 of 12 ERROR creating sql table model prodia_test.dm_patient_overview ........ [[31mERROR[0m in 0.10s]
[0m00:19:23.077446 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m00:19:23.078484 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m00:19:23.080781 [info ] [Thread-1 (]: 12 of 12 START sql table model prodia_test.dm_appointment_summary .............. [RUN]
[0m00:19:23.084330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_patient_overview, now model.prodia_dbt.dm_appointment_summary)
[0m00:19:23.087868 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_appointment_summary
[0m00:19:23.101450 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_appointment_summary"
[0m00:19:23.104957 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (compile): 00:19:23.091370 => 00:19:23.103479
[0m00:19:23.106960 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_appointment_summary
[0m00:19:23.119246 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_appointment_summary"
[0m00:19:23.122495 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:23.125541 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: BEGIN
[0m00:19:23.127656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:23.140245 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:23.142240 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:23.143217 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

  
    

  create  table
    `prodia_test`.`dm_appointment_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_appointment_summary.sql



with appointment_summary as (
    select
        ad.AppointmentDate,
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        COUNT(DISTINCT ad.ProcedureName) AS total_procedures
    from
        `prodia_test`.`int_appointment_details` ad
    group by
        ad.AppointmentDate, 
        ad.DoctorName
)

select * from appointment_summary
    )

  
[0m00:19:23.202282 [debug] [Thread-1 (]: SQL status: SUCCESS 999 in 0.0 seconds
[0m00:19:23.209336 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:23.211361 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    drop table if exists `prodia_test`.`dm_appointment_summary__dbt_backup` cascade
  
[0m00:19:23.215738 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:23.218762 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:23.220801 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    rename table `prodia_test`.`dm_appointment_summary` to `prodia_test`.`dm_appointment_summary__dbt_backup`
  
[0m00:19:23.238660 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:23.246181 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:23.248160 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    drop table if exists `prodia_test`.`dm_appointment_summary` cascade
  
[0m00:19:23.252375 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:23.255586 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:23.256993 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    rename table `prodia_test`.`dm_appointment_summary__dbt_tmp` to `prodia_test`.`dm_appointment_summary`
  
[0m00:19:23.273970 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:23.278968 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m00:19:23.279971 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:23.281969 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m00:19:23.283979 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:23.294054 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:23.296030 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
drop table if exists `prodia_test`.`dm_appointment_summary__dbt_backup`
[0m00:19:23.309502 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:23.313702 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (execute): 00:19:23.108957 => 00:19:23.313702
[0m00:19:23.315683 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: Close
[0m00:19:23.317707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6646c3d-edbe-4b71-97b7-ef49e462f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD9A87ED0>]}
[0m00:19:23.319210 [info ] [Thread-1 (]: 12 of 12 OK created sql table model prodia_test.dm_appointment_summary ......... [[32mSUCCESS 999[0m in 0.23s]
[0m00:19:23.322222 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m00:19:23.326559 [debug] [MainThread]: Using mysql connection "master"
[0m00:19:23.327556 [debug] [MainThread]: On master: BEGIN
[0m00:19:23.328557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:23.343070 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:23.345613 [debug] [MainThread]: On master: COMMIT
[0m00:19:23.346952 [debug] [MainThread]: Using mysql connection "master"
[0m00:19:23.348008 [debug] [MainThread]: On master: COMMIT
[0m00:19:23.350134 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:23.352135 [debug] [MainThread]: On master: Close
[0m00:19:23.354138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:23.355154 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m00:19:23.357230 [debug] [MainThread]: Connection 'list_None_prodia_test' was properly closed.
[0m00:19:23.358425 [debug] [MainThread]: Connection 'model.prodia_dbt.dm_appointment_summary' was properly closed.
[0m00:19:23.360483 [info ] [MainThread]: 
[0m00:19:23.362515 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m00:19:23.370770 [debug] [MainThread]: Command end result
[0m00:19:23.394199 [info ] [MainThread]: 
[0m00:19:23.397411 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:19:23.399404 [info ] [MainThread]: 
[0m00:19:23.401447 [error] [MainThread]: [33mDatabase Error in model dm_patient_overview (models\datamart\dm_patient_overview.sql)[0m
[0m00:19:23.403538 [error] [MainThread]:   1054 (42S22): Unknown column 'is.total_amount' in 'field list'
[0m00:19:23.405920 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_patient_overview.sql
[0m00:19:23.408947 [info ] [MainThread]: 
[0m00:19:23.412321 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m00:19:23.416334 [debug] [MainThread]: Command `dbt run` failed at 00:19:23.416334 after 6.58 seconds
[0m00:19:23.417334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD8160450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD7B7BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD14C0A50>]}
[0m00:19:23.418383 [debug] [MainThread]: Flushing usage events
[0m00:19:44.708119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017938E5DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017938E5E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017938E5F810>]}


============================== 00:19:44.714428 | 328e2fd0-4cc5-46b6-84f0-985d0373292e ==============================
[0m00:19:44.714428 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:19:44.717861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs'}
[0m00:19:45.648896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017938E6CF10>]}
[0m00:19:45.697904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179393D4D90>]}
[0m00:19:45.726854 [debug] [MainThread]: checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, vars: {}, profile: , target: mysql, version: 1.5.0
[0m00:19:45.837670 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:19:45.839656 [debug] [MainThread]: previous checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m00:19:45.841647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A49B590>]}
[0m00:19:47.631851 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m00:19:47.663638 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m00:19:47.672638 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:19:47.680638 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:19:47.689373 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m00:19:47.698348 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m00:19:47.707351 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m00:19:47.715861 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m00:19:47.728837 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m00:19:47.734182 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m00:19:47.747200 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m00:19:47.751739 [debug] [MainThread]: 1603: static parser failed on staging\stg_invoices.sql
[0m00:19:47.762714 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_invoices.sql
[0m00:19:47.767983 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m00:19:47.778278 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m00:19:47.783278 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m00:19:47.795467 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m00:19:48.175148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A5746D0>]}
[0m00:19:48.195453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179393F5710>]}
[0m00:19:48.197451 [info ] [MainThread]: Found 12 models, 4 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:19:48.199563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A5884D0>]}
[0m00:19:48.206007 [info ] [MainThread]: 
[0m00:19:48.209007 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m00:19:48.217009 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m00:19:48.247359 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m00:19:48.249362 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m00:19:48.250361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:48.280332 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m00:19:48.283330 [debug] [ThreadPool]: On list_schemas: Close
[0m00:19:48.289377 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_prodia_test'
[0m00:19:48.303758 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:19:48.304759 [debug] [ThreadPool]: On list_None_prodia_test: BEGIN
[0m00:19:48.306080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:48.318442 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.320567 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:19:48.321587 [debug] [ThreadPool]: On list_None_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_None_prodia_test"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'prodia_test'
  
[0m00:19:48.326096 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 0.0 seconds
[0m00:19:48.330099 [debug] [ThreadPool]: On list_None_prodia_test: ROLLBACK
[0m00:19:48.332086 [debug] [ThreadPool]: On list_None_prodia_test: Close
[0m00:19:48.342077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179391692D0>]}
[0m00:19:48.343189 [debug] [MainThread]: Using mysql connection "master"
[0m00:19:48.344192 [debug] [MainThread]: On master: BEGIN
[0m00:19:48.346190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:48.357187 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.359360 [debug] [MainThread]: On master: COMMIT
[0m00:19:48.360361 [debug] [MainThread]: Using mysql connection "master"
[0m00:19:48.361361 [debug] [MainThread]: On master: COMMIT
[0m00:19:48.364383 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.365379 [debug] [MainThread]: On master: Close
[0m00:19:48.367363 [info ] [MainThread]: Concurrency: 1 threads (target='mysql')
[0m00:19:48.369360 [info ] [MainThread]: 
[0m00:19:48.383849 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m00:19:48.386844 [info ] [Thread-1 (]: 1 of 12 START sql table model prodia_test.my_first_dbt_model ................... [RUN]
[0m00:19:48.391266 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.prodia_dbt.my_first_dbt_model'
[0m00:19:48.393265 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m00:19:48.402433 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m00:19:48.404436 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 00:19:48.394258 => 00:19:48.404436
[0m00:19:48.407009 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m00:19:48.525022 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m00:19:48.528023 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:48.529027 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m00:19:48.531026 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:19:48.544149 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.545171 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:48.546177 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table
    `prodia_test`.`my_first_dbt_model__dbt_tmp`
    
    
      as
    
    (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

  
[0m00:19:48.567637 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:19:48.584067 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:48.586135 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup` cascade
  
[0m00:19:48.590803 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.593924 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:48.594976 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model` to `prodia_test`.`my_first_dbt_model__dbt_backup`
  
[0m00:19:48.612833 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.620313 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:48.621313 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model` cascade
  
[0m00:19:48.626267 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.629430 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:48.630481 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model__dbt_tmp` to `prodia_test`.`my_first_dbt_model`
  
[0m00:19:48.647687 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.702788 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:19:48.704789 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:48.705789 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:19:48.707774 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.720069 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:19:48.722066 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup`
[0m00:19:48.735867 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.740124 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 00:19:48.408991 => 00:19:48.739071
[0m00:19:48.741297 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m00:19:48.743333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A556FD0>]}
[0m00:19:48.745599 [info ] [Thread-1 (]: 1 of 12 OK created sql table model prodia_test.my_first_dbt_model .............. [[32mSUCCESS 2[0m in 0.35s]
[0m00:19:48.748644 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m00:19:48.750647 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m00:19:48.753017 [info ] [Thread-1 (]: 2 of 12 START sql table model prodia_test.stg_appointments ..................... [RUN]
[0m00:19:48.756086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m00:19:48.758087 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m00:19:48.766658 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m00:19:48.769665 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 00:19:48.759084 => 00:19:48.768663
[0m00:19:48.770663 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m00:19:48.782924 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m00:19:48.784928 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:48.786925 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m00:19:48.788253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:48.802396 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.803670 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:48.804713 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table
    `prodia_test`.`stg_appointments__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_appointments.sql



    select *
    from `prodia_test`.`appointments`

    )

  
[0m00:19:48.869969 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:19:48.877067 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:48.878067 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments__dbt_backup` cascade
  
[0m00:19:48.884392 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.887408 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:48.888407 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments` to `prodia_test`.`stg_appointments__dbt_backup`
  
[0m00:19:48.905567 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.913572 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:48.915565 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments` cascade
  
[0m00:19:48.920573 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.923595 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:48.924595 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments__dbt_tmp` to `prodia_test`.`stg_appointments`
  
[0m00:19:48.942237 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.947239 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:19:48.949240 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:48.950238 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:19:48.953242 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.960238 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:19:48.961235 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */
drop table if exists `prodia_test`.`stg_appointments__dbt_backup`
[0m00:19:48.977159 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:48.981270 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 00:19:48.772660 => 00:19:48.980216
[0m00:19:48.982272 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m00:19:48.985694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A5E26D0>]}
[0m00:19:48.987751 [info ] [Thread-1 (]: 2 of 12 OK created sql table model prodia_test.stg_appointments ................ [[32mSUCCESS 1000[0m in 0.23s]
[0m00:19:48.990764 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m00:19:48.991919 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m00:19:48.993954 [info ] [Thread-1 (]: 3 of 12 START sql table model prodia_test.stg_doctors .......................... [RUN]
[0m00:19:48.997089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_doctors)
[0m00:19:48.999089 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m00:19:49.006557 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m00:19:49.012024 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 00:19:49.000099 => 00:19:49.011024
[0m00:19:49.014042 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m00:19:49.023074 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m00:19:49.026176 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:49.028952 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m00:19:49.031519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:49.044059 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.046058 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:49.048060 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table
    `prodia_test`.`stg_doctors__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_doctors.sql



    select *
    from `prodia_test`.`doctors`

    )

  
[0m00:19:49.104553 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:19:49.111605 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:49.112605 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors__dbt_backup` cascade
  
[0m00:19:49.116659 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.120019 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:49.122020 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors` to `prodia_test`.`stg_doctors__dbt_backup`
  
[0m00:19:49.139051 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.147046 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:49.148046 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors` cascade
  
[0m00:19:49.152046 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.156045 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:49.157251 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors__dbt_tmp` to `prodia_test`.`stg_doctors`
  
[0m00:19:49.176055 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.186050 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:19:49.188062 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:49.190056 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:19:49.193056 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.201049 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:19:49.203058 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */
drop table if exists `prodia_test`.`stg_doctors__dbt_backup`
[0m00:19:49.219340 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.224659 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 00:19:49.015084 => 00:19:49.223669
[0m00:19:49.225671 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m00:19:49.227669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A645290>]}
[0m00:19:49.230042 [info ] [Thread-1 (]: 3 of 12 OK created sql table model prodia_test.stg_doctors ..................... [[32mSUCCESS 1000[0m in 0.23s]
[0m00:19:49.233475 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m00:19:49.235523 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_invoices
[0m00:19:49.236531 [info ] [Thread-1 (]: 4 of 12 START sql table model prodia_test.stg_invoices ......................... [RUN]
[0m00:19:49.240947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_invoices)
[0m00:19:49.243286 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_invoices
[0m00:19:49.253285 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_invoices"
[0m00:19:49.256285 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (compile): 00:19:49.245287 => 00:19:49.255286
[0m00:19:49.258292 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_invoices
[0m00:19:49.269169 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_invoices"
[0m00:19:49.272147 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:49.273668 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: BEGIN
[0m00:19:49.275666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:49.291221 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.292250 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:49.294742 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

  
    

  create  table
    `prodia_test`.`stg_invoices__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_billings.sql



    select *
    from `prodia_test`.`invoices`

    )

  
[0m00:19:49.363088 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:19:49.370303 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:49.371304 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    drop table if exists `prodia_test`.`stg_invoices__dbt_backup` cascade
  
[0m00:19:49.375473 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.378886 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:49.380867 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    rename table `prodia_test`.`stg_invoices` to `prodia_test`.`stg_invoices__dbt_backup`
  
[0m00:19:49.396894 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.403918 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:49.405897 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    drop table if exists `prodia_test`.`stg_invoices` cascade
  
[0m00:19:49.409943 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.412942 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:49.414953 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    rename table `prodia_test`.`stg_invoices__dbt_tmp` to `prodia_test`.`stg_invoices`
  
[0m00:19:49.433074 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.437154 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m00:19:49.438155 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:49.440188 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m00:19:49.442190 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.449191 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:19:49.450194 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */
drop table if exists `prodia_test`.`stg_invoices__dbt_backup`
[0m00:19:49.465271 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.470530 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (execute): 00:19:49.259289 => 00:19:49.469531
[0m00:19:49.471515 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: Close
[0m00:19:49.474525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A646F10>]}
[0m00:19:49.475523 [info ] [Thread-1 (]: 4 of 12 OK created sql table model prodia_test.stg_invoices .................... [[32mSUCCESS 1000[0m in 0.23s]
[0m00:19:49.479049 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_invoices
[0m00:19:49.481027 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m00:19:49.483049 [info ] [Thread-1 (]: 5 of 12 START sql table model prodia_test.stg_patients ......................... [RUN]
[0m00:19:49.486032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_invoices, now model.prodia_dbt.stg_patients)
[0m00:19:49.487035 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m00:19:49.496033 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m00:19:49.499028 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 00:19:49.489028 => 00:19:49.498027
[0m00:19:49.500028 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m00:19:49.512161 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m00:19:49.515418 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:49.516430 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m00:19:49.517557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:49.532133 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.534178 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:49.535185 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table
    `prodia_test`.`stg_patients__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_patients.sql



    select *
    from `prodia_test`.`patients`

    )

  
[0m00:19:49.592239 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:19:49.600532 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:49.602533 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients__dbt_backup` cascade
  
[0m00:19:49.606527 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.609553 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:49.611556 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients` to `prodia_test`.`stg_patients__dbt_backup`
  
[0m00:19:49.628342 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.635893 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:49.636893 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients` cascade
  
[0m00:19:49.642488 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.645485 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:49.646489 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients__dbt_tmp` to `prodia_test`.`stg_patients`
  
[0m00:19:49.664927 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.668924 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:19:49.670925 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:49.671932 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:19:49.673927 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.681989 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:19:49.682987 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */
drop table if exists `prodia_test`.`stg_patients__dbt_backup`
[0m00:19:49.698008 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.702062 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 00:19:49.501030 => 00:19:49.702062
[0m00:19:49.704070 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m00:19:49.706046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017939408450>]}
[0m00:19:49.708115 [info ] [Thread-1 (]: 5 of 12 OK created sql table model prodia_test.stg_patients .................... [[32mSUCCESS 998[0m in 0.22s]
[0m00:19:49.711547 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m00:19:49.712549 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m00:19:49.714046 [info ] [Thread-1 (]: 6 of 12 START sql table model prodia_test.stg_procedures ....................... [RUN]
[0m00:19:49.717302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m00:19:49.719479 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m00:19:49.728719 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m00:19:49.731711 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 00:19:49.720483 => 00:19:49.731711
[0m00:19:49.733713 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m00:19:49.744722 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m00:19:49.747712 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:49.748712 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m00:19:49.750718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:49.763746 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.765748 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:49.766736 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table
    `prodia_test`.`stg_procedures__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_procedures.sql



    select *
    from `prodia_test`.`procedures`

    )

  
[0m00:19:49.822876 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:19:49.829358 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:49.830358 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures__dbt_backup` cascade
  
[0m00:19:49.835502 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.838840 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:49.842848 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures` to `prodia_test`.`stg_procedures__dbt_backup`
  
[0m00:19:49.858605 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.866689 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:49.868687 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures` cascade
  
[0m00:19:49.873736 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.878740 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:49.879731 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures__dbt_tmp` to `prodia_test`.`stg_procedures`
  
[0m00:19:49.899132 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.906471 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:19:49.908462 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:49.909466 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:19:49.912474 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.920622 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:19:49.921723 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */
drop table if exists `prodia_test`.`stg_procedures__dbt_backup`
[0m00:19:49.937788 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:49.943786 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 00:19:49.734710 => 00:19:49.942788
[0m00:19:49.945788 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m00:19:49.947788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017938E6C150>]}
[0m00:19:49.950009 [info ] [Thread-1 (]: 6 of 12 OK created sql table model prodia_test.stg_procedures .................. [[32mSUCCESS 1000[0m in 0.23s]
[0m00:19:49.954050 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m00:19:49.956049 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m00:19:49.958050 [info ] [Thread-1 (]: 7 of 12 START sql view model prodia_test.my_second_dbt_model ................... [RUN]
[0m00:19:49.961049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m00:19:49.963050 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m00:19:49.973046 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m00:19:49.977048 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 00:19:49.965047 => 00:19:49.975045
[0m00:19:49.978356 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m00:19:50.030043 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m00:19:50.033051 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:50.034475 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m00:19:50.035473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:50.047134 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.049559 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:50.050752 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view `prodia_test`.`my_second_dbt_model__dbt_tmp`
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from `prodia_test`.`my_first_dbt_model`
where id = 1
  );
[0m00:19:50.057223 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.064506 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:50.065506 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup` cascade
  
[0m00:19:50.069906 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.072940 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:50.073992 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model` to `prodia_test`.`my_second_dbt_model__dbt_backup`
  
[0m00:19:50.080512 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.087562 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:50.089604 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model` cascade
  
[0m00:19:50.093538 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.096536 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:50.097537 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model__dbt_tmp` to `prodia_test`.`my_second_dbt_model`
  
[0m00:19:50.104190 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.108181 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:19:50.109185 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:50.111185 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:19:50.112225 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.119592 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:19:50.121599 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup`
[0m00:19:50.126206 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.130808 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 00:19:49.979694 => 00:19:50.129808
[0m00:19:50.131806 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m00:19:50.134813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A58DE50>]}
[0m00:19:50.136809 [info ] [Thread-1 (]: 7 of 12 OK created sql view model prodia_test.my_second_dbt_model .............. [[32mSUCCESS 0[0m in 0.17s]
[0m00:19:50.139810 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m00:19:50.140808 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m00:19:50.142816 [info ] [Thread-1 (]: 8 of 12 START sql table model prodia_test.int_invoice_summary .................. [RUN]
[0m00:19:50.145809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_second_dbt_model, now model.prodia_dbt.int_invoice_summary)
[0m00:19:50.147971 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_invoice_summary
[0m00:19:50.156130 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_invoice_summary"
[0m00:19:50.159130 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (compile): 00:19:50.149966 => 00:19:50.159130
[0m00:19:50.161572 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_invoice_summary
[0m00:19:50.177023 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_invoice_summary"
[0m00:19:50.181272 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:50.183375 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: BEGIN
[0m00:19:50.184459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:50.199365 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.200359 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:50.202353 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

  
    

  create  table
    `prodia_test`.`int_invoice_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_invoice_summary.sql



with invoice_summary as (
    select
        i.InvoiceID,
        i.PatientID,
        sum(i.Amount) as total_amount,
        count(i.Items) as item_count
    from
        `prodia_test`.`stg_invoices` i
    group by
        i.InvoiceID,
        i.PatientID
)

select * from invoice_summary
    )

  
[0m00:19:50.258501 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:19:50.265490 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:50.267494 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    drop table if exists `prodia_test`.`int_invoice_summary__dbt_backup` cascade
  
[0m00:19:50.271781 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.276095 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:50.277095 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    rename table `prodia_test`.`int_invoice_summary` to `prodia_test`.`int_invoice_summary__dbt_backup`
  
[0m00:19:50.294440 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.301460 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:50.302460 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    drop table if exists `prodia_test`.`int_invoice_summary` cascade
  
[0m00:19:50.306874 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.310415 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:50.311470 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    rename table `prodia_test`.`int_invoice_summary__dbt_tmp` to `prodia_test`.`int_invoice_summary`
  
[0m00:19:50.329746 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.336908 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m00:19:50.338886 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:50.340888 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m00:19:50.343906 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.350168 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:19:50.351168 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */
drop table if exists `prodia_test`.`int_invoice_summary__dbt_backup`
[0m00:19:50.365761 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.370770 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (execute): 00:19:50.162575 => 00:19:50.369766
[0m00:19:50.371767 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: Close
[0m00:19:50.374763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A608850>]}
[0m00:19:50.376768 [info ] [Thread-1 (]: 8 of 12 OK created sql table model prodia_test.int_invoice_summary ............. [[32mSUCCESS 1000[0m in 0.23s]
[0m00:19:50.379763 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m00:19:50.380758 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m00:19:50.382759 [info ] [Thread-1 (]: 9 of 12 START sql table model prodia_test.int_patient_summary .................. [RUN]
[0m00:19:50.386765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_invoice_summary, now model.prodia_dbt.int_patient_summary)
[0m00:19:50.388760 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_patient_summary
[0m00:19:50.400814 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_patient_summary"
[0m00:19:50.403818 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (compile): 00:19:50.390762 => 00:19:50.402815
[0m00:19:50.405814 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_patient_summary
[0m00:19:50.419559 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_patient_summary"
[0m00:19:50.421884 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:50.423868 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: BEGIN
[0m00:19:50.425872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:50.438286 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.440679 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:50.441887 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

  
    

  create  table
    `prodia_test`.`int_patient_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_patient_summary.sql


with patient_appointments as (
    select
        p.PatientID,
        p.firstname,
        p.lastname,
        count(a.AppointmentID) as total_appointments
    from
        `prodia_test`.`stg_patients` p
    left join
        `prodia_test`.`stg_appointments` a on p.PatientID = a.PatientID
    group by
        p.PatientID,
        p.firstname,
        p.lastname
)

select * from patient_appointments
    )

  
[0m00:19:50.496375 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:19:50.503389 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:50.504391 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary__dbt_backup` cascade
  
[0m00:19:50.508760 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.512166 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:50.513167 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary` to `prodia_test`.`int_patient_summary__dbt_backup`
  
[0m00:19:50.530476 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.540464 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:50.541476 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary` cascade
  
[0m00:19:50.547090 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.550089 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:50.552089 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary__dbt_tmp` to `prodia_test`.`int_patient_summary`
  
[0m00:19:50.570079 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.576356 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:19:50.578325 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:50.579337 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:19:50.581325 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.588812 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:19:50.590812 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */
drop table if exists `prodia_test`.`int_patient_summary__dbt_backup`
[0m00:19:50.605370 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.611372 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (execute): 00:19:50.406817 => 00:19:50.610374
[0m00:19:50.612369 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: Close
[0m00:19:50.615372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A4586D0>]}
[0m00:19:50.617375 [info ] [Thread-1 (]: 9 of 12 OK created sql table model prodia_test.int_patient_summary ............. [[32mSUCCESS 998[0m in 0.23s]
[0m00:19:50.620611 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m00:19:50.622647 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m00:19:50.624849 [info ] [Thread-1 (]: 10 of 12 START sql table model prodia_test.int_appointment_details ............. [RUN]
[0m00:19:50.627829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_patient_summary, now model.prodia_dbt.int_appointment_details)
[0m00:19:50.630235 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_appointment_details
[0m00:19:50.641164 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_appointment_details"
[0m00:19:50.644160 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (compile): 00:19:50.631734 => 00:19:50.644160
[0m00:19:50.646675 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_appointment_details
[0m00:19:50.657002 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_appointment_details"
[0m00:19:50.660126 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:50.661130 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: BEGIN
[0m00:19:50.663128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:50.675932 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.678017 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:50.679097 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

  
    

  create  table
    `prodia_test`.`int_appointment_details__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_appointment_details.sql



with appointment_info as (
    select
        a.AppointmentID,
        a.AppointmentDate,
        a.AppointmentTime,
        p.PatientID,
        concat(p.firstname, ' ', p.lastname) as patient_name,
        d.DoctorName,
        pr.ProcedureName
    from
        `prodia_test`.`stg_appointments` a
    join
        `prodia_test`.`stg_patients` p on a.PatientID = p.PatientID
    join
        `prodia_test`.`stg_doctors` d on a.DoctorID = d.DoctorID
    left join
        `prodia_test`.`stg_procedures` pr on a.AppointmentID = pr.AppointmentID
)

select * from appointment_info
    )

  
[0m00:19:50.752680 [debug] [Thread-1 (]: SQL status: SUCCESS 1367 in 0.0 seconds
[0m00:19:50.760018 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:50.762024 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details__dbt_backup` cascade
  
[0m00:19:50.765486 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.768895 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:50.769895 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details` to `prodia_test`.`int_appointment_details__dbt_backup`
  
[0m00:19:50.788153 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.796174 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:50.797174 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details` cascade
  
[0m00:19:50.801546 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.804632 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:50.806632 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details__dbt_tmp` to `prodia_test`.`int_appointment_details`
  
[0m00:19:50.823790 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.828791 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:19:50.829790 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:50.831799 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:19:50.833795 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.840817 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:19:50.842795 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */
drop table if exists `prodia_test`.`int_appointment_details__dbt_backup`
[0m00:19:50.857078 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.861149 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (execute): 00:19:50.647715 => 00:19:50.861149
[0m00:19:50.863132 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: Close
[0m00:19:50.864156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179393CFD90>]}
[0m00:19:50.867056 [info ] [Thread-1 (]: 10 of 12 OK created sql table model prodia_test.int_appointment_details ........ [[32mSUCCESS 1367[0m in 0.24s]
[0m00:19:50.869757 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m00:19:50.872130 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m00:19:50.873128 [info ] [Thread-1 (]: 11 of 12 START sql table model prodia_test.dm_patient_overview ................. [RUN]
[0m00:19:50.876276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_appointment_details, now model.prodia_dbt.dm_patient_overview)
[0m00:19:50.878901 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_patient_overview
[0m00:19:50.887176 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_patient_overview"
[0m00:19:50.890526 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (compile): 00:19:50.880157 => 00:19:50.889152
[0m00:19:50.892531 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_patient_overview
[0m00:19:50.902909 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_patient_overview"
[0m00:19:50.904913 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:19:50.905887 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: BEGIN
[0m00:19:50.907389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:50.920296 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:50.922271 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:19:50.923284 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_patient_overview"} */

  
    

  create  table
    `prodia_test`.`dm_patient_overview__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_patient_overview.sql



with patient_overview as (
    select
        ps.PatientID,
        ps.firstname,
        ps.lastname,
        ps.total_appointments,
        COALESCE(SUM(ins.total_amount), 0) AS total_spent
    from
        `prodia_test`.`int_patient_summary` ps
    left join
        `prodia_test`.`int_invoice_summary` ins on ps.PatientID = ins.PatientID
    group by
        ps.PatientID, 
        ps.firstname, 
        ps.lastname
)

select * from patient_overview
    )

  
[0m00:19:50.930432 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1055 (42000): Expression #4 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'prodia_test.ps.total_appointments' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
[0m00:19:50.931481 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: ROLLBACK
[0m00:19:50.934712 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (execute): 00:19:50.893524 => 00:19:50.933474
[0m00:19:50.935761 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: Close
[0m00:19:50.961355 [debug] [Thread-1 (]: Database Error in model dm_patient_overview (models\datamart\dm_patient_overview.sql)
  1055 (42000): Expression #4 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'prodia_test.ps.total_appointments' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
  compiled Code at target\run\prodia_dbt\models\datamart\dm_patient_overview.sql
[0m00:19:50.963359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A52E250>]}
[0m00:19:50.965338 [error] [Thread-1 (]: 11 of 12 ERROR creating sql table model prodia_test.dm_patient_overview ........ [[31mERROR[0m in 0.09s]
[0m00:19:50.968343 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m00:19:50.969382 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m00:19:50.971374 [info ] [Thread-1 (]: 12 of 12 START sql table model prodia_test.dm_appointment_summary .............. [RUN]
[0m00:19:50.974671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_patient_overview, now model.prodia_dbt.dm_appointment_summary)
[0m00:19:50.976668 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_appointment_summary
[0m00:19:50.984683 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_appointment_summary"
[0m00:19:50.987674 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (compile): 00:19:50.977708 => 00:19:50.986685
[0m00:19:50.988949 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_appointment_summary
[0m00:19:50.999947 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_appointment_summary"
[0m00:19:51.002949 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:51.003955 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: BEGIN
[0m00:19:51.006148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:51.020137 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:51.021137 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:51.022137 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

  
    

  create  table
    `prodia_test`.`dm_appointment_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_appointment_summary.sql



with appointment_summary as (
    select
        ad.AppointmentDate,
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        COUNT(DISTINCT ad.ProcedureName) AS total_procedures
    from
        `prodia_test`.`int_appointment_details` ad
    group by
        ad.AppointmentDate, 
        ad.DoctorName
)

select * from appointment_summary
    )

  
[0m00:19:51.078550 [debug] [Thread-1 (]: SQL status: SUCCESS 999 in 0.0 seconds
[0m00:19:51.085622 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:51.087695 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    drop table if exists `prodia_test`.`dm_appointment_summary__dbt_backup` cascade
  
[0m00:19:51.092134 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:51.095166 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:51.097169 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    rename table `prodia_test`.`dm_appointment_summary` to `prodia_test`.`dm_appointment_summary__dbt_backup`
  
[0m00:19:51.113612 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:51.124124 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:51.125125 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    drop table if exists `prodia_test`.`dm_appointment_summary` cascade
  
[0m00:19:51.130499 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:51.133514 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:51.134514 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    rename table `prodia_test`.`dm_appointment_summary__dbt_tmp` to `prodia_test`.`dm_appointment_summary`
  
[0m00:19:51.150805 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:51.155802 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m00:19:51.156803 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:51.157803 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m00:19:51.160803 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:51.167801 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:19:51.168802 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
drop table if exists `prodia_test`.`dm_appointment_summary__dbt_backup`
[0m00:19:51.182689 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:51.186747 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (execute): 00:19:50.990960 => 00:19:51.185743
[0m00:19:51.187745 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: Close
[0m00:19:51.190727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328e2fd0-4cc5-46b6-84f0-985d0373292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793A76D590>]}
[0m00:19:51.193091 [info ] [Thread-1 (]: 12 of 12 OK created sql table model prodia_test.dm_appointment_summary ......... [[32mSUCCESS 999[0m in 0.22s]
[0m00:19:51.195128 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m00:19:51.199720 [debug] [MainThread]: Using mysql connection "master"
[0m00:19:51.200759 [debug] [MainThread]: On master: BEGIN
[0m00:19:51.201759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:51.215316 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:51.216316 [debug] [MainThread]: On master: COMMIT
[0m00:19:51.216828 [debug] [MainThread]: Using mysql connection "master"
[0m00:19:51.217865 [debug] [MainThread]: On master: COMMIT
[0m00:19:51.219953 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:19:51.221261 [debug] [MainThread]: On master: Close
[0m00:19:51.223736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:51.226015 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m00:19:51.227004 [debug] [MainThread]: Connection 'list_None_prodia_test' was properly closed.
[0m00:19:51.228142 [debug] [MainThread]: Connection 'model.prodia_dbt.dm_appointment_summary' was properly closed.
[0m00:19:51.229547 [info ] [MainThread]: 
[0m00:19:51.231583 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m00:19:51.240925 [debug] [MainThread]: Command end result
[0m00:19:51.261244 [info ] [MainThread]: 
[0m00:19:51.264243 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:19:51.266237 [info ] [MainThread]: 
[0m00:19:51.268806 [error] [MainThread]: [33mDatabase Error in model dm_patient_overview (models\datamart\dm_patient_overview.sql)[0m
[0m00:19:51.271128 [error] [MainThread]:   1055 (42000): Expression #4 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'prodia_test.ps.total_appointments' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
[0m00:19:51.273127 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_patient_overview.sql
[0m00:19:51.275124 [info ] [MainThread]: 
[0m00:19:51.278544 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m00:19:51.281990 [debug] [MainThread]: Command `dbt run` failed at 00:19:51.281990 after 6.61 seconds
[0m00:19:51.283983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179321A0A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179321A0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017938E52FD0>]}
[0m00:19:51.285549 [debug] [MainThread]: Flushing usage events
[0m00:20:52.858329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A8D1DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A8E6E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A8E6D5D0>]}


============================== 00:20:52.864328 | 86c7458b-faf5-497e-9a90-b7a3ef8e013b ==============================
[0m00:20:52.864328 [info ] [MainThread]: Running with dbt=1.5.0
[0m00:20:52.866785 [debug] [MainThread]: running dbt with arguments {'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'log_cache_events': 'False'}
[0m00:20:53.788015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A8D1DD10>]}
[0m00:20:53.837226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A9397AD0>]}
[0m00:20:53.866387 [debug] [MainThread]: checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, vars: {}, profile: , target: mysql, version: 1.5.0
[0m00:20:53.969704 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:20:53.971683 [debug] [MainThread]: previous checksum: 06fbcdf7fbe5eb495989425c0631ffc24dcb65505a3de3c10445941cf0f662b8, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m00:20:53.973728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA4AB690>]}
[0m00:20:55.650181 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m00:20:55.683178 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m00:20:55.691255 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:20:55.700466 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:20:55.708466 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m00:20:55.717833 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m00:20:55.725874 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m00:20:55.733874 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m00:20:55.747282 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m00:20:55.752281 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m00:20:55.762281 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m00:20:55.767281 [debug] [MainThread]: 1603: static parser failed on staging\stg_invoices.sql
[0m00:20:55.778627 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_invoices.sql
[0m00:20:55.783820 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m00:20:55.794841 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m00:20:55.799841 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m00:20:55.811841 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m00:20:56.208933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA4CDC90>]}
[0m00:20:56.228443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA45F7D0>]}
[0m00:20:56.230441 [info ] [MainThread]: Found 12 models, 4 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:20:56.232529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA56C6D0>]}
[0m00:20:56.237527 [info ] [MainThread]: 
[0m00:20:56.239967 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m00:20:56.246757 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m00:20:56.274104 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m00:20:56.275105 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m00:20:56.276106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:56.305808 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m00:20:56.308806 [debug] [ThreadPool]: On list_schemas: Close
[0m00:20:56.314806 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_prodia_test'
[0m00:20:56.328806 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:20:56.329805 [debug] [ThreadPool]: On list_None_prodia_test: BEGIN
[0m00:20:56.330811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:56.344027 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.345043 [debug] [ThreadPool]: Using mysql connection "list_None_prodia_test"
[0m00:20:56.346100 [debug] [ThreadPool]: On list_None_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "connection_name": "list_None_prodia_test"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'prodia_test'
  
[0m00:20:56.350636 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 0.0 seconds
[0m00:20:56.354686 [debug] [ThreadPool]: On list_None_prodia_test: ROLLBACK
[0m00:20:56.356673 [debug] [ThreadPool]: On list_None_prodia_test: Close
[0m00:20:56.366805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A93DB210>]}
[0m00:20:56.368090 [debug] [MainThread]: Using mysql connection "master"
[0m00:20:56.369090 [debug] [MainThread]: On master: BEGIN
[0m00:20:56.370275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:20:56.382665 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.383762 [debug] [MainThread]: On master: COMMIT
[0m00:20:56.385814 [debug] [MainThread]: Using mysql connection "master"
[0m00:20:56.386803 [debug] [MainThread]: On master: COMMIT
[0m00:20:56.388813 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.389790 [debug] [MainThread]: On master: Close
[0m00:20:56.391792 [info ] [MainThread]: Concurrency: 1 threads (target='mysql')
[0m00:20:56.393791 [info ] [MainThread]: 
[0m00:20:56.410052 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m00:20:56.412055 [info ] [Thread-1 (]: 1 of 12 START sql table model prodia_test.my_first_dbt_model ................... [RUN]
[0m00:20:56.416050 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.prodia_dbt.my_first_dbt_model'
[0m00:20:56.419050 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m00:20:56.427102 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m00:20:56.431078 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 00:20:56.420046 => 00:20:56.429084
[0m00:20:56.432252 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m00:20:56.573622 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m00:20:56.577668 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:20:56.579673 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m00:20:56.581677 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:20:56.595680 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.597779 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:20:56.598778 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table
    `prodia_test`.`my_first_dbt_model__dbt_tmp`
    
    
      as
    
    (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

  
[0m00:20:56.620014 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:20:56.636762 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:20:56.637762 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup` cascade
  
[0m00:20:56.642815 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.645815 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:20:56.646810 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model` to `prodia_test`.`my_first_dbt_model__dbt_backup`
  
[0m00:20:56.662876 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.670850 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:20:56.672858 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    drop table if exists `prodia_test`.`my_first_dbt_model` cascade
  
[0m00:20:56.677383 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.680400 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:20:56.682405 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

    rename table `prodia_test`.`my_first_dbt_model__dbt_tmp` to `prodia_test`.`my_first_dbt_model`
  
[0m00:20:56.699281 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.751993 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:20:56.752993 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:20:56.753980 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m00:20:56.756990 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.768992 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_first_dbt_model"
[0m00:20:56.770980 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists `prodia_test`.`my_first_dbt_model__dbt_backup`
[0m00:20:56.790019 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.794186 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 00:20:56.435247 => 00:20:56.793184
[0m00:20:56.795185 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m00:20:56.798185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A93F8A10>]}
[0m00:20:56.800223 [info ] [Thread-1 (]: 1 of 12 OK created sql table model prodia_test.my_first_dbt_model .............. [[32mSUCCESS 2[0m in 0.38s]
[0m00:20:56.803264 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m00:20:56.805304 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m00:20:56.807296 [info ] [Thread-1 (]: 2 of 12 START sql table model prodia_test.stg_appointments ..................... [RUN]
[0m00:20:56.810289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m00:20:56.811292 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m00:20:56.819330 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m00:20:56.822721 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 00:20:56.812293 => 00:20:56.821335
[0m00:20:56.823332 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m00:20:56.834725 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m00:20:56.836743 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:20:56.838720 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m00:20:56.840741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:56.853583 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.855570 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:20:56.856890 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table
    `prodia_test`.`stg_appointments__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_appointments.sql



    select *
    from `prodia_test`.`appointments`

    )

  
[0m00:20:56.908161 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:20:56.915833 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:20:56.916833 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments__dbt_backup` cascade
  
[0m00:20:56.921833 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.924833 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:20:56.926833 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments` to `prodia_test`.`stg_appointments__dbt_backup`
  
[0m00:20:56.943463 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.950457 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:20:56.952460 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    drop table if exists `prodia_test`.`stg_appointments` cascade
  
[0m00:20:56.956952 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.960204 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:20:56.961251 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */

    rename table `prodia_test`.`stg_appointments__dbt_tmp` to `prodia_test`.`stg_appointments`
  
[0m00:20:56.977645 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.982788 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:20:56.983784 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:20:56.985812 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m00:20:56.987797 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:56.994812 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_appointments"
[0m00:20:56.995807 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_appointments"} */
drop table if exists `prodia_test`.`stg_appointments__dbt_backup`
[0m00:20:57.010957 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.015067 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 00:20:56.825745 => 00:20:57.015067
[0m00:20:57.016067 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m00:20:57.019418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA4688D0>]}
[0m00:20:57.020475 [info ] [Thread-1 (]: 2 of 12 OK created sql table model prodia_test.stg_appointments ................ [[32mSUCCESS 1000[0m in 0.21s]
[0m00:20:57.024319 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m00:20:57.025536 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m00:20:57.027532 [info ] [Thread-1 (]: 3 of 12 START sql table model prodia_test.stg_doctors .......................... [RUN]
[0m00:20:57.030665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_doctors)
[0m00:20:57.032668 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m00:20:57.040660 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m00:20:57.043678 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 00:20:57.033661 => 00:20:57.043678
[0m00:20:57.045655 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m00:20:57.056662 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m00:20:57.060111 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:20:57.061098 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m00:20:57.063403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:57.078534 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.080543 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:20:57.081511 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table
    `prodia_test`.`stg_doctors__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_doctors.sql



    select *
    from `prodia_test`.`doctors`

    )

  
[0m00:20:57.164990 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:20:57.172240 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:20:57.173237 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors__dbt_backup` cascade
  
[0m00:20:57.178296 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.181656 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:20:57.183189 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors` to `prodia_test`.`stg_doctors__dbt_backup`
  
[0m00:20:57.202099 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.209544 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:20:57.211544 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    drop table if exists `prodia_test`.`stg_doctors` cascade
  
[0m00:20:57.215711 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.218924 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:20:57.219978 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */

    rename table `prodia_test`.`stg_doctors__dbt_tmp` to `prodia_test`.`stg_doctors`
  
[0m00:20:57.238248 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.246229 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:20:57.247232 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:20:57.248233 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m00:20:57.251267 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.257263 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_doctors"
[0m00:20:57.258264 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_doctors"} */
drop table if exists `prodia_test`.`stg_doctors__dbt_backup`
[0m00:20:57.272268 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.277237 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 00:20:57.046660 => 00:20:57.276217
[0m00:20:57.278235 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m00:20:57.281235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A93CC050>]}
[0m00:20:57.282234 [info ] [Thread-1 (]: 3 of 12 OK created sql table model prodia_test.stg_doctors ..................... [[32mSUCCESS 1000[0m in 0.25s]
[0m00:20:57.284734 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m00:20:57.287247 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_invoices
[0m00:20:57.288498 [info ] [Thread-1 (]: 4 of 12 START sql table model prodia_test.stg_invoices ......................... [RUN]
[0m00:20:57.291442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_invoices)
[0m00:20:57.293460 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_invoices
[0m00:20:57.302366 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_invoices"
[0m00:20:57.305708 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (compile): 00:20:57.294879 => 00:20:57.304367
[0m00:20:57.306732 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_invoices
[0m00:20:57.317318 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_invoices"
[0m00:20:57.319309 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:20:57.320305 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: BEGIN
[0m00:20:57.322512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:57.336768 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.337766 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:20:57.339745 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

  
    

  create  table
    `prodia_test`.`stg_invoices__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_billings.sql



    select *
    from `prodia_test`.`invoices`

    )

  
[0m00:20:57.397274 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:20:57.405252 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:20:57.406253 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    drop table if exists `prodia_test`.`stg_invoices__dbt_backup` cascade
  
[0m00:20:57.411343 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.414732 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:20:57.415825 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    rename table `prodia_test`.`stg_invoices` to `prodia_test`.`stg_invoices__dbt_backup`
  
[0m00:20:57.431709 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.439860 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:20:57.440861 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    drop table if exists `prodia_test`.`stg_invoices` cascade
  
[0m00:20:57.444914 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.448474 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:20:57.449523 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */

    rename table `prodia_test`.`stg_invoices__dbt_tmp` to `prodia_test`.`stg_invoices`
  
[0m00:20:57.465981 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.471481 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m00:20:57.472483 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:20:57.474487 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m00:20:57.476504 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.483556 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_invoices"
[0m00:20:57.484556 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_invoices"} */
drop table if exists `prodia_test`.`stg_invoices__dbt_backup`
[0m00:20:57.499966 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.503968 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (execute): 00:20:57.308038 => 00:20:57.503968
[0m00:20:57.505969 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: Close
[0m00:20:57.507215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA64C910>]}
[0m00:20:57.509645 [info ] [Thread-1 (]: 4 of 12 OK created sql table model prodia_test.stg_invoices .................... [[32mSUCCESS 1000[0m in 0.22s]
[0m00:20:57.512497 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_invoices
[0m00:20:57.514531 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m00:20:57.516870 [info ] [Thread-1 (]: 5 of 12 START sql table model prodia_test.stg_patients ......................... [RUN]
[0m00:20:57.520184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_invoices, now model.prodia_dbt.stg_patients)
[0m00:20:57.521189 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m00:20:57.530179 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m00:20:57.533187 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 00:20:57.523184 => 00:20:57.532183
[0m00:20:57.534453 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m00:20:57.545647 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m00:20:57.547642 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:20:57.549637 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m00:20:57.551628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:57.567546 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.569039 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:20:57.570033 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table
    `prodia_test`.`stg_patients__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_patients.sql



    select *
    from `prodia_test`.`patients`

    )

  
[0m00:20:57.630781 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:20:57.637769 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:20:57.639779 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients__dbt_backup` cascade
  
[0m00:20:57.644106 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.647084 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:20:57.649089 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients` to `prodia_test`.`stg_patients__dbt_backup`
  
[0m00:20:57.665573 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.672977 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:20:57.674958 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    drop table if exists `prodia_test`.`stg_patients` cascade
  
[0m00:20:57.678584 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.681799 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:20:57.683315 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */

    rename table `prodia_test`.`stg_patients__dbt_tmp` to `prodia_test`.`stg_patients`
  
[0m00:20:57.700246 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.705456 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:20:57.706452 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:20:57.708457 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m00:20:57.710463 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.716690 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_patients"
[0m00:20:57.718741 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_patients"} */
drop table if exists `prodia_test`.`stg_patients__dbt_backup`
[0m00:20:57.733353 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.737854 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 00:20:57.536472 => 00:20:57.736853
[0m00:20:57.738852 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m00:20:57.741855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA512990>]}
[0m00:20:57.743853 [info ] [Thread-1 (]: 5 of 12 OK created sql table model prodia_test.stg_patients .................... [[32mSUCCESS 998[0m in 0.22s]
[0m00:20:57.746858 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m00:20:57.748851 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m00:20:57.750853 [info ] [Thread-1 (]: 6 of 12 START sql table model prodia_test.stg_procedures ....................... [RUN]
[0m00:20:57.754467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m00:20:57.755471 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m00:20:57.764694 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m00:20:57.769161 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 00:20:57.757787 => 00:20:57.768171
[0m00:20:57.771164 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m00:20:57.780571 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m00:20:57.784556 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:20:57.786553 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m00:20:57.787547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:57.800272 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.802267 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:20:57.803267 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table
    `prodia_test`.`stg_procedures__dbt_tmp`
    
    
      as
    
    (
      -- models/staging/stg_procedures.sql



    select *
    from `prodia_test`.`procedures`

    )

  
[0m00:20:57.848811 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:20:57.855860 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:20:57.856862 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures__dbt_backup` cascade
  
[0m00:20:57.861912 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.864925 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:20:57.868979 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures` to `prodia_test`.`stg_procedures__dbt_backup`
  
[0m00:20:57.886706 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.893706 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:20:57.894707 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    drop table if exists `prodia_test`.`stg_procedures` cascade
  
[0m00:20:57.898702 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.902155 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:20:57.903154 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */

    rename table `prodia_test`.`stg_procedures__dbt_tmp` to `prodia_test`.`stg_procedures`
  
[0m00:20:57.921965 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.926419 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:20:57.928401 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:20:57.929425 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m00:20:57.931682 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.938010 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.stg_procedures"
[0m00:20:57.939010 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.stg_procedures"} */
drop table if exists `prodia_test`.`stg_procedures__dbt_backup`
[0m00:20:57.954659 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:57.960166 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 00:20:57.771164 => 00:20:57.959166
[0m00:20:57.961168 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m00:20:57.964167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA4D0ED0>]}
[0m00:20:57.966217 [info ] [Thread-1 (]: 6 of 12 OK created sql table model prodia_test.stg_procedures .................. [[32mSUCCESS 1000[0m in 0.21s]
[0m00:20:57.969484 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m00:20:57.970484 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m00:20:57.972498 [info ] [Thread-1 (]: 7 of 12 START sql view model prodia_test.my_second_dbt_model ................... [RUN]
[0m00:20:57.975678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m00:20:57.977683 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m00:20:57.986160 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m00:20:57.989147 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 00:20:57.979200 => 00:20:57.988145
[0m00:20:57.990606 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m00:20:58.040295 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m00:20:58.043522 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:20:58.044273 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m00:20:58.045274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:58.057775 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.058774 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:20:58.059779 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view `prodia_test`.`my_second_dbt_model__dbt_tmp`
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from `prodia_test`.`my_first_dbt_model`
where id = 1
  );
[0m00:20:58.067287 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.074283 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:20:58.075284 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup` cascade
  
[0m00:20:58.079236 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.082355 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:20:58.084342 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model` to `prodia_test`.`my_second_dbt_model__dbt_backup`
  
[0m00:20:58.090043 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.097160 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:20:58.098160 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    drop view if exists `prodia_test`.`my_second_dbt_model` cascade
  
[0m00:20:58.102157 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.105703 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:20:58.106703 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

    rename table `prodia_test`.`my_second_dbt_model__dbt_tmp` to `prodia_test`.`my_second_dbt_model`
  
[0m00:20:58.113671 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.118454 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:20:58.119450 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:20:58.121701 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m00:20:58.124049 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.130432 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.my_second_dbt_model"
[0m00:20:58.131429 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists `prodia_test`.`my_second_dbt_model__dbt_backup`
[0m00:20:58.136829 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.141405 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 00:20:57.991633 => 00:20:58.140406
[0m00:20:58.142406 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m00:20:58.144852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A93E9410>]}
[0m00:20:58.146894 [info ] [Thread-1 (]: 7 of 12 OK created sql view model prodia_test.my_second_dbt_model .............. [[32mSUCCESS 0[0m in 0.17s]
[0m00:20:58.150302 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m00:20:58.152327 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m00:20:58.153636 [info ] [Thread-1 (]: 8 of 12 START sql table model prodia_test.int_invoice_summary .................. [RUN]
[0m00:20:58.156669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_second_dbt_model, now model.prodia_dbt.int_invoice_summary)
[0m00:20:58.158817 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_invoice_summary
[0m00:20:58.167692 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_invoice_summary"
[0m00:20:58.171758 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (compile): 00:20:58.158817 => 00:20:58.170720
[0m00:20:58.173752 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_invoice_summary
[0m00:20:58.185194 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_invoice_summary"
[0m00:20:58.188489 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:20:58.190492 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: BEGIN
[0m00:20:58.191491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:58.205279 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.206265 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:20:58.208256 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

  
    

  create  table
    `prodia_test`.`int_invoice_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_invoice_summary.sql



with invoice_summary as (
    select
        i.InvoiceID,
        i.PatientID,
        sum(i.Amount) as total_amount,
        count(i.Items) as item_count
    from
        `prodia_test`.`stg_invoices` i
    group by
        i.InvoiceID,
        i.PatientID
)

select * from invoice_summary
    )

  
[0m00:20:58.270770 [debug] [Thread-1 (]: SQL status: SUCCESS 1000 in 0.0 seconds
[0m00:20:58.277766 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:20:58.278767 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    drop table if exists `prodia_test`.`int_invoice_summary__dbt_backup` cascade
  
[0m00:20:58.284013 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.286060 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:20:58.288045 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    rename table `prodia_test`.`int_invoice_summary` to `prodia_test`.`int_invoice_summary__dbt_backup`
  
[0m00:20:58.306623 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.317628 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:20:58.319630 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    drop table if exists `prodia_test`.`int_invoice_summary` cascade
  
[0m00:20:58.323977 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.328561 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:20:58.329568 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */

    rename table `prodia_test`.`int_invoice_summary__dbt_tmp` to `prodia_test`.`int_invoice_summary`
  
[0m00:20:58.348747 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.355679 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m00:20:58.356674 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:20:58.358682 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m00:20:58.360683 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.367707 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_invoice_summary"
[0m00:20:58.368707 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_invoice_summary"} */
drop table if exists `prodia_test`.`int_invoice_summary__dbt_backup`
[0m00:20:58.384746 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.390628 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (execute): 00:20:58.174773 => 00:20:58.390628
[0m00:20:58.392630 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: Close
[0m00:20:58.394630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA55F190>]}
[0m00:20:58.396624 [info ] [Thread-1 (]: 8 of 12 OK created sql table model prodia_test.int_invoice_summary ............. [[32mSUCCESS 1000[0m in 0.24s]
[0m00:20:58.399872 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m00:20:58.402879 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m00:20:58.404878 [info ] [Thread-1 (]: 9 of 12 START sql table model prodia_test.int_patient_summary .................. [RUN]
[0m00:20:58.408146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_invoice_summary, now model.prodia_dbt.int_patient_summary)
[0m00:20:58.410144 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_patient_summary
[0m00:20:58.421200 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_patient_summary"
[0m00:20:58.424179 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (compile): 00:20:58.412134 => 00:20:58.423205
[0m00:20:58.426181 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_patient_summary
[0m00:20:58.440883 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_patient_summary"
[0m00:20:58.442866 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:20:58.444884 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: BEGIN
[0m00:20:58.445864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:58.458065 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.458825 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:20:58.460827 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

  
    

  create  table
    `prodia_test`.`int_patient_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_patient_summary.sql


with patient_appointments as (
    select
        p.PatientID,
        p.firstname,
        p.lastname,
        count(a.AppointmentID) as total_appointments
    from
        `prodia_test`.`stg_patients` p
    left join
        `prodia_test`.`stg_appointments` a on p.PatientID = a.PatientID
    group by
        p.PatientID,
        p.firstname,
        p.lastname
)

select * from patient_appointments
    )

  
[0m00:20:58.514685 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:20:58.521660 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:20:58.523668 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary__dbt_backup` cascade
  
[0m00:20:58.528337 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.531334 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:20:58.533331 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary` to `prodia_test`.`int_patient_summary__dbt_backup`
  
[0m00:20:58.549065 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.556080 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:20:58.557080 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    drop table if exists `prodia_test`.`int_patient_summary` cascade
  
[0m00:20:58.562259 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.565181 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:20:58.567164 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */

    rename table `prodia_test`.`int_patient_summary__dbt_tmp` to `prodia_test`.`int_patient_summary`
  
[0m00:20:58.584401 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.589097 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:20:58.590185 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:20:58.592174 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m00:20:58.594232 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.600297 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_patient_summary"
[0m00:20:58.602302 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_patient_summary"} */
drop table if exists `prodia_test`.`int_patient_summary__dbt_backup`
[0m00:20:58.617050 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.622054 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (execute): 00:20:58.427205 => 00:20:58.621053
[0m00:20:58.623047 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: Close
[0m00:20:58.625612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA4D0ED0>]}
[0m00:20:58.627658 [info ] [Thread-1 (]: 9 of 12 OK created sql table model prodia_test.int_patient_summary ............. [[32mSUCCESS 998[0m in 0.22s]
[0m00:20:58.629960 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m00:20:58.632498 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m00:20:58.633484 [info ] [Thread-1 (]: 10 of 12 START sql table model prodia_test.int_appointment_details ............. [RUN]
[0m00:20:58.637268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_patient_summary, now model.prodia_dbt.int_appointment_details)
[0m00:20:58.638267 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_appointment_details
[0m00:20:58.648314 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_appointment_details"
[0m00:20:58.652637 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (compile): 00:20:58.640269 => 00:20:58.651639
[0m00:20:58.653644 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_appointment_details
[0m00:20:58.663796 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_appointment_details"
[0m00:20:58.667795 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:20:58.669804 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: BEGIN
[0m00:20:58.670933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:58.685479 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.686651 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:20:58.689380 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

  
    

  create  table
    `prodia_test`.`int_appointment_details__dbt_tmp`
    
    
      as
    
    (
      -- models/intermediate/int_appointment_details.sql



with appointment_info as (
    select
        a.AppointmentID,
        a.AppointmentDate,
        a.AppointmentTime,
        p.PatientID,
        concat(p.firstname, ' ', p.lastname) as patient_name,
        d.DoctorName,
        pr.ProcedureName
    from
        `prodia_test`.`stg_appointments` a
    join
        `prodia_test`.`stg_patients` p on a.PatientID = p.PatientID
    join
        `prodia_test`.`stg_doctors` d on a.DoctorID = d.DoctorID
    left join
        `prodia_test`.`stg_procedures` pr on a.AppointmentID = pr.AppointmentID
)

select * from appointment_info
    )

  
[0m00:20:58.761487 [debug] [Thread-1 (]: SQL status: SUCCESS 1367 in 0.0 seconds
[0m00:20:58.768468 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:20:58.770476 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details__dbt_backup` cascade
  
[0m00:20:58.775474 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.778468 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:20:58.780468 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details` to `prodia_test`.`int_appointment_details__dbt_backup`
  
[0m00:20:58.797804 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.805830 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:20:58.807818 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    drop table if exists `prodia_test`.`int_appointment_details` cascade
  
[0m00:20:58.812186 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.815678 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:20:58.816734 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */

    rename table `prodia_test`.`int_appointment_details__dbt_tmp` to `prodia_test`.`int_appointment_details`
  
[0m00:20:58.834697 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.839926 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:20:58.840929 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:20:58.841929 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m00:20:58.843922 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.851165 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.int_appointment_details"
[0m00:20:58.852165 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.int_appointment_details"} */
drop table if exists `prodia_test`.`int_appointment_details__dbt_backup`
[0m00:20:58.866622 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.871668 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (execute): 00:20:58.654643 => 00:20:58.870674
[0m00:20:58.872690 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: Close
[0m00:20:58.874672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA5C8C10>]}
[0m00:20:58.877036 [info ] [Thread-1 (]: 10 of 12 OK created sql table model prodia_test.int_appointment_details ........ [[32mSUCCESS 1367[0m in 0.24s]
[0m00:20:58.880122 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m00:20:58.882268 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m00:20:58.883332 [info ] [Thread-1 (]: 11 of 12 START sql table model prodia_test.dm_patient_overview ................. [RUN]
[0m00:20:58.887348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_appointment_details, now model.prodia_dbt.dm_patient_overview)
[0m00:20:58.888819 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_patient_overview
[0m00:20:58.897428 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_patient_overview"
[0m00:20:58.901670 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (compile): 00:20:58.890230 => 00:20:58.900665
[0m00:20:58.904733 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_patient_overview
[0m00:20:58.914093 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_patient_overview"
[0m00:20:58.917072 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:20:58.919170 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: BEGIN
[0m00:20:58.920494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:58.932933 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:58.934909 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:20:58.937348 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_patient_overview"} */

  
    

  create  table
    `prodia_test`.`dm_patient_overview__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_patient_overview.sql



with patient_overview as (
    select
        ps.PatientID,
        ps.firstname,
        ps.lastname,
        SUM(ps.total_appointments) as total_appointments,
        COALESCE(SUM(ins.total_amount), 0) AS total_spent
    from
        `prodia_test`.`int_patient_summary` ps
    left join
        `prodia_test`.`int_invoice_summary` ins on ps.PatientID = ins.PatientID
    group by
        ps.PatientID, 
        ps.firstname, 
        ps.lastname
)

select * from patient_overview
    )

  
[0m00:20:58.998286 [debug] [Thread-1 (]: SQL status: SUCCESS 998 in 0.0 seconds
[0m00:20:59.006263 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:20:59.007266 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_patient_overview"} */

    drop table if exists `prodia_test`.`dm_patient_overview` cascade
  
[0m00:20:59.011549 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.014794 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:20:59.016780 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_patient_overview"} */

    rename table `prodia_test`.`dm_patient_overview__dbt_tmp` to `prodia_test`.`dm_patient_overview`
  
[0m00:20:59.034385 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.039970 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: COMMIT
[0m00:20:59.041168 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:20:59.041970 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: COMMIT
[0m00:20:59.043980 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.051478 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_patient_overview"
[0m00:20:59.052478 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_patient_overview"} */
drop table if exists `prodia_test`.`dm_patient_overview__dbt_backup`
[0m00:20:59.057697 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.061699 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (execute): 00:20:58.905753 => 00:20:59.060683
[0m00:20:59.062701 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: Close
[0m00:20:59.065733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA55DF10>]}
[0m00:20:59.067844 [info ] [Thread-1 (]: 11 of 12 OK created sql table model prodia_test.dm_patient_overview ............ [[32mSUCCESS 998[0m in 0.18s]
[0m00:20:59.071170 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m00:20:59.073359 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m00:20:59.075286 [info ] [Thread-1 (]: 12 of 12 START sql table model prodia_test.dm_appointment_summary .............. [RUN]
[0m00:20:59.078171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_patient_overview, now model.prodia_dbt.dm_appointment_summary)
[0m00:20:59.079168 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_appointment_summary
[0m00:20:59.089161 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_appointment_summary"
[0m00:20:59.092411 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (compile): 00:20:59.081171 => 00:20:59.091163
[0m00:20:59.094411 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_appointment_summary
[0m00:20:59.110163 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_appointment_summary"
[0m00:20:59.113166 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:20:59.114169 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: BEGIN
[0m00:20:59.117179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:59.130164 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.131363 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:20:59.133168 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

  
    

  create  table
    `prodia_test`.`dm_appointment_summary__dbt_tmp`
    
    
      as
    
    (
      -- models/datamart/dm_appointment_summary.sql



with appointment_summary as (
    select
        ad.AppointmentDate,
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        COUNT(DISTINCT ad.ProcedureName) AS total_procedures
    from
        `prodia_test`.`int_appointment_details` ad
    group by
        ad.AppointmentDate, 
        ad.DoctorName
)

select * from appointment_summary
    )

  
[0m00:20:59.213568 [debug] [Thread-1 (]: SQL status: SUCCESS 999 in 0.0 seconds
[0m00:20:59.220716 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:20:59.222800 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    drop table if exists `prodia_test`.`dm_appointment_summary__dbt_backup` cascade
  
[0m00:20:59.226360 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.229567 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:20:59.231614 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    rename table `prodia_test`.`dm_appointment_summary` to `prodia_test`.`dm_appointment_summary__dbt_backup`
  
[0m00:20:59.249004 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.256193 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:20:59.257192 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    drop table if exists `prodia_test`.`dm_appointment_summary` cascade
  
[0m00:20:59.262669 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.265173 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:20:59.266224 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

    rename table `prodia_test`.`dm_appointment_summary__dbt_tmp` to `prodia_test`.`dm_appointment_summary`
  
[0m00:20:59.284182 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.289184 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m00:20:59.290183 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:20:59.291190 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m00:20:59.294182 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.300182 [debug] [Thread-1 (]: Using mysql connection "model.prodia_dbt.dm_appointment_summary"
[0m00:20:59.302185 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "mysql", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
drop table if exists `prodia_test`.`dm_appointment_summary__dbt_backup`
[0m00:20:59.315359 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.319892 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (execute): 00:20:59.095166 => 00:20:59.319892
[0m00:20:59.321892 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: Close
[0m00:20:59.323893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c7458b-faf5-497e-9a90-b7a3ef8e013b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7AA4FFAD0>]}
[0m00:20:59.325893 [info ] [Thread-1 (]: 12 of 12 OK created sql table model prodia_test.dm_appointment_summary ......... [[32mSUCCESS 999[0m in 0.25s]
[0m00:20:59.328895 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m00:20:59.333319 [debug] [MainThread]: Using mysql connection "master"
[0m00:20:59.335303 [debug] [MainThread]: On master: BEGIN
[0m00:20:59.336319 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:20:59.349509 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.351506 [debug] [MainThread]: On master: COMMIT
[0m00:20:59.352619 [debug] [MainThread]: Using mysql connection "master"
[0m00:20:59.353619 [debug] [MainThread]: On master: COMMIT
[0m00:20:59.355641 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:20:59.356639 [debug] [MainThread]: On master: Close
[0m00:20:59.359170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:59.360222 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m00:20:59.361219 [debug] [MainThread]: Connection 'list_None_prodia_test' was properly closed.
[0m00:20:59.361219 [debug] [MainThread]: Connection 'model.prodia_dbt.dm_appointment_summary' was properly closed.
[0m00:20:59.362754 [info ] [MainThread]: 
[0m00:20:59.365647 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m00:20:59.374049 [debug] [MainThread]: Command end result
[0m00:20:59.393536 [info ] [MainThread]: 
[0m00:20:59.395527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:20:59.398584 [info ] [MainThread]: 
[0m00:20:59.400589 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m00:20:59.404918 [debug] [MainThread]: Command `dbt run` succeeded at 00:20:59.403909 after 6.59 seconds
[0m00:20:59.405915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A888BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A212BD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A21C0A90>]}
[0m00:20:59.406928 [debug] [MainThread]: Flushing usage events
[0m21:30:02.879751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786C6DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197866D3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786C62B90>]}


============================== 21:30:02.885277 | bfd8af53-d7f9-4246-91b4-6b979b204106 ==============================
[0m21:30:02.885277 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:30:02.887791 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'quiet': 'False', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'version_check': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_cache_events': 'False'}
[0m21:30:03.118399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019785803E50>]}
[0m21:30:03.160517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786B40210>]}
[0m21:30:03.183826 [debug] [MainThread]: checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, vars: {}, profile: , target: postgres, version: 1.5.0
[0m21:30:03.272605 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:30:03.274596 [debug] [MainThread]: previous checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m21:30:03.275615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786E35F10>]}
[0m21:30:04.700975 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m21:30:04.728675 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_cohort_analysis.sql
[0m21:30:04.736212 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_doctor_performance.sql
[0m21:30:04.743690 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_monthly_revenue.sql
[0m21:30:04.750713 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m21:30:04.758276 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m21:30:04.765816 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m21:30:04.772799 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m21:30:04.781110 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m21:30:04.788754 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m21:30:04.796604 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m21:30:04.807812 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m21:30:04.811819 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m21:30:04.828922 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m21:30:04.831932 [debug] [MainThread]: 1603: static parser failed on staging\stg_invoices.sql
[0m21:30:04.841084 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_invoices.sql
[0m21:30:04.845096 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m21:30:04.854676 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m21:30:04.859269 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m21:30:04.868304 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m21:30:05.204345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786DF66D0>]}
[0m21:30:05.223379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786D76AD0>]}
[0m21:30:05.224413 [info ] [MainThread]: Found 15 models, 4 tests, 0 snapshots, 0 analyses, 318 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m21:30:05.226415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786ECD690>]}
[0m21:30:05.230424 [info ] [MainThread]: 
[0m21:30:05.232398 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:05.237946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test'
[0m21:30:05.261064 [debug] [ThreadPool]: Using postgres connection "list_prodia_test"
[0m21:30:05.262063 [debug] [ThreadPool]: On list_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test"} */

    select distinct nspname from pg_namespace
  
[0m21:30:05.263062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:05.457858 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:30:05.460888 [debug] [ThreadPool]: On list_prodia_test: Close
[0m21:30:05.465900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test_public'
[0m21:30:05.477456 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m21:30:05.478993 [debug] [ThreadPool]: On list_prodia_test_public: BEGIN
[0m21:30:05.480013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:05.548084 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:05.549086 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m21:30:05.549086 [debug] [ThreadPool]: On list_prodia_test_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test_public"} */
select
      'prodia_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'prodia_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:30:05.562844 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:30:05.566554 [debug] [ThreadPool]: On list_prodia_test_public: ROLLBACK
[0m21:30:05.567542 [debug] [ThreadPool]: On list_prodia_test_public: Close
[0m21:30:05.582087 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:05.584603 [debug] [MainThread]: On master: BEGIN
[0m21:30:05.586112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:05.654302 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:05.655303 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:05.656304 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:05.673261 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:30:05.675271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786E03850>]}
[0m21:30:05.677259 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:05.678260 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:05.679258 [debug] [MainThread]: On master: BEGIN
[0m21:30:05.680260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:05.680260 [debug] [MainThread]: On master: COMMIT
[0m21:30:05.681787 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:05.681787 [debug] [MainThread]: On master: COMMIT
[0m21:30:05.683389 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:05.684419 [debug] [MainThread]: On master: Close
[0m21:30:05.686420 [info ] [MainThread]: Concurrency: 1 threads (target='postgres')
[0m21:30:05.688409 [info ] [MainThread]: 
[0m21:30:05.699951 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_monthly_revenue
[0m21:30:05.701972 [info ] [Thread-1 (]: 1 of 15 START sql view model public.dm_monthly_revenue ......................... [RUN]
[0m21:30:05.704086 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.prodia_dbt.dm_monthly_revenue'
[0m21:30:05.706084 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_monthly_revenue
[0m21:30:05.711077 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_monthly_revenue"
[0m21:30:05.714621 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_monthly_revenue (compile): 21:30:05.708088 => 21:30:05.713604
[0m21:30:05.715627 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_monthly_revenue
[0m21:30:05.797261 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_monthly_revenue"
[0m21:30:05.800803 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:30:05.801808 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: BEGIN
[0m21:30:05.802819 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:30:05.875046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:05.876076 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:30:05.878070 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_monthly_revenue"} */

  create view "prodia_test"."public"."dm_monthly_revenue__dbt_tmp"
    
    
  as (
    CREATE TABLE datamart.monthly_trends AS
SELECT
    DATE_TRUNC('month', AppointmentDate) AS month,
    COUNT(AppointmentID) AS total_appointments,
    SUM(Amount) AS total_revenue
FROM
    intermediate.appointment_details ad
JOIN
    intermediate.invoice_summary i ON ad.PatientID = i.PatientID
GROUP BY
    month;
  );
[0m21:30:05.880057 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE TABLE datamart.monthly_trends AS
            ^

[0m21:30:05.881077 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: ROLLBACK
[0m21:30:05.882087 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_monthly_revenue (execute): 21:30:05.716647 => 21:30:05.882087
[0m21:30:05.884447 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: Close
[0m21:30:05.905902 [debug] [Thread-1 (]: Database Error in model dm_monthly_revenue (models\datamart\dm_monthly_revenue.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE TABLE datamart.monthly_trends AS
              ^
  compiled Code at target\run\prodia_dbt\models\datamart\dm_monthly_revenue.sql
[0m21:30:05.906934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786D53310>]}
[0m21:30:05.908929 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model public.dm_monthly_revenue ................ [[31mERROR[0m in 0.20s]
[0m21:30:05.910923 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_monthly_revenue
[0m21:30:05.912938 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m21:30:05.914947 [info ] [Thread-1 (]: 2 of 15 START sql table model public.my_first_dbt_model ........................ [RUN]
[0m21:30:05.916901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_monthly_revenue, now model.prodia_dbt.my_first_dbt_model)
[0m21:30:05.918509 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m21:30:05.923520 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m21:30:05.925496 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 21:30:05.918509 => 21:30:05.925496
[0m21:30:05.928030 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m21:30:05.982534 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m21:30:05.986053 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:30:05.987055 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m21:30:05.988061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:06.059983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:06.060981 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:30:06.062984 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table "prodia_test"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:30:06.071528 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m21:30:06.086173 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:30:06.087685 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:30:06.089713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:06.135992 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m21:30:06.136991 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:30:06.137992 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m21:30:06.141527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:06.153046 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:30:06.154045 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists "prodia_test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:30:06.156057 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:30:06.160056 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 21:30:05.929043 => 21:30:06.159051
[0m21:30:06.161572 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m21:30:06.163598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786DC7F10>]}
[0m21:30:06.164613 [info ] [Thread-1 (]: 2 of 15 OK created sql table model public.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.25s]
[0m21:30:06.167611 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m21:30:06.168609 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m21:30:06.170609 [info ] [Thread-1 (]: 3 of 15 START sql table model public.stg_appointments .......................... [RUN]
[0m21:30:06.173134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m21:30:06.174140 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m21:30:06.181136 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m21:30:06.183143 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 21:30:06.175132 => 21:30:06.183143
[0m21:30:06.184313 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m21:30:06.194862 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m21:30:06.198864 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:30:06.199881 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m21:30:06.201884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:06.269349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:06.270368 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:30:06.272356 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table "prodia_test"."public"."stg_appointments__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_appointments.sql



    select *
    from "prodia_test"."prodia_test"."appointments"

  );
  
[0m21:30:06.273360 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.appointments" does not exist
LINE 17:     from "prodia_test"."prodia_test"."appointments"
                  ^

[0m21:30:06.275348 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: ROLLBACK
[0m21:30:06.277358 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 21:30:06.185356 => 21:30:06.276341
[0m21:30:06.278888 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m21:30:06.284416 [debug] [Thread-1 (]: Database Error in model stg_appointments (models\staging\stg_appointments.sql)
  relation "prodia_test.appointments" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."appointments"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\stg_appointments.sql
[0m21:30:06.285427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786FA1490>]}
[0m21:30:06.287441 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model public.stg_appointments ................. [[31mERROR[0m in 0.11s]
[0m21:30:06.288576 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m21:30:06.291143 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m21:30:06.292157 [info ] [Thread-1 (]: 4 of 15 START sql table model public.stg_doctors ............................... [RUN]
[0m21:30:06.295156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_doctors)
[0m21:30:06.296154 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m21:30:06.302686 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m21:30:06.306084 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 21:30:06.297153 => 21:30:06.305070
[0m21:30:06.307082 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m21:30:06.315620 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m21:30:06.318272 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:30:06.319287 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m21:30:06.320292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:06.391954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:06.392958 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:30:06.393952 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table "prodia_test"."public"."stg_doctors__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_doctors.sql



    select *
    from "prodia_test"."prodia_test"."doctors"

  );
  
[0m21:30:06.394958 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.doctors" does not exist
LINE 17:     from "prodia_test"."prodia_test"."doctors"
                  ^

[0m21:30:06.396468 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: ROLLBACK
[0m21:30:06.398482 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 21:30:06.308089 => 21:30:06.397483
[0m21:30:06.399476 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m21:30:06.405477 [debug] [Thread-1 (]: Database Error in model stg_doctors (models\staging\stg_doctors.sql)
  relation "prodia_test.doctors" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."doctors"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\stg_doctors.sql
[0m21:30:06.406985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786EFE1D0>]}
[0m21:30:06.408998 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model public.stg_doctors ...................... [[31mERROR[0m in 0.11s]
[0m21:30:06.410998 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m21:30:06.411994 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_invoices
[0m21:30:06.412996 [info ] [Thread-1 (]: 5 of 15 START sql table model public.stg_invoices .............................. [RUN]
[0m21:30:06.415003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_invoices)
[0m21:30:06.415995 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_invoices
[0m21:30:06.422518 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_invoices"
[0m21:30:06.426522 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (compile): 21:30:06.416994 => 21:30:06.425524
[0m21:30:06.427526 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_invoices
[0m21:30:06.435039 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_invoices"
[0m21:30:06.438046 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:30:06.439036 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: BEGIN
[0m21:30:06.441183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:06.507361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:06.508345 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:30:06.509346 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */

  
    

  create  table "prodia_test"."public"."stg_invoices__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_billings.sql



    select *
    from "prodia_test"."prodia_test"."invoices"

  );
  
[0m21:30:06.511363 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.invoices" does not exist
LINE 17:     from "prodia_test"."prodia_test"."invoices"
                  ^

[0m21:30:06.512363 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: ROLLBACK
[0m21:30:06.514927 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (execute): 21:30:06.428520 => 21:30:06.513893
[0m21:30:06.515937 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: Close
[0m21:30:06.521906 [debug] [Thread-1 (]: Database Error in model stg_invoices (models\staging\stg_invoices.sql)
  relation "prodia_test.invoices" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."invoices"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\stg_invoices.sql
[0m21:30:06.522906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786EBD150>]}
[0m21:30:06.525452 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model public.stg_invoices ..................... [[31mERROR[0m in 0.11s]
[0m21:30:06.527464 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_invoices
[0m21:30:06.528463 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m21:30:06.530447 [info ] [Thread-1 (]: 6 of 15 START sql table model public.stg_patients .............................. [RUN]
[0m21:30:06.533450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_invoices, now model.prodia_dbt.stg_patients)
[0m21:30:06.534970 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m21:30:06.541995 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m21:30:06.546511 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 21:30:06.535988 => 21:30:06.544987
[0m21:30:06.548531 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m21:30:06.557035 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m21:30:06.559074 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:30:06.561065 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m21:30:06.562066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:06.637499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:06.638519 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:30:06.640504 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table "prodia_test"."public"."stg_patients__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_patients.sql



    select *
    from "prodia_test"."prodia_test"."patients"

  );
  
[0m21:30:06.643035 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.patients" does not exist
LINE 17:     from "prodia_test"."prodia_test"."patients"
                  ^

[0m21:30:06.645549 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: ROLLBACK
[0m21:30:06.649565 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 21:30:06.549529 => 21:30:06.648570
[0m21:30:06.651563 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m21:30:06.658083 [debug] [Thread-1 (]: Database Error in model stg_patients (models\staging\stg_patients.sql)
  relation "prodia_test.patients" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."patients"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\stg_patients.sql
[0m21:30:06.659083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019787002250>]}
[0m21:30:06.660088 [error] [Thread-1 (]: 6 of 15 ERROR creating sql table model public.stg_patients ..................... [[31mERROR[0m in 0.13s]
[0m21:30:06.662089 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m21:30:06.663601 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m21:30:06.664626 [info ] [Thread-1 (]: 7 of 15 START sql table model public.stg_procedures ............................ [RUN]
[0m21:30:06.666608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m21:30:06.668623 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m21:30:06.675177 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m21:30:06.678513 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 21:30:06.669608 => 21:30:06.677502
[0m21:30:06.679521 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m21:30:06.690038 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m21:30:06.693048 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:30:06.695042 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m21:30:06.695552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:06.763049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:06.764049 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:30:06.765051 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table "prodia_test"."public"."stg_procedures__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_procedures.sql



    select *
    from "prodia_test"."prodia_test"."procedures"

  );
  
[0m21:30:06.767049 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "prodia_test.procedures" does not exist
LINE 17:     from "prodia_test"."prodia_test"."procedures"
                  ^

[0m21:30:06.768040 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: ROLLBACK
[0m21:30:06.769567 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 21:30:06.680517 => 21:30:06.769567
[0m21:30:06.771595 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m21:30:06.777598 [debug] [Thread-1 (]: Database Error in model stg_procedures (models\staging\stg_procedures.sql)
  relation "prodia_test.procedures" does not exist
  LINE 17:     from "prodia_test"."prodia_test"."procedures"
                    ^
  compiled Code at target\run\prodia_dbt\models\staging\stg_procedures.sql
[0m21:30:06.778607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001978808D7D0>]}
[0m21:30:06.779608 [error] [Thread-1 (]: 7 of 15 ERROR creating sql table model public.stg_procedures ................... [[31mERROR[0m in 0.11s]
[0m21:30:06.782650 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m21:30:06.783659 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m21:30:06.785924 [info ] [Thread-1 (]: 8 of 15 START sql view model public.my_second_dbt_model ........................ [RUN]
[0m21:30:06.788915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m21:30:06.789912 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m21:30:06.795122 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m21:30:06.798109 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 21:30:06.790912 => 21:30:06.797135
[0m21:30:06.799124 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m21:30:06.808696 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m21:30:06.812216 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:30:06.813249 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m21:30:06.814252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:06.883510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:06.887048 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:30:06.888567 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view "prodia_test"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "prodia_test"."public"."my_first_dbt_model"
where id = 1
  );
[0m21:30:06.898741 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:30:06.905767 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:30:06.906757 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
alter table "prodia_test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:30:06.909337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:06.913328 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m21:30:06.914314 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:30:06.915337 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m21:30:06.918321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:06.923873 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:30:06.925873 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists "prodia_test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m21:30:06.926875 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:30:06.930355 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 21:30:06.800123 => 21:30:06.930355
[0m21:30:06.932388 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m21:30:06.933389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd8af53-d7f9-4246-91b4-6b979b204106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001978808C410>]}
[0m21:30:06.935386 [info ] [Thread-1 (]: 8 of 15 OK created sql view model public.my_second_dbt_model ................... [[32mCREATE VIEW[0m in 0.15s]
[0m21:30:06.937389 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m21:30:06.939385 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m21:30:06.940897 [info ] [Thread-1 (]: 9 of 15 SKIP relation public.int_invoice_summary ............................... [[33mSKIP[0m]
[0m21:30:06.941912 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m21:30:06.943934 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m21:30:06.944934 [info ] [Thread-1 (]: 10 of 15 SKIP relation public.int_patient_summary .............................. [[33mSKIP[0m]
[0m21:30:06.946956 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m21:30:06.948934 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m21:30:06.949952 [info ] [Thread-1 (]: 11 of 15 SKIP relation public.int_appointment_details .......................... [[33mSKIP[0m]
[0m21:30:06.953454 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m21:30:06.954469 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m21:30:06.956466 [info ] [Thread-1 (]: 12 of 15 SKIP relation public.dm_patient_overview .............................. [[33mSKIP[0m]
[0m21:30:06.959453 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m21:30:06.960449 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m21:30:06.961963 [info ] [Thread-1 (]: 13 of 15 SKIP relation public.dm_appointment_summary ........................... [[33mSKIP[0m]
[0m21:30:06.963979 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m21:30:06.964977 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_cohort_analysis
[0m21:30:06.966994 [info ] [Thread-1 (]: 14 of 15 SKIP relation public.dm_cohort_analysis ............................... [[33mSKIP[0m]
[0m21:30:06.968988 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_cohort_analysis
[0m21:30:06.969983 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_doctor_performance
[0m21:30:06.970976 [info ] [Thread-1 (]: 15 of 15 SKIP relation public.dm_doctor_performance ............................ [[33mSKIP[0m]
[0m21:30:06.973522 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_doctor_performance
[0m21:30:06.977514 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:06.978514 [debug] [MainThread]: On master: BEGIN
[0m21:30:06.979519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:07.050032 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:07.051058 [debug] [MainThread]: On master: COMMIT
[0m21:30:07.051058 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:07.052184 [debug] [MainThread]: On master: COMMIT
[0m21:30:07.053184 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:07.054180 [debug] [MainThread]: On master: Close
[0m21:30:07.056196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:07.056196 [debug] [MainThread]: Connection 'list_prodia_test' was properly closed.
[0m21:30:07.057714 [debug] [MainThread]: Connection 'list_prodia_test_public' was properly closed.
[0m21:30:07.058739 [debug] [MainThread]: Connection 'model.prodia_dbt.my_second_dbt_model' was properly closed.
[0m21:30:07.059750 [info ] [MainThread]: 
[0m21:30:07.061759 [info ] [MainThread]: Finished running 2 view models, 13 table models in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m21:30:07.064748 [debug] [MainThread]: Command end result
[0m21:30:07.082431 [info ] [MainThread]: 
[0m21:30:07.084436 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m21:30:07.085526 [info ] [MainThread]: 
[0m21:30:07.087546 [error] [MainThread]: [33mDatabase Error in model dm_monthly_revenue (models\datamart\dm_monthly_revenue.sql)[0m
[0m21:30:07.088531 [error] [MainThread]:   syntax error at or near "CREATE"
[0m21:30:07.091092 [error] [MainThread]:   LINE 7:     CREATE TABLE datamart.monthly_trends AS
[0m21:30:07.093087 [error] [MainThread]:               ^
[0m21:30:07.094108 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_monthly_revenue.sql
[0m21:30:07.096088 [info ] [MainThread]: 
[0m21:30:07.098084 [error] [MainThread]: [33mDatabase Error in model stg_appointments (models\staging\stg_appointments.sql)[0m
[0m21:30:07.099087 [error] [MainThread]:   relation "prodia_test.appointments" does not exist
[0m21:30:07.101627 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."appointments"
[0m21:30:07.102632 [error] [MainThread]:                     ^
[0m21:30:07.104650 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_appointments.sql
[0m21:30:07.106656 [info ] [MainThread]: 
[0m21:30:07.107661 [error] [MainThread]: [33mDatabase Error in model stg_doctors (models\staging\stg_doctors.sql)[0m
[0m21:30:07.109661 [error] [MainThread]:   relation "prodia_test.doctors" does not exist
[0m21:30:07.111175 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."doctors"
[0m21:30:07.112200 [error] [MainThread]:                     ^
[0m21:30:07.114213 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_doctors.sql
[0m21:30:07.115208 [info ] [MainThread]: 
[0m21:30:07.117209 [error] [MainThread]: [33mDatabase Error in model stg_invoices (models\staging\stg_invoices.sql)[0m
[0m21:30:07.119195 [error] [MainThread]:   relation "prodia_test.invoices" does not exist
[0m21:30:07.120213 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."invoices"
[0m21:30:07.122762 [error] [MainThread]:                     ^
[0m21:30:07.124780 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_invoices.sql
[0m21:30:07.125782 [info ] [MainThread]: 
[0m21:30:07.127780 [error] [MainThread]: [33mDatabase Error in model stg_patients (models\staging\stg_patients.sql)[0m
[0m21:30:07.129779 [error] [MainThread]:   relation "prodia_test.patients" does not exist
[0m21:30:07.130775 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."patients"
[0m21:30:07.133318 [error] [MainThread]:                     ^
[0m21:30:07.138359 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_patients.sql
[0m21:30:07.142914 [info ] [MainThread]: 
[0m21:30:07.146967 [error] [MainThread]: [33mDatabase Error in model stg_procedures (models\staging\stg_procedures.sql)[0m
[0m21:30:07.147957 [error] [MainThread]:   relation "prodia_test.procedures" does not exist
[0m21:30:07.149960 [error] [MainThread]:   LINE 17:     from "prodia_test"."prodia_test"."procedures"
[0m21:30:07.150957 [error] [MainThread]:                     ^
[0m21:30:07.152962 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\staging\stg_procedures.sql
[0m21:30:07.154480 [info ] [MainThread]: 
[0m21:30:07.155479 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=6 SKIP=7 TOTAL=15
[0m21:30:07.157507 [debug] [MainThread]: Command `dbt run` failed at 21:30:07.156994 after 4.31 seconds
[0m21:30:07.158526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019786690310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FFF40BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FFF40910>]}
[0m21:30:07.159526 [debug] [MainThread]: Flushing usage events
[0m21:31:35.093646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3CEBDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3B869710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3CEB27D0>]}


============================== 21:31:35.098642 | f26c6f4e-7c51-4199-bbe5-82a4758ce015 ==============================
[0m21:31:35.098642 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:31:35.101636 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'quiet': 'False', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80'}
[0m21:31:35.108157 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'prodia_dbt' does not have a target named 'postgrsql'. The valid target names for this profile are:
   - postgres
[0m21:31:35.111689 [debug] [MainThread]: Command `dbt run` failed at 21:31:35.111689 after 0.05 seconds
[0m21:31:35.113674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3CEC1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F3BC36A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F361B0B50>]}
[0m21:31:35.114908 [debug] [MainThread]: Flushing usage events
[0m21:31:57.294435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BAF23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34B9AE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BAF2610>]}


============================== 21:31:57.300448 | e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe ==============================
[0m21:31:57.300448 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:31:57.301950 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'debug': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80'}
[0m21:31:57.534499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34A691CD0>]}
[0m21:31:57.574710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34A691CD0>]}
[0m21:31:57.600755 [debug] [MainThread]: checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, vars: {}, profile: , target: postgres, version: 1.5.0
[0m21:31:57.693918 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:31:57.695920 [debug] [MainThread]: previous checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m21:31:57.697054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BCC8A90>]}
[0m21:31:59.145250 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m21:31:59.177022 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_cohort_analysis.sql
[0m21:31:59.185591 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_doctor_performance.sql
[0m21:31:59.192339 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_monthly_revenue.sql
[0m21:31:59.204890 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m21:31:59.212465 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m21:31:59.217984 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m21:31:59.225522 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m21:31:59.233412 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m21:31:59.240393 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m21:31:59.247582 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m21:31:59.259661 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m21:31:59.264429 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m21:31:59.279015 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m21:31:59.285526 [debug] [MainThread]: 1603: static parser failed on staging\stg_invoices.sql
[0m21:31:59.300103 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_invoices.sql
[0m21:31:59.308635 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m21:31:59.323184 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m21:31:59.328706 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m21:31:59.344306 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m21:31:59.731826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BC9F450>]}
[0m21:31:59.751437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BDAFAD0>]}
[0m21:31:59.753437 [info ] [MainThread]: Found 15 models, 4 tests, 0 snapshots, 0 analyses, 318 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m21:31:59.754962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BD08ED0>]}
[0m21:31:59.760011 [info ] [MainThread]: 
[0m21:31:59.764006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:31:59.771576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test'
[0m21:31:59.803219 [debug] [ThreadPool]: Using postgres connection "list_prodia_test"
[0m21:31:59.804217 [debug] [ThreadPool]: On list_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test"} */

    select distinct nspname from pg_namespace
  
[0m21:31:59.805226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:59.885352 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:31:59.888348 [debug] [ThreadPool]: On list_prodia_test: Close
[0m21:31:59.894698 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test_public'
[0m21:31:59.907205 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m21:31:59.908204 [debug] [ThreadPool]: On list_prodia_test_public: BEGIN
[0m21:31:59.909218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:59.982890 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:31:59.983890 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m21:31:59.984890 [debug] [ThreadPool]: On list_prodia_test_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test_public"} */
select
      'prodia_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'prodia_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:31:59.997407 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:31:59.999916 [debug] [ThreadPool]: On list_prodia_test_public: ROLLBACK
[0m21:32:00.001933 [debug] [ThreadPool]: On list_prodia_test_public: Close
[0m21:32:00.016468 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:00.017468 [debug] [MainThread]: On master: BEGIN
[0m21:32:00.018471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:00.085505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:32:00.086747 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:00.087748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:32:00.104871 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:32:00.108110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34B9D0190>]}
[0m21:32:00.109109 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:00.111115 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:00.112117 [debug] [MainThread]: On master: BEGIN
[0m21:32:00.113111 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:32:00.114111 [debug] [MainThread]: On master: COMMIT
[0m21:32:00.115112 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:00.116109 [debug] [MainThread]: On master: COMMIT
[0m21:32:00.117110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:32:00.118360 [debug] [MainThread]: On master: Close
[0m21:32:00.120354 [info ] [MainThread]: Concurrency: 1 threads (target='postgres')
[0m21:32:00.122359 [info ] [MainThread]: 
[0m21:32:00.133997 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_monthly_revenue
[0m21:32:00.135007 [info ] [Thread-1 (]: 1 of 15 START sql view model public.dm_monthly_revenue ......................... [RUN]
[0m21:32:00.139525 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.prodia_dbt.dm_monthly_revenue'
[0m21:32:00.140531 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_monthly_revenue
[0m21:32:00.144542 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_monthly_revenue"
[0m21:32:00.147548 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_monthly_revenue (compile): 21:32:00.141545 => 21:32:00.146549
[0m21:32:00.149065 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_monthly_revenue
[0m21:32:00.238231 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_monthly_revenue"
[0m21:32:00.239241 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:32:00.240243 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: BEGIN
[0m21:32:00.241260 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:32:00.306625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:00.307621 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:32:00.309152 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_monthly_revenue"} */

  create view "prodia_test"."public"."dm_monthly_revenue__dbt_tmp"
    
    
  as (
    CREATE TABLE datamart.monthly_trends AS
SELECT
    DATE_TRUNC('month', AppointmentDate) AS month,
    COUNT(AppointmentID) AS total_appointments,
    SUM(Amount) AS total_revenue
FROM
    intermediate.appointment_details ad
JOIN
    intermediate.invoice_summary i ON ad.PatientID = i.PatientID
GROUP BY
    month;
  );
[0m21:32:00.311203 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE TABLE datamart.monthly_trends AS
            ^

[0m21:32:00.313167 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: ROLLBACK
[0m21:32:00.315167 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_monthly_revenue (execute): 21:32:00.149065 => 21:32:00.314165
[0m21:32:00.316165 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: Close
[0m21:32:00.330852 [debug] [Thread-1 (]: Database Error in model dm_monthly_revenue (models\datamart\dm_monthly_revenue.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE TABLE datamart.monthly_trends AS
              ^
  compiled Code at target\run\prodia_dbt\models\datamart\dm_monthly_revenue.sql
[0m21:32:00.331865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BDE2F10>]}
[0m21:32:00.333882 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model public.dm_monthly_revenue ................ [[31mERROR[0m in 0.19s]
[0m21:32:00.335899 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_monthly_revenue
[0m21:32:00.336899 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m21:32:00.338885 [info ] [Thread-1 (]: 2 of 15 START sql table model public.my_first_dbt_model ........................ [RUN]
[0m21:32:00.341399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_monthly_revenue, now model.prodia_dbt.my_first_dbt_model)
[0m21:32:00.342417 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m21:32:00.348438 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m21:32:00.350968 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 21:32:00.343419 => 21:32:00.350968
[0m21:32:00.353149 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m21:32:00.405817 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m21:32:00.407848 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:32:00.408847 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m21:32:00.409847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:00.481062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:00.482076 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:32:00.483583 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table "prodia_test"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:32:00.493104 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m21:32:00.507653 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:32:00.508655 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:32:00.510656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:00.518186 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:32:00.519182 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:32:00.521182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:00.574431 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m21:32:00.575948 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:32:00.577965 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m21:32:00.580991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:00.594520 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:32:00.596520 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists "prodia_test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:32:00.602611 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:00.606618 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 21:32:00.354143 => 21:32:00.605616
[0m21:32:00.608134 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m21:32:00.611170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BC7D8D0>]}
[0m21:32:00.613174 [info ] [Thread-1 (]: 2 of 15 OK created sql table model public.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.27s]
[0m21:32:00.616168 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m21:32:00.617169 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m21:32:00.619698 [info ] [Thread-1 (]: 3 of 15 START sql table model public.stg_appointments .......................... [RUN]
[0m21:32:00.622709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m21:32:00.623704 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m21:32:00.631227 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m21:32:00.635242 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 21:32:00.624706 => 21:32:00.633236
[0m21:32:00.636244 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m21:32:00.645795 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m21:32:00.648801 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:32:00.649801 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m21:32:00.652331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:00.722987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:00.723995 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:32:00.725507 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table "prodia_test"."public"."stg_appointments__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_appointments.sql



    select *
    from "prodia_test"."public"."appointments"

  );
  
[0m21:32:00.744146 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:32:00.750178 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:32:00.750701 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
alter table "prodia_test"."public"."stg_appointments__dbt_tmp" rename to "stg_appointments"
[0m21:32:00.752717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:00.757233 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m21:32:00.758249 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:32:00.759252 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m21:32:00.763265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:00.768791 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:32:00.770814 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
drop table if exists "prodia_test"."public"."stg_appointments__dbt_backup" cascade
[0m21:32:00.771812 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:00.775810 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 21:32:00.637240 => 21:32:00.775810
[0m21:32:00.776809 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m21:32:00.779325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BEAF7D0>]}
[0m21:32:00.781358 [info ] [Thread-1 (]: 3 of 15 OK created sql table model public.stg_appointments ..................... [[32mSELECT 1000[0m in 0.16s]
[0m21:32:00.784354 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m21:32:00.785352 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m21:32:00.787353 [info ] [Thread-1 (]: 4 of 15 START sql table model public.stg_doctors ............................... [RUN]
[0m21:32:00.789866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_doctors)
[0m21:32:00.790882 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m21:32:00.797892 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m21:32:00.800403 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 21:32:00.791897 => 21:32:00.800403
[0m21:32:00.802417 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m21:32:00.811696 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m21:32:00.813698 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:32:00.814701 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m21:32:00.816694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:00.885422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:00.886436 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:32:00.887453 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table "prodia_test"."public"."stg_doctors__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_doctors.sql



    select *
    from "prodia_test"."public"."doctors"

  );
  
[0m21:32:00.905113 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:32:00.912667 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:32:00.913771 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
alter table "prodia_test"."public"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m21:32:00.915658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:00.919203 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m21:32:00.920202 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:32:00.921202 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m21:32:00.923947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:00.929385 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:32:00.931415 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
drop table if exists "prodia_test"."public"."stg_doctors__dbt_backup" cascade
[0m21:32:00.932425 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:00.936415 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 21:32:00.803429 => 21:32:00.935415
[0m21:32:00.937426 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m21:32:00.939133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BEF3510>]}
[0m21:32:00.940149 [info ] [Thread-1 (]: 4 of 15 OK created sql table model public.stg_doctors .......................... [[32mSELECT 1000[0m in 0.15s]
[0m21:32:00.943162 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m21:32:00.945161 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_invoices
[0m21:32:00.946183 [info ] [Thread-1 (]: 5 of 15 START sql table model public.stg_invoices .............................. [RUN]
[0m21:32:00.949182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_invoices)
[0m21:32:00.949694 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_invoices
[0m21:32:00.957746 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_invoices"
[0m21:32:00.960278 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (compile): 21:32:00.950715 => 21:32:00.958755
[0m21:32:00.961300 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_invoices
[0m21:32:00.971882 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_invoices"
[0m21:32:00.973893 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:32:00.974864 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: BEGIN
[0m21:32:00.975861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:01.049398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:01.050926 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:32:01.051958 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */

  
    

  create  table "prodia_test"."public"."stg_invoices__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_billings.sql



    select *
    from "prodia_test"."public"."invoices"

  );
  
[0m21:32:01.064306 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:32:01.070996 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:32:01.071996 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
alter table "prodia_test"."public"."stg_invoices__dbt_tmp" rename to "stg_invoices"
[0m21:32:01.073969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:01.077919 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m21:32:01.079956 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:32:01.080957 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m21:32:01.083791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:01.089346 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:32:01.090337 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
drop table if exists "prodia_test"."public"."stg_invoices__dbt_backup" cascade
[0m21:32:01.091864 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:01.093895 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (execute): 21:32:00.962313 => 21:32:01.093895
[0m21:32:01.094907 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: Close
[0m21:32:01.096895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BEEBCD0>]}
[0m21:32:01.098443 [info ] [Thread-1 (]: 5 of 15 OK created sql table model public.stg_invoices ......................... [[32mSELECT 1000[0m in 0.15s]
[0m21:32:01.101462 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_invoices
[0m21:32:01.102477 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m21:32:01.104477 [info ] [Thread-1 (]: 6 of 15 START sql table model public.stg_patients .............................. [RUN]
[0m21:32:01.106466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_invoices, now model.prodia_dbt.stg_patients)
[0m21:32:01.107478 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m21:32:01.114944 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m21:32:01.116934 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 21:32:01.108477 => 21:32:01.116934
[0m21:32:01.118930 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m21:32:01.128088 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m21:32:01.130632 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:32:01.131677 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m21:32:01.132660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:01.200631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:01.202648 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:32:01.203649 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table "prodia_test"."public"."stg_patients__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_patients.sql



    select *
    from "prodia_test"."public"."patients"

  );
  
[0m21:32:01.214612 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:32:01.222195 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:32:01.223294 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
alter table "prodia_test"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m21:32:01.225168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:01.228726 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m21:32:01.229725 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:32:01.230736 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m21:32:01.234458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:01.241005 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:32:01.242006 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
drop table if exists "prodia_test"."public"."stg_patients__dbt_backup" cascade
[0m21:32:01.244007 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:01.247007 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 21:32:01.119931 => 21:32:01.246006
[0m21:32:01.248005 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m21:32:01.250550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BEF2950>]}
[0m21:32:01.255141 [info ] [Thread-1 (]: 6 of 15 OK created sql table model public.stg_patients ......................... [[32mSELECT 998[0m in 0.15s]
[0m21:32:01.258640 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m21:32:01.260655 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m21:32:01.261649 [info ] [Thread-1 (]: 7 of 15 START sql table model public.stg_procedures ............................ [RUN]
[0m21:32:01.264658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m21:32:01.266653 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m21:32:01.274213 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m21:32:01.277207 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 21:32:01.267659 => 21:32:01.277207
[0m21:32:01.279204 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m21:32:01.289764 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m21:32:01.292867 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:32:01.293886 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m21:32:01.295887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:01.368115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:01.369115 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:32:01.370116 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table "prodia_test"."public"."stg_procedures__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_procedures.sql



    select *
    from "prodia_test"."public"."procedures"

  );
  
[0m21:32:01.381208 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:32:01.387724 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:32:01.388735 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
alter table "prodia_test"."public"."stg_procedures__dbt_tmp" rename to "stg_procedures"
[0m21:32:01.390734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:01.394730 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m21:32:01.395728 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:32:01.397242 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m21:32:01.400262 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:01.406260 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:32:01.406260 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
drop table if exists "prodia_test"."public"."stg_procedures__dbt_backup" cascade
[0m21:32:01.408788 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:01.412784 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 21:32:01.280209 => 21:32:01.411782
[0m21:32:01.413784 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m21:32:01.415798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BEAF350>]}
[0m21:32:01.417793 [info ] [Thread-1 (]: 7 of 15 OK created sql table model public.stg_procedures ....................... [[32mSELECT 1000[0m in 0.15s]
[0m21:32:01.421344 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m21:32:01.423344 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m21:32:01.425341 [info ] [Thread-1 (]: 8 of 15 START sql view model public.my_second_dbt_model ........................ [RUN]
[0m21:32:01.428338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m21:32:01.429349 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m21:32:01.437534 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m21:32:01.440049 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 21:32:01.430517 => 21:32:01.438534
[0m21:32:01.441065 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m21:32:01.450592 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m21:32:01.453150 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:32:01.454151 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m21:32:01.455145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:01.527511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:01.529032 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:32:01.530069 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view "prodia_test"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "prodia_test"."public"."my_first_dbt_model"
where id = 1
  );
[0m21:32:01.541184 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:32:01.547719 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:32:01.549712 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
alter table "prodia_test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:32:01.551717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:01.554769 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m21:32:01.555771 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:32:01.557285 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m21:32:01.559305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:01.567809 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:32:01.569831 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists "prodia_test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m21:32:01.571827 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:32:01.574846 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 21:32:01.442064 => 21:32:01.573821
[0m21:32:01.575837 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m21:32:01.578832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BF12AD0>]}
[0m21:32:01.580083 [info ] [Thread-1 (]: 8 of 15 OK created sql view model public.my_second_dbt_model ................... [[32mCREATE VIEW[0m in 0.15s]
[0m21:32:01.583094 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m21:32:01.585093 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m21:32:01.587094 [info ] [Thread-1 (]: 9 of 15 START sql table model public.int_invoice_summary ....................... [RUN]
[0m21:32:01.589110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_second_dbt_model, now model.prodia_dbt.int_invoice_summary)
[0m21:32:01.590479 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_invoice_summary
[0m21:32:01.598480 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_invoice_summary"
[0m21:32:01.602027 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (compile): 21:32:01.592486 => 21:32:01.601028
[0m21:32:01.603027 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_invoice_summary
[0m21:32:01.612572 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_invoice_summary"
[0m21:32:01.614569 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:32:01.616556 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: BEGIN
[0m21:32:01.617561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:01.688236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:01.689233 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:32:01.690223 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */

  
    

  create  table "prodia_test"."public"."int_invoice_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_invoice_summary.sql



with invoice_summary as (
    select
        i.InvoiceID,
        i.PatientID,
        sum(i.Amount) as total_amount,
        count(i.Items) as item_count
    from
        "prodia_test"."public"."stg_invoices" i
    group by
        i.InvoiceID,
        i.PatientID
), invoice_segment as (
    select 
        *,
        CASE
            WHEN total_amount > 1000 THEN 'High Spender'
            WHEN total_appointments > 10 THEN 'Frequent User'
            ELSE 'Occasional User'
        END AS customer_segment 
        from invoice_summary
)

select * from invoice_segment
  );
  
[0m21:32:01.694231 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "total_appointments" does not exist
LINE 32:             WHEN total_appointments > 10 THEN 'Frequent User...
                          ^

[0m21:32:01.695223 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: ROLLBACK
[0m21:32:01.698741 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (execute): 21:32:01.604031 => 21:32:01.697748
[0m21:32:01.699737 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: Close
[0m21:32:01.705743 [debug] [Thread-1 (]: Database Error in model int_invoice_summary (models\intermediate\int_invoice_summary.sql)
  column "total_appointments" does not exist
  LINE 32:             WHEN total_appointments > 10 THEN 'Frequent User...
                            ^
  compiled Code at target\run\prodia_dbt\models\intermediate\int_invoice_summary.sql
[0m21:32:01.707257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BC5D590>]}
[0m21:32:01.708267 [error] [Thread-1 (]: 9 of 15 ERROR creating sql table model public.int_invoice_summary .............. [[31mERROR[0m in 0.12s]
[0m21:32:01.710672 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m21:32:01.711681 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m21:32:01.713681 [info ] [Thread-1 (]: 10 of 15 START sql table model public.int_patient_summary ...................... [RUN]
[0m21:32:01.715653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_invoice_summary, now model.prodia_dbt.int_patient_summary)
[0m21:32:01.717186 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_patient_summary
[0m21:32:01.724203 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_patient_summary"
[0m21:32:01.726287 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (compile): 21:32:01.718217 => 21:32:01.726287
[0m21:32:01.727802 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_patient_summary
[0m21:32:01.736820 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_patient_summary"
[0m21:32:01.739318 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:32:01.740331 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: BEGIN
[0m21:32:01.741333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:01.809216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:01.811214 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:32:01.812224 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */

  
    

  create  table "prodia_test"."public"."int_patient_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_patient_summary.sql


with patient_appointments as (
    select
        p.PatientID,
        p.firstname,
        p.lastname,
        count(a.AppointmentID) as total_appointments
    from
        "prodia_test"."public"."stg_patients" p
    left join
        "prodia_test"."public"."stg_appointments" a on p.PatientID = a.PatientID
    group by
        p.PatientID,
        p.firstname,
        p.lastname
)

select * from patient_appointments
  );
  
[0m21:32:01.826309 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:32:01.833316 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:32:01.833316 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
alter table "prodia_test"."public"."int_patient_summary__dbt_tmp" rename to "int_patient_summary"
[0m21:32:01.835887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:01.839899 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m21:32:01.840901 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:32:01.841889 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m21:32:01.844549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:01.850569 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:32:01.850569 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
drop table if exists "prodia_test"."public"."int_patient_summary__dbt_backup" cascade
[0m21:32:01.853095 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:01.856625 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (execute): 21:32:01.728811 => 21:32:01.856625
[0m21:32:01.857648 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: Close
[0m21:32:01.859633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BC2AE90>]}
[0m21:32:01.860635 [info ] [Thread-1 (]: 10 of 15 OK created sql table model public.int_patient_summary ................. [[32mSELECT 998[0m in 0.14s]
[0m21:32:01.863640 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m21:32:01.864629 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m21:32:01.866626 [info ] [Thread-1 (]: 11 of 15 START sql table model public.int_appointment_details .................. [RUN]
[0m21:32:01.869167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_patient_summary, now model.prodia_dbt.int_appointment_details)
[0m21:32:01.870162 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_appointment_details
[0m21:32:01.878668 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_appointment_details"
[0m21:32:01.881670 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (compile): 21:32:01.871143 => 21:32:01.880669
[0m21:32:01.882664 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_appointment_details
[0m21:32:01.891264 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_appointment_details"
[0m21:32:01.893507 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:32:01.895520 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: BEGIN
[0m21:32:01.896520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:01.963615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:01.965621 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:32:01.966633 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */

  
    

  create  table "prodia_test"."public"."int_appointment_details__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_appointment_details.sql



with appointment_info as (
    select
        a.AppointmentID,
        a.AppointmentDate,
        a.AppointmentTime,
        p.PatientID,
        concat(p.firstname, ' ', p.lastname) as patient_name,
        d.DoctorName,
        pr.ProcedureName,
        case when a.AppointmentDate < CURRENT_DATE then 1 else 0 end as is_overdue
    from
        "prodia_test"."public"."stg_appointments" a
    join
        "prodia_test"."public"."stg_patients" p on a.PatientID = p.PatientID
    join
        "prodia_test"."public"."stg_doctors" d on a.DoctorID = d.DoctorID
    left join
        "prodia_test"."public"."stg_procedures" pr on a.AppointmentID = pr.AppointmentID
)

select * from appointment_info
  );
  
[0m21:32:01.988738 [debug] [Thread-1 (]: SQL status: SELECT 1367 in 0.0 seconds
[0m21:32:01.995260 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:32:01.996265 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
alter table "prodia_test"."public"."int_appointment_details__dbt_tmp" rename to "int_appointment_details"
[0m21:32:01.998278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:02.002279 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m21:32:02.003272 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:32:02.004274 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m21:32:02.006807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:02.012814 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:32:02.013849 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
drop table if exists "prodia_test"."public"."int_appointment_details__dbt_backup" cascade
[0m21:32:02.015850 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:02.019399 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (execute): 21:32:01.883666 => 21:32:02.018388
[0m21:32:02.020385 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: Close
[0m21:32:02.022376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BC2AE90>]}
[0m21:32:02.023376 [info ] [Thread-1 (]: 11 of 15 OK created sql table model public.int_appointment_details ............. [[32mSELECT 1367[0m in 0.15s]
[0m21:32:02.025373 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m21:32:02.027908 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m21:32:02.029923 [info ] [Thread-1 (]: 12 of 15 SKIP relation public.dm_patient_overview .............................. [[33mSKIP[0m]
[0m21:32:02.031908 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m21:32:02.032917 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m21:32:02.034905 [info ] [Thread-1 (]: 13 of 15 START sql table model public.dm_appointment_summary ................... [RUN]
[0m21:32:02.037295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_appointment_details, now model.prodia_dbt.dm_appointment_summary)
[0m21:32:02.038327 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_appointment_summary
[0m21:32:02.048870 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_appointment_summary"
[0m21:32:02.054426 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (compile): 21:32:02.039308 => 21:32:02.053427
[0m21:32:02.056428 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_appointment_summary
[0m21:32:02.063434 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_appointment_summary"
[0m21:32:02.066437 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:32:02.068432 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: BEGIN
[0m21:32:02.069437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:02.136910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:02.137909 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:32:02.138910 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

  
    

  create  table "prodia_test"."public"."dm_appointment_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_appointment_summary.sql



with appointment_summary as (
    select
        ad.AppointmentDate,
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        COUNT(DISTINCT ad.ProcedureName) AS total_procedures
    from
        "prodia_test"."public"."int_appointment_details" ad
    group by
        ad.AppointmentDate, 
        ad.DoctorName
)

select * from appointment_summary
  );
  
[0m21:32:02.157112 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m21:32:02.165636 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:32:02.166668 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
alter table "prodia_test"."public"."dm_appointment_summary__dbt_tmp" rename to "dm_appointment_summary"
[0m21:32:02.168670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:02.172658 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m21:32:02.173670 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:32:02.174670 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m21:32:02.178480 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:02.184678 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:32:02.186656 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
drop table if exists "prodia_test"."public"."dm_appointment_summary__dbt_backup" cascade
[0m21:32:02.188192 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:02.191188 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (execute): 21:32:02.056428 => 21:32:02.191188
[0m21:32:02.192198 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: Close
[0m21:32:02.194186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BBFF190>]}
[0m21:32:02.196189 [info ] [Thread-1 (]: 13 of 15 OK created sql table model public.dm_appointment_summary .............. [[32mSELECT 999[0m in 0.16s]
[0m21:32:02.198431 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m21:32:02.200425 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_cohort_analysis
[0m21:32:02.201440 [info ] [Thread-1 (]: 14 of 15 START sql table model public.dm_cohort_analysis ....................... [RUN]
[0m21:32:02.204439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_appointment_summary, now model.prodia_dbt.dm_cohort_analysis)
[0m21:32:02.205447 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_cohort_analysis
[0m21:32:02.211482 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_cohort_analysis"
[0m21:32:02.214503 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_cohort_analysis (compile): 21:32:02.206427 => 21:32:02.213504
[0m21:32:02.215512 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_cohort_analysis
[0m21:32:02.225666 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_cohort_analysis"
[0m21:32:02.227671 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:32:02.229190 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: BEGIN
[0m21:32:02.230207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:02.300014 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:02.303031 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:32:02.306103 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_cohort_analysis"} */

  
    

  create  table "prodia_test"."public"."dm_cohort_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_cohort_analysis.sql



with cohort_analysis as (
    select 
        DATE_TRUNC('month', MIN(AppointmentDate)) AS cohort_month,
        COUNT(DISTINCT PatientID) AS patients_in_cohort,
    from
        "prodia_test"."public"."int_appointment_details"
    group by
        cohort_month  
)

select * from cohort_analysis
  );
  
[0m21:32:02.308121 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 20:     from
             ^

[0m21:32:02.310124 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: ROLLBACK
[0m21:32:02.312126 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_cohort_analysis (execute): 21:32:02.215512 => 21:32:02.311123
[0m21:32:02.313125 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: Close
[0m21:32:02.319206 [debug] [Thread-1 (]: Database Error in model dm_cohort_analysis (models\datamart\dm_cohort_analysis.sql)
  syntax error at or near "from"
  LINE 20:     from
               ^
  compiled Code at target\run\prodia_dbt\models\datamart\dm_cohort_analysis.sql
[0m21:32:02.320225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9bbe5b9-b326-4def-bc10-d0cf9ddc07fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BF31510>]}
[0m21:32:02.321225 [error] [Thread-1 (]: 14 of 15 ERROR creating sql table model public.dm_cohort_analysis .............. [[31mERROR[0m in 0.12s]
[0m21:32:02.324226 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_cohort_analysis
[0m21:32:02.325750 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_doctor_performance
[0m21:32:02.326757 [info ] [Thread-1 (]: 15 of 15 SKIP relation public.dm_doctor_performance ............................ [[33mSKIP[0m]
[0m21:32:02.328757 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_doctor_performance
[0m21:32:02.332757 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:02.333757 [debug] [MainThread]: On master: BEGIN
[0m21:32:02.334766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:02.405342 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:32:02.406343 [debug] [MainThread]: On master: COMMIT
[0m21:32:02.407358 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:02.407358 [debug] [MainThread]: On master: COMMIT
[0m21:32:02.409346 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:32:02.409346 [debug] [MainThread]: On master: Close
[0m21:32:02.411875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:02.412863 [debug] [MainThread]: Connection 'list_prodia_test' was properly closed.
[0m21:32:02.413864 [debug] [MainThread]: Connection 'list_prodia_test_public' was properly closed.
[0m21:32:02.414866 [debug] [MainThread]: Connection 'model.prodia_dbt.dm_cohort_analysis' was properly closed.
[0m21:32:02.415866 [info ] [MainThread]: 
[0m21:32:02.417866 [info ] [MainThread]: Finished running 2 view models, 13 table models in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m21:32:02.425411 [debug] [MainThread]: Command end result
[0m21:32:02.443501 [info ] [MainThread]: 
[0m21:32:02.445514 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m21:32:02.447510 [info ] [MainThread]: 
[0m21:32:02.448508 [error] [MainThread]: [33mDatabase Error in model dm_monthly_revenue (models\datamart\dm_monthly_revenue.sql)[0m
[0m21:32:02.450490 [error] [MainThread]:   syntax error at or near "CREATE"
[0m21:32:02.451490 [error] [MainThread]:   LINE 7:     CREATE TABLE datamart.monthly_trends AS
[0m21:32:02.453626 [error] [MainThread]:               ^
[0m21:32:02.455645 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_monthly_revenue.sql
[0m21:32:02.457643 [info ] [MainThread]: 
[0m21:32:02.459660 [error] [MainThread]: [33mDatabase Error in model int_invoice_summary (models\intermediate\int_invoice_summary.sql)[0m
[0m21:32:02.460654 [error] [MainThread]:   column "total_appointments" does not exist
[0m21:32:02.462648 [error] [MainThread]:   LINE 32:             WHEN total_appointments > 10 THEN 'Frequent User...
[0m21:32:02.462648 [error] [MainThread]:                             ^
[0m21:32:02.465167 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\intermediate\int_invoice_summary.sql
[0m21:32:02.466176 [info ] [MainThread]: 
[0m21:32:02.468171 [error] [MainThread]: [33mDatabase Error in model dm_cohort_analysis (models\datamart\dm_cohort_analysis.sql)[0m
[0m21:32:02.470177 [error] [MainThread]:   syntax error at or near "from"
[0m21:32:02.472173 [error] [MainThread]:   LINE 20:     from
[0m21:32:02.473175 [error] [MainThread]:                ^
[0m21:32:02.475713 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_cohort_analysis.sql
[0m21:32:02.477710 [info ] [MainThread]: 
[0m21:32:02.479716 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=3 SKIP=2 TOTAL=15
[0m21:32:02.482711 [debug] [MainThread]: Command `dbt run` failed at 21:32:02.481710 after 5.22 seconds
[0m21:32:02.483705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A344E60B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A344E60990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34BAFB090>]}
[0m21:32:02.485222 [debug] [MainThread]: Flushing usage events
[0m21:37:33.717442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C0CDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C0CE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C0CF1D0>]}


============================== 21:37:33.722674 | b287859e-e939-4e54-9c72-30aa54bfce60 ==============================
[0m21:37:33.722674 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:37:33.725195 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m21:37:33.966558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152270A5250>]}
[0m21:37:34.008313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152270A5250>]}
[0m21:37:34.033384 [debug] [MainThread]: checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, vars: {}, profile: , target: postgres, version: 1.5.0
[0m21:37:34.126307 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:37:34.128004 [debug] [MainThread]: previous checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m21:37:34.129047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C2930D0>]}
[0m21:37:35.664528 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m21:37:35.693076 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_cohort_analysis.sql
[0m21:37:35.701060 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_doctor_performance.sql
[0m21:37:35.709217 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_monthly_revenue.sql
[0m21:37:35.716815 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m21:37:35.724306 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m21:37:35.731317 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m21:37:35.739148 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m21:37:35.746708 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m21:37:35.754361 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m21:37:35.761901 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m21:37:35.773933 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m21:37:35.779451 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m21:37:35.788568 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m21:37:35.793577 [debug] [MainThread]: 1603: static parser failed on staging\stg_invoices.sql
[0m21:37:35.803147 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_invoices.sql
[0m21:37:35.807288 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m21:37:35.816841 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m21:37:35.821058 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m21:37:35.831275 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m21:37:36.172070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C36CE10>]}
[0m21:37:36.190613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C35E250>]}
[0m21:37:36.192128 [info ] [MainThread]: Found 15 models, 4 tests, 0 snapshots, 0 analyses, 318 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m21:37:36.194174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C38FDD0>]}
[0m21:37:36.199172 [info ] [MainThread]: 
[0m21:37:36.201176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:37:36.205723 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test'
[0m21:37:36.229268 [debug] [ThreadPool]: Using postgres connection "list_prodia_test"
[0m21:37:36.230257 [debug] [ThreadPool]: On list_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test"} */

    select distinct nspname from pg_namespace
  
[0m21:37:36.231258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:36.418081 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:37:36.422067 [debug] [ThreadPool]: On list_prodia_test: Close
[0m21:37:36.427599 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test_public'
[0m21:37:36.440119 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m21:37:36.441119 [debug] [ThreadPool]: On list_prodia_test_public: BEGIN
[0m21:37:36.441119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:36.507619 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:37:36.508608 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m21:37:36.509617 [debug] [ThreadPool]: On list_prodia_test_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test_public"} */
select
      'prodia_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'prodia_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:37:36.521158 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m21:37:36.525732 [debug] [ThreadPool]: On list_prodia_test_public: ROLLBACK
[0m21:37:36.526742 [debug] [ThreadPool]: On list_prodia_test_public: Close
[0m21:37:36.543781 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:36.545813 [debug] [MainThread]: On master: BEGIN
[0m21:37:36.545813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:36.611692 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:37:36.612710 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:36.613721 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:37:36.643427 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:37:36.646467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C38FB10>]}
[0m21:37:36.647469 [debug] [MainThread]: On master: ROLLBACK
[0m21:37:36.648681 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:36.649468 [debug] [MainThread]: On master: BEGIN
[0m21:37:36.650834 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:37:36.651834 [debug] [MainThread]: On master: COMMIT
[0m21:37:36.652826 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:36.653824 [debug] [MainThread]: On master: COMMIT
[0m21:37:36.655013 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:37:36.655834 [debug] [MainThread]: On master: Close
[0m21:37:36.657830 [info ] [MainThread]: Concurrency: 1 threads (target='postgres')
[0m21:37:36.659808 [info ] [MainThread]: 
[0m21:37:36.671829 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m21:37:36.673114 [info ] [Thread-1 (]: 1 of 15 START sql table model public.my_first_dbt_model ........................ [RUN]
[0m21:37:36.676113 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.prodia_dbt.my_first_dbt_model'
[0m21:37:36.677111 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m21:37:36.683672 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m21:37:36.685684 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 21:37:36.678111 => 21:37:36.685684
[0m21:37:36.687664 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m21:37:36.779143 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m21:37:36.782149 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:37:36.784170 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m21:37:36.785183 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:37:36.852605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:36.853605 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:37:36.854728 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table "prodia_test"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:37:36.863798 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m21:37:36.883526 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:37:36.886199 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:37:36.888235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:36.894062 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:37:36.895062 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:37:36.897565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:36.948307 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m21:37:36.950054 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:37:36.951090 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m21:37:36.955064 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:36.967549 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:37:36.968549 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists "prodia_test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:37:36.975518 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:36.979283 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 21:37:36.688658 => 21:37:36.978280
[0m21:37:36.980271 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m21:37:36.982799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C230490>]}
[0m21:37:36.984815 [info ] [Thread-1 (]: 1 of 15 OK created sql table model public.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.31s]
[0m21:37:36.987837 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m21:37:36.989842 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m21:37:36.990814 [info ] [Thread-1 (]: 2 of 15 START sql table model public.stg_appointments .......................... [RUN]
[0m21:37:36.994374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m21:37:36.996363 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m21:37:37.002911 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m21:37:37.005957 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 21:37:36.997378 => 21:37:37.004957
[0m21:37:37.007963 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m21:37:37.018500 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m21:37:37.020500 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:37:37.021503 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m21:37:37.022503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:37.091345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:37.092324 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:37:37.094320 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table "prodia_test"."public"."stg_appointments__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_appointments.sql



    select *
    from "prodia_test"."public"."appointments"

  );
  
[0m21:37:37.107876 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:37:37.115425 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:37:37.116426 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
alter table "prodia_test"."public"."stg_appointments" rename to "stg_appointments__dbt_backup"
[0m21:37:37.118433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:37.125991 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:37:37.127992 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
alter table "prodia_test"."public"."stg_appointments__dbt_tmp" rename to "stg_appointments"
[0m21:37:37.130495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:37.134525 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m21:37:37.136526 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:37:37.137536 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m21:37:37.146112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:37.153614 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:37:37.154615 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
drop table if exists "prodia_test"."public"."stg_appointments__dbt_backup" cascade
[0m21:37:37.160143 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:37.163667 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 21:37:37.008929 => 21:37:37.163667
[0m21:37:37.165667 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m21:37:37.168180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C172F50>]}
[0m21:37:37.169184 [info ] [Thread-1 (]: 2 of 15 OK created sql table model public.stg_appointments ..................... [[32mSELECT 1000[0m in 0.17s]
[0m21:37:37.173188 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m21:37:37.175289 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m21:37:37.177287 [info ] [Thread-1 (]: 3 of 15 START sql table model public.stg_doctors ............................... [RUN]
[0m21:37:37.180292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_doctors)
[0m21:37:37.182287 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m21:37:37.191473 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m21:37:37.194487 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 21:37:37.183286 => 21:37:37.193488
[0m21:37:37.196023 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m21:37:37.207534 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m21:37:37.210550 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:37:37.212549 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m21:37:37.213545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:37.285877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:37.287867 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:37:37.288867 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table "prodia_test"."public"."stg_doctors__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_doctors.sql



    select *
    from "prodia_test"."public"."doctors"

  );
  
[0m21:37:37.305568 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:37:37.313094 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:37:37.314097 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
alter table "prodia_test"."public"."stg_doctors" rename to "stg_doctors__dbt_backup"
[0m21:37:37.316102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:37.322602 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:37:37.324644 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
alter table "prodia_test"."public"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m21:37:37.326622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:37.330613 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m21:37:37.331615 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:37:37.333132 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m21:37:37.336092 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:37.341132 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:37:37.343126 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
drop table if exists "prodia_test"."public"."stg_doctors__dbt_backup" cascade
[0m21:37:37.350223 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:37.353223 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 21:37:37.197022 => 21:37:37.353223
[0m21:37:37.355784 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m21:37:37.357798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C40B950>]}
[0m21:37:37.360823 [info ] [Thread-1 (]: 3 of 15 OK created sql table model public.stg_doctors .......................... [[32mSELECT 1000[0m in 0.18s]
[0m21:37:37.363788 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m21:37:37.365898 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_invoices
[0m21:37:37.367927 [info ] [Thread-1 (]: 4 of 15 START sql table model public.stg_invoices .............................. [RUN]
[0m21:37:37.370938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_invoices)
[0m21:37:37.372933 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_invoices
[0m21:37:37.380433 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_invoices"
[0m21:37:37.383433 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (compile): 21:37:37.373920 => 21:37:37.382445
[0m21:37:37.384437 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_invoices
[0m21:37:37.403537 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_invoices"
[0m21:37:37.406541 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:37:37.408050 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: BEGIN
[0m21:37:37.409432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:37.475282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:37.477290 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:37:37.478280 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */

  
    

  create  table "prodia_test"."public"."stg_invoices__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_billings.sql



    select *
    from "prodia_test"."public"."invoices"

  );
  
[0m21:37:37.489855 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:37:37.499429 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:37:37.501430 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
alter table "prodia_test"."public"."stg_invoices" rename to "stg_invoices__dbt_backup"
[0m21:37:37.503956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:37.511998 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:37:37.512984 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
alter table "prodia_test"."public"."stg_invoices__dbt_tmp" rename to "stg_invoices"
[0m21:37:37.515525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:37.521527 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m21:37:37.522554 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:37:37.523554 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m21:37:37.527048 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:37.533049 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:37:37.534047 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
drop table if exists "prodia_test"."public"."stg_invoices__dbt_backup" cascade
[0m21:37:37.540218 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:37.544218 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (execute): 21:37:37.385439 => 21:37:37.544218
[0m21:37:37.545215 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: Close
[0m21:37:37.549794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C44D590>]}
[0m21:37:37.550788 [info ] [Thread-1 (]: 4 of 15 OK created sql table model public.stg_invoices ......................... [[32mSELECT 1000[0m in 0.18s]
[0m21:37:37.554789 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_invoices
[0m21:37:37.555787 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m21:37:37.558329 [info ] [Thread-1 (]: 5 of 15 START sql table model public.stg_patients .............................. [RUN]
[0m21:37:37.560331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_invoices, now model.prodia_dbt.stg_patients)
[0m21:37:37.562339 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m21:37:37.570382 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m21:37:37.573397 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 21:37:37.564329 => 21:37:37.572395
[0m21:37:37.574393 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m21:37:37.585389 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m21:37:37.587392 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:37:37.588394 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m21:37:37.589902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:37.661578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:37.662579 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:37:37.664095 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table "prodia_test"."public"."stg_patients__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_patients.sql



    select *
    from "prodia_test"."public"."patients"

  );
  
[0m21:37:37.676101 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:37:37.683116 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:37:37.684117 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
alter table "prodia_test"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m21:37:37.686696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:37.693696 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:37:37.694696 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
alter table "prodia_test"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m21:37:37.697229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:37.702259 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m21:37:37.704247 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:37:37.705260 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m21:37:37.707831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:37.713841 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:37:37.714841 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
drop table if exists "prodia_test"."public"."stg_patients__dbt_backup" cascade
[0m21:37:37.721412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:37.724420 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 21:37:37.575820 => 21:37:37.724420
[0m21:37:37.726397 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m21:37:37.728928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C436ED0>]}
[0m21:37:37.730928 [info ] [Thread-1 (]: 5 of 15 OK created sql table model public.stg_patients ......................... [[32mSELECT 998[0m in 0.17s]
[0m21:37:37.733945 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m21:37:37.735929 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m21:37:37.737944 [info ] [Thread-1 (]: 6 of 15 START sql table model public.stg_procedures ............................ [RUN]
[0m21:37:37.740656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m21:37:37.741659 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m21:37:37.750191 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m21:37:37.753190 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 21:37:37.742653 => 21:37:37.752202
[0m21:37:37.754205 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m21:37:37.763723 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m21:37:37.767246 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:37:37.769261 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m21:37:37.770773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:37.840250 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:37.841880 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:37:37.842880 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table "prodia_test"."public"."stg_procedures__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_procedures.sql



    select *
    from "prodia_test"."public"."procedures"

  );
  
[0m21:37:37.854226 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:37:37.861778 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:37:37.862779 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
alter table "prodia_test"."public"."stg_procedures" rename to "stg_procedures__dbt_backup"
[0m21:37:37.864795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:37.871311 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:37:37.872312 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
alter table "prodia_test"."public"."stg_procedures__dbt_tmp" rename to "stg_procedures"
[0m21:37:37.874318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:37.880857 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m21:37:37.881859 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:37:37.882858 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m21:37:37.885905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:37.892431 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:37:37.893432 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
drop table if exists "prodia_test"."public"."stg_procedures__dbt_backup" cascade
[0m21:37:37.898758 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:37.901789 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 21:37:37.755186 => 21:37:37.901789
[0m21:37:37.903799 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m21:37:37.910362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C35DF90>]}
[0m21:37:37.918384 [info ] [Thread-1 (]: 6 of 15 OK created sql table model public.stg_procedures ....................... [[32mSELECT 1000[0m in 0.17s]
[0m21:37:37.921488 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m21:37:37.922517 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m21:37:37.923529 [info ] [Thread-1 (]: 7 of 15 START sql view model public.my_second_dbt_model ........................ [RUN]
[0m21:37:37.926716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m21:37:37.928703 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m21:37:37.935284 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m21:37:37.938264 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 21:37:37.929713 => 21:37:37.937263
[0m21:37:37.939264 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m21:37:37.989811 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m21:37:37.993817 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:37:37.995330 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m21:37:37.996966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:38.064582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:38.065581 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:37:38.066593 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view "prodia_test"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "prodia_test"."public"."my_first_dbt_model"
where id = 1
  );
[0m21:37:38.075444 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:37:38.084010 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:37:38.087020 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
alter table "prodia_test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:37:38.089020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:38.094808 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m21:37:38.096781 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:37:38.098781 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m21:37:38.101319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:38.108361 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:37:38.110363 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists "prodia_test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m21:37:38.111907 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:37:38.116954 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 21:37:37.940276 => 21:37:38.116954
[0m21:37:38.117954 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m21:37:38.120942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C345590>]}
[0m21:37:38.122923 [info ] [Thread-1 (]: 7 of 15 OK created sql view model public.my_second_dbt_model ................... [[32mCREATE VIEW[0m in 0.20s]
[0m21:37:38.126027 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m21:37:38.128043 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m21:37:38.129039 [info ] [Thread-1 (]: 8 of 15 START sql table model public.int_invoice_summary ....................... [RUN]
[0m21:37:38.132044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_second_dbt_model, now model.prodia_dbt.int_invoice_summary)
[0m21:37:38.134597 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_invoice_summary
[0m21:37:38.144152 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_invoice_summary"
[0m21:37:38.148173 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (compile): 21:37:38.136599 => 21:37:38.147169
[0m21:37:38.149173 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_invoice_summary
[0m21:37:38.162736 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_invoice_summary"
[0m21:37:38.171891 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:37:38.172890 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: BEGIN
[0m21:37:38.174896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:38.242126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:38.244145 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:37:38.245157 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */

  
    

  create  table "prodia_test"."public"."int_invoice_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_invoice_summary.sql



with invoice_summary as (
    select
        i.InvoiceID,
        i.PatientID,
        sum(i.Amount) as total_amount,
        count(i.Items) as item_count
    from
        "prodia_test"."public"."stg_invoices" i
    group by
        i.InvoiceID,
        i.PatientID
)

select * from invoice_summary
  );
  
[0m21:37:38.263715 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:37:38.272301 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:37:38.273442 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */
alter table "prodia_test"."public"."int_invoice_summary__dbt_tmp" rename to "int_invoice_summary"
[0m21:37:38.276427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:38.281429 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m21:37:38.283985 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:37:38.285005 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m21:37:38.288997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:38.297574 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:37:38.299572 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */
drop table if exists "prodia_test"."public"."int_invoice_summary__dbt_backup" cascade
[0m21:37:38.301562 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:38.305156 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (execute): 21:37:38.150175 => 21:37:38.304111
[0m21:37:38.306146 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: Close
[0m21:37:38.308131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C475250>]}
[0m21:37:38.310125 [info ] [Thread-1 (]: 8 of 15 OK created sql table model public.int_invoice_summary .................. [[32mSELECT 1000[0m in 0.18s]
[0m21:37:38.313125 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m21:37:38.314639 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m21:37:38.316672 [info ] [Thread-1 (]: 9 of 15 START sql table model public.int_patient_summary ....................... [RUN]
[0m21:37:38.319681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_invoice_summary, now model.prodia_dbt.int_patient_summary)
[0m21:37:38.320681 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_patient_summary
[0m21:37:38.329366 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_patient_summary"
[0m21:37:38.332249 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (compile): 21:37:38.321679 => 21:37:38.331263
[0m21:37:38.334261 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_patient_summary
[0m21:37:38.342353 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_patient_summary"
[0m21:37:38.345356 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:37:38.346896 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: BEGIN
[0m21:37:38.347941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:38.421301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:38.421817 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:37:38.423851 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */

  
    

  create  table "prodia_test"."public"."int_patient_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_patient_summary.sql


with patient_appointments as (
    select
        p.PatientID,
        p.firstname,
        p.lastname,
        count(a.AppointmentID) as total_appointments
    from
        "prodia_test"."public"."stg_patients" p
    left join
        "prodia_test"."public"."stg_appointments" a on p.PatientID = a.PatientID
    group by
        p.PatientID,
        p.firstname,
        p.lastname
)

select * from patient_appointments
  );
  
[0m21:37:38.440001 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:37:38.446738 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:37:38.447875 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
alter table "prodia_test"."public"."int_patient_summary" rename to "int_patient_summary__dbt_backup"
[0m21:37:38.449739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:38.456323 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:37:38.457314 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
alter table "prodia_test"."public"."int_patient_summary__dbt_tmp" rename to "int_patient_summary"
[0m21:37:38.460324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:38.465881 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m21:37:38.467879 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:37:38.469405 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m21:37:38.472413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:38.479004 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:37:38.479977 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
drop table if exists "prodia_test"."public"."int_patient_summary__dbt_backup" cascade
[0m21:37:38.485514 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:38.489558 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (execute): 21:37:38.335261 => 21:37:38.488559
[0m21:37:38.490558 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: Close
[0m21:37:38.492546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C428950>]}
[0m21:37:38.494558 [info ] [Thread-1 (]: 9 of 15 OK created sql table model public.int_patient_summary .................. [[32mSELECT 998[0m in 0.17s]
[0m21:37:38.497087 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m21:37:38.499103 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m21:37:38.501112 [info ] [Thread-1 (]: 10 of 15 START sql table model public.int_appointment_details .................. [RUN]
[0m21:37:38.504105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_patient_summary, now model.prodia_dbt.int_appointment_details)
[0m21:37:38.505103 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_appointment_details
[0m21:37:38.514672 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_appointment_details"
[0m21:37:38.518248 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (compile): 21:37:38.506631 => 21:37:38.517202
[0m21:37:38.519252 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_appointment_details
[0m21:37:38.529787 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_appointment_details"
[0m21:37:38.532775 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:37:38.533774 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: BEGIN
[0m21:37:38.535762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:38.601462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:38.602992 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:37:38.604015 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */

  
    

  create  table "prodia_test"."public"."int_appointment_details__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_appointment_details.sql



with appointment_info as (
    select
        a.AppointmentID,
        a.AppointmentDate,
        a.AppointmentTime,
        p.PatientID,
        concat(p.firstname, ' ', p.lastname) as patient_name,
        d.DoctorName,
        pr.ProcedureName,
        case when a.AppointmentDate < CURRENT_DATE then 1 else 0 end as is_overdue
    from
        "prodia_test"."public"."stg_appointments" a
    join
        "prodia_test"."public"."stg_patients" p on a.PatientID = p.PatientID
    join
        "prodia_test"."public"."stg_doctors" d on a.DoctorID = d.DoctorID
    left join
        "prodia_test"."public"."stg_procedures" pr on a.AppointmentID = pr.AppointmentID
)

select * from appointment_info
  );
  
[0m21:37:38.628736 [debug] [Thread-1 (]: SQL status: SELECT 1367 in 0.0 seconds
[0m21:37:38.634642 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:37:38.636190 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
alter table "prodia_test"."public"."int_appointment_details" rename to "int_appointment_details__dbt_backup"
[0m21:37:38.638168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:38.645190 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:37:38.645709 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
alter table "prodia_test"."public"."int_appointment_details__dbt_tmp" rename to "int_appointment_details"
[0m21:37:38.648744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:38.653740 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m21:37:38.654740 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:37:38.654740 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m21:37:38.659292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:38.665319 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:37:38.667059 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
drop table if exists "prodia_test"."public"."int_appointment_details__dbt_backup" cascade
[0m21:37:38.675211 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:38.686778 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (execute): 21:37:38.520237 => 21:37:38.686778
[0m21:37:38.688296 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: Close
[0m21:37:38.690313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C2598D0>]}
[0m21:37:38.691821 [info ] [Thread-1 (]: 10 of 15 OK created sql table model public.int_appointment_details ............. [[32mSELECT 1367[0m in 0.19s]
[0m21:37:38.693950 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m21:37:38.695948 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m21:37:38.697947 [info ] [Thread-1 (]: 11 of 15 START sql table model public.dm_patient_overview ...................... [RUN]
[0m21:37:38.701504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_appointment_details, now model.prodia_dbt.dm_patient_overview)
[0m21:37:38.702504 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_patient_overview
[0m21:37:38.711850 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_patient_overview"
[0m21:37:38.715860 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (compile): 21:37:38.703504 => 21:37:38.714860
[0m21:37:38.716850 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_patient_overview
[0m21:37:38.726401 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_patient_overview"
[0m21:37:38.729552 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:37:38.731073 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: BEGIN
[0m21:37:38.733118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:38.800903 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:38.802887 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:37:38.803875 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */

  
    

  create  table "prodia_test"."public"."dm_patient_overview__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_patient_overview.sql



with patient_overview as (
    select
        ps.PatientID,
        ps.firstname,
        ps.lastname,
        SUM(ps.total_appointments) as total_appointments,
        COALESCE(SUM(ins.total_amount), 0) AS total_spent
    from
        "prodia_test"."public"."int_patient_summary" ps
    left join
        "prodia_test"."public"."int_invoice_summary" ins on ps.PatientID = ins.PatientID
    group by
        ps.PatientID, 
        ps.firstname, 
        ps.lastname
), patient_segment as (
    select 
        *,
        CASE
            WHEN total_spent > 1000 THEN 'High Spender'
            WHEN total_appointments > 10 THEN 'Frequent User'
            ELSE 'Occasional User'
        END AS customer_segment 
        from patient_overview
)

select * from patient_segment
  );
  
[0m21:37:38.825041 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:37:38.832829 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:37:38.834834 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */
alter table "prodia_test"."public"."dm_patient_overview__dbt_tmp" rename to "dm_patient_overview"
[0m21:37:38.835833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:38.841409 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: COMMIT
[0m21:37:38.842421 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:37:38.843425 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: COMMIT
[0m21:37:38.846530 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:38.852059 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:37:38.854065 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */
drop table if exists "prodia_test"."public"."dm_patient_overview__dbt_backup" cascade
[0m21:37:38.856065 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:38.860598 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (execute): 21:37:38.717850 => 21:37:38.859594
[0m21:37:38.861617 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: Close
[0m21:37:38.863617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C272A10>]}
[0m21:37:38.865615 [info ] [Thread-1 (]: 11 of 15 OK created sql table model public.dm_patient_overview ................. [[32mSELECT 998[0m in 0.16s]
[0m21:37:38.868612 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m21:37:38.870734 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m21:37:38.872736 [info ] [Thread-1 (]: 12 of 15 START sql table model public.dm_appointment_summary ................... [RUN]
[0m21:37:38.874728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_patient_overview, now model.prodia_dbt.dm_appointment_summary)
[0m21:37:38.876735 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_appointment_summary
[0m21:37:38.884274 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_appointment_summary"
[0m21:37:38.888281 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (compile): 21:37:38.877734 => 21:37:38.887275
[0m21:37:38.889278 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_appointment_summary
[0m21:37:38.899349 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_appointment_summary"
[0m21:37:38.901867 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:37:38.903906 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: BEGIN
[0m21:37:38.904907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:39.001434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:39.003435 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:37:39.004440 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

  
    

  create  table "prodia_test"."public"."dm_appointment_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_appointment_summary.sql



with appointment_summary as (
    select
        ad.AppointmentDate,
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        COUNT(DISTINCT ad.ProcedureName) AS total_procedures
    from
        "prodia_test"."public"."int_appointment_details" ad
    group by
        ad.AppointmentDate, 
        ad.DoctorName
)

select * from appointment_summary
  );
  
[0m21:37:39.018504 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m21:37:39.025545 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:37:39.027548 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
alter table "prodia_test"."public"."dm_appointment_summary" rename to "dm_appointment_summary__dbt_backup"
[0m21:37:39.029617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:39.036866 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:37:39.037869 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
alter table "prodia_test"."public"."dm_appointment_summary__dbt_tmp" rename to "dm_appointment_summary"
[0m21:37:39.041131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:37:39.046158 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m21:37:39.048146 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:37:39.049136 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m21:37:39.052712 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:37:39.058717 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:37:39.059717 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
drop table if exists "prodia_test"."public"."dm_appointment_summary__dbt_backup" cascade
[0m21:37:39.065694 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:37:39.069777 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (execute): 21:37:38.890798 => 21:37:39.068701
[0m21:37:39.070758 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: Close
[0m21:37:39.073293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C4377D0>]}
[0m21:37:39.075294 [info ] [Thread-1 (]: 12 of 15 OK created sql table model public.dm_appointment_summary .............. [[32mSELECT 999[0m in 0.20s]
[0m21:37:39.078297 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m21:37:39.080293 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_cohort_analysis
[0m21:37:39.081297 [info ] [Thread-1 (]: 13 of 15 START sql table model public.dm_cohort_analysis ....................... [RUN]
[0m21:37:39.084831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_appointment_summary, now model.prodia_dbt.dm_cohort_analysis)
[0m21:37:39.086847 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_cohort_analysis
[0m21:37:39.093392 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_cohort_analysis"
[0m21:37:39.096436 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_cohort_analysis (compile): 21:37:39.087846 => 21:37:39.096436
[0m21:37:39.099414 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_cohort_analysis
[0m21:37:39.110999 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_cohort_analysis"
[0m21:37:39.112991 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:37:39.114511 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: BEGIN
[0m21:37:39.116554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:39.191759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:39.192759 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:37:39.193932 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_cohort_analysis"} */

  
    

  create  table "prodia_test"."public"."dm_cohort_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_cohort_analysis.sql



with cohort_analysis as (
    select 
        DATE_TRUNC('month', MIN(AppointmentDate)) AS cohort_month,
        COUNT(DISTINCT PatientID) AS patients_in_cohort
    from
        "prodia_test"."public"."int_appointment_details"
    group by
        cohort_month  
)

select * from cohort_analysis
  );
  
[0m21:37:39.199065 [debug] [Thread-1 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in GROUP BY
LINE 18:         DATE_TRUNC('month', MIN(AppointmentDate)) AS cohort_...
                                     ^

[0m21:37:39.200575 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: ROLLBACK
[0m21:37:39.202581 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_cohort_analysis (execute): 21:37:39.099414 => 21:37:39.202581
[0m21:37:39.204601 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: Close
[0m21:37:39.222661 [debug] [Thread-1 (]: Database Error in model dm_cohort_analysis (models\datamart\dm_cohort_analysis.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 18:         DATE_TRUNC('month', MIN(AppointmentDate)) AS cohort_...
                                       ^
  compiled Code at target\run\prodia_dbt\models\datamart\dm_cohort_analysis.sql
[0m21:37:39.224699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C2598D0>]}
[0m21:37:39.226701 [error] [Thread-1 (]: 13 of 15 ERROR creating sql table model public.dm_cohort_analysis .............. [[31mERROR[0m in 0.14s]
[0m21:37:39.228707 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_cohort_analysis
[0m21:37:39.230690 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_doctor_performance
[0m21:37:39.232222 [info ] [Thread-1 (]: 14 of 15 START sql table model public.dm_doctor_performance .................... [RUN]
[0m21:37:39.235274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_cohort_analysis, now model.prodia_dbt.dm_doctor_performance)
[0m21:37:39.237270 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_doctor_performance
[0m21:37:39.245244 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_doctor_performance"
[0m21:37:39.247260 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_doctor_performance (compile): 21:37:39.238258 => 21:37:39.247260
[0m21:37:39.249269 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_doctor_performance
[0m21:37:39.258815 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_doctor_performance"
[0m21:37:39.261810 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_doctor_performance"
[0m21:37:39.264353 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: BEGIN
[0m21:37:39.265391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:39.336267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:39.338799 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_doctor_performance"
[0m21:37:39.339844 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_doctor_performance"} */

  
    

  create  table "prodia_test"."public"."dm_doctor_performance__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_doctor_performance.sql



with doctor_performance as (
    SELECT
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        SUM(i.Amount) AS total_revenue
    FROM
        "prodia_test"."public"."int_appointment_details" ad
    LEFT JOIN
        "prodia_test"."public"."int_invoice_summary" i ON ad.PatientID = i.PatientID
    GROUP BY
        ad.DoctorName; 
)

select * from doctor_performance
  );
  
[0m21:37:39.342160 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26:         ad.DoctorName; 
                              ^

[0m21:37:39.344845 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: ROLLBACK
[0m21:37:39.347845 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_doctor_performance (execute): 21:37:39.250259 => 21:37:39.347107
[0m21:37:39.349391 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: Close
[0m21:37:39.357436 [debug] [Thread-1 (]: Database Error in model dm_doctor_performance (models\datamart\dm_doctor_performance.sql)
  syntax error at or near ";"
  LINE 26:         ad.DoctorName; 
                                ^
  compiled Code at target\run\prodia_dbt\models\datamart\dm_doctor_performance.sql
[0m21:37:39.358436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C46C7D0>]}
[0m21:37:39.361010 [error] [Thread-1 (]: 14 of 15 ERROR creating sql table model public.dm_doctor_performance ........... [[31mERROR[0m in 0.12s]
[0m21:37:39.364006 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_doctor_performance
[0m21:37:39.365018 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_monthly_revenue
[0m21:37:39.367019 [info ] [Thread-1 (]: 15 of 15 START sql table model public.dm_monthly_revenue ....................... [RUN]
[0m21:37:39.369019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_doctor_performance, now model.prodia_dbt.dm_monthly_revenue)
[0m21:37:39.369536 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_monthly_revenue
[0m21:37:39.379129 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_monthly_revenue"
[0m21:37:39.382659 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_monthly_revenue (compile): 21:37:39.371078 => 21:37:39.381644
[0m21:37:39.384669 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_monthly_revenue
[0m21:37:39.393247 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_monthly_revenue"
[0m21:37:39.396276 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:37:39.397264 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: BEGIN
[0m21:37:39.399272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:39.471982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:37:39.473981 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:37:39.474991 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_monthly_revenue"} */

  
    

  create  table "prodia_test"."public"."dm_monthly_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_monthly_revenue.sql



WITH monthly_trends AS (
    SELECT
        DATE_TRUNC('month', AppointmentDate) AS month,
        COUNT(AppointmentID) AS total_appointments,
        SUM(Amount) AS total_revenue
    FROM
        "prodia_test"."public"."int_appointment_details" ad
    JOIN
        "prodia_test"."public"."int_invoice_summary" i ON ad.PatientID = i.PatientID
    GROUP BY
        month
)

select * from monthly_trends
  );
  
[0m21:37:39.477535 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "amount" does not exist
LINE 20:         SUM(Amount) AS total_revenue
                     ^

[0m21:37:39.479578 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: ROLLBACK
[0m21:37:39.481583 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_monthly_revenue (execute): 21:37:39.385669 => 21:37:39.480571
[0m21:37:39.483583 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: Close
[0m21:37:39.489077 [debug] [Thread-1 (]: Database Error in model dm_monthly_revenue (models\datamart\dm_monthly_revenue.sql)
  column "amount" does not exist
  LINE 20:         SUM(Amount) AS total_revenue
                       ^
  compiled Code at target\run\prodia_dbt\models\datamart\dm_monthly_revenue.sql
[0m21:37:39.491091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b287859e-e939-4e54-9c72-30aa54bfce60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C397110>]}
[0m21:37:39.492108 [error] [Thread-1 (]: 15 of 15 ERROR creating sql table model public.dm_monthly_revenue .............. [[31mERROR[0m in 0.12s]
[0m21:37:39.495122 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_monthly_revenue
[0m21:37:39.498644 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:39.499686 [debug] [MainThread]: On master: BEGIN
[0m21:37:39.500676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:37:39.573432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:37:39.573943 [debug] [MainThread]: On master: COMMIT
[0m21:37:39.575966 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:39.576977 [debug] [MainThread]: On master: COMMIT
[0m21:37:39.577975 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:37:39.579966 [debug] [MainThread]: On master: Close
[0m21:37:39.581976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:39.583969 [debug] [MainThread]: Connection 'list_prodia_test' was properly closed.
[0m21:37:39.584485 [debug] [MainThread]: Connection 'list_prodia_test_public' was properly closed.
[0m21:37:39.586524 [debug] [MainThread]: Connection 'model.prodia_dbt.dm_monthly_revenue' was properly closed.
[0m21:37:39.587512 [info ] [MainThread]: 
[0m21:37:39.589524 [info ] [MainThread]: Finished running 14 table models, 1 view model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m21:37:39.598067 [debug] [MainThread]: Command end result
[0m21:37:39.616116 [info ] [MainThread]: 
[0m21:37:39.619149 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m21:37:39.621158 [info ] [MainThread]: 
[0m21:37:39.622158 [error] [MainThread]: [33mDatabase Error in model dm_cohort_analysis (models\datamart\dm_cohort_analysis.sql)[0m
[0m21:37:39.624146 [error] [MainThread]:   aggregate functions are not allowed in GROUP BY
[0m21:37:39.626696 [error] [MainThread]:   LINE 18:         DATE_TRUNC('month', MIN(AppointmentDate)) AS cohort_...
[0m21:37:39.628732 [error] [MainThread]:                                        ^
[0m21:37:39.630747 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_cohort_analysis.sql
[0m21:37:39.632750 [info ] [MainThread]: 
[0m21:37:39.635728 [error] [MainThread]: [33mDatabase Error in model dm_doctor_performance (models\datamart\dm_doctor_performance.sql)[0m
[0m21:37:39.637255 [error] [MainThread]:   syntax error at or near ";"
[0m21:37:39.639290 [error] [MainThread]:   LINE 26:         ad.DoctorName; 
[0m21:37:39.641298 [error] [MainThread]:                                 ^
[0m21:37:39.643298 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_doctor_performance.sql
[0m21:37:39.645297 [info ] [MainThread]: 
[0m21:37:39.647303 [error] [MainThread]: [33mDatabase Error in model dm_monthly_revenue (models\datamart\dm_monthly_revenue.sql)[0m
[0m21:37:39.649556 [error] [MainThread]:   column "amount" does not exist
[0m21:37:39.651601 [error] [MainThread]:   LINE 20:         SUM(Amount) AS total_revenue
[0m21:37:39.652599 [error] [MainThread]:                        ^
[0m21:37:39.654585 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_monthly_revenue.sql
[0m21:37:39.657587 [info ] [MainThread]: 
[0m21:37:39.659115 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=3 SKIP=0 TOTAL=15
[0m21:37:39.662138 [debug] [MainThread]: Command `dbt run` failed at 21:37:39.662138 after 5.98 seconds
[0m21:37:39.663151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152253E0B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152253E0C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001522C0CB090>]}
[0m21:37:39.666151 [debug] [MainThread]: Flushing usage events
[0m21:42:55.878113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4BF7DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4BF7E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4BF7F750>]}


============================== 21:42:55.883640 | c5e84e8b-b08c-4ee2-912d-b2731cccf656 ==============================
[0m21:42:55.883640 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:42:55.886659 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'write_json': 'True', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs'}
[0m21:42:56.135041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4AB03E50>]}
[0m21:42:56.177682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4AB03E50>]}
[0m21:42:56.201965 [debug] [MainThread]: checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, vars: {}, profile: , target: postgres, version: 1.5.0
[0m21:42:56.295587 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:42:56.296587 [debug] [MainThread]: previous checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m21:42:56.298100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4AFB2B90>]}
[0m21:42:57.892245 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m21:42:57.924879 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_cohort_analysis.sql
[0m21:42:57.933436 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_doctor_performance.sql
[0m21:42:57.940431 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_monthly_revenue.sql
[0m21:42:57.949636 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m21:42:57.956720 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m21:42:57.965245 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m21:42:57.973796 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m21:42:57.984362 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m21:42:57.992353 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m21:42:57.999889 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m21:42:58.014438 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m21:42:58.019978 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m21:42:58.029029 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m21:42:58.034027 [debug] [MainThread]: 1603: static parser failed on staging\stg_invoices.sql
[0m21:42:58.047091 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_invoices.sql
[0m21:42:58.054143 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m21:42:58.063337 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m21:42:58.067333 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m21:42:58.077855 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m21:42:58.421689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C22BED0>]}
[0m21:42:58.439244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C1D2110>]}
[0m21:42:58.440246 [info ] [MainThread]: Found 15 models, 4 tests, 0 snapshots, 0 analyses, 318 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m21:42:58.442809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C1D3810>]}
[0m21:42:58.447820 [info ] [MainThread]: 
[0m21:42:58.449793 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:42:58.454315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test'
[0m21:42:58.476991 [debug] [ThreadPool]: Using postgres connection "list_prodia_test"
[0m21:42:58.478981 [debug] [ThreadPool]: On list_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test"} */

    select distinct nspname from pg_namespace
  
[0m21:42:58.480999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:58.664241 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:42:58.668788 [debug] [ThreadPool]: On list_prodia_test: Close
[0m21:42:58.676789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test_public'
[0m21:42:58.694591 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m21:42:58.695590 [debug] [ThreadPool]: On list_prodia_test_public: BEGIN
[0m21:42:58.696593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:58.770491 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:42:58.772511 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m21:42:58.773030 [debug] [ThreadPool]: On list_prodia_test_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test_public"} */
select
      'prodia_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'prodia_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:42:58.785597 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m21:42:58.789603 [debug] [ThreadPool]: On list_prodia_test_public: ROLLBACK
[0m21:42:58.791605 [debug] [ThreadPool]: On list_prodia_test_public: Close
[0m21:42:58.823370 [debug] [MainThread]: Using postgres connection "master"
[0m21:42:58.824369 [debug] [MainThread]: On master: BEGIN
[0m21:42:58.825900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:42:58.900448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:42:58.901493 [debug] [MainThread]: Using postgres connection "master"
[0m21:42:58.903472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:42:58.924427 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:42:58.928415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4B9D3150>]}
[0m21:42:58.929427 [debug] [MainThread]: On master: ROLLBACK
[0m21:42:58.931404 [debug] [MainThread]: Using postgres connection "master"
[0m21:42:58.932932 [debug] [MainThread]: On master: BEGIN
[0m21:42:58.934969 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:42:58.935967 [debug] [MainThread]: On master: COMMIT
[0m21:42:58.937967 [debug] [MainThread]: Using postgres connection "master"
[0m21:42:58.938956 [debug] [MainThread]: On master: COMMIT
[0m21:42:58.939970 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:42:58.941969 [debug] [MainThread]: On master: Close
[0m21:42:58.944495 [info ] [MainThread]: Concurrency: 1 threads (target='postgres')
[0m21:42:58.946494 [info ] [MainThread]: 
[0m21:42:58.959607 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m21:42:58.961613 [info ] [Thread-1 (]: 1 of 15 START sql table model public.my_first_dbt_model ........................ [RUN]
[0m21:42:58.964616 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.prodia_dbt.my_first_dbt_model'
[0m21:42:58.966829 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m21:42:58.973835 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m21:42:58.977372 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 21:42:58.967829 => 21:42:58.976372
[0m21:42:58.979401 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m21:42:59.107088 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m21:42:59.109090 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:42:59.111090 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m21:42:59.112090 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:42:59.186834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:42:59.187838 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:42:59.189360 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table "prodia_test"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:42:59.199381 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m21:42:59.217137 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:42:59.219131 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:42:59.221661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:42:59.229679 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:42:59.232208 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:42:59.234220 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:42:59.287353 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m21:42:59.288353 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:42:59.289353 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m21:42:59.292354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:42:59.308438 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:42:59.315443 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists "prodia_test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:42:59.324006 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:42:59.328542 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 21:42:58.980392 => 21:42:59.327527
[0m21:42:59.329543 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m21:42:59.331052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C1754D0>]}
[0m21:42:59.333062 [info ] [Thread-1 (]: 1 of 15 OK created sql table model public.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.37s]
[0m21:42:59.336059 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m21:42:59.337059 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m21:42:59.339582 [info ] [Thread-1 (]: 2 of 15 START sql table model public.stg_appointments .......................... [RUN]
[0m21:42:59.342584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m21:42:59.344575 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m21:42:59.352094 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m21:42:59.355099 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 21:42:59.345576 => 21:42:59.355099
[0m21:42:59.358182 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m21:42:59.367692 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m21:42:59.371217 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:42:59.373229 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m21:42:59.375224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:59.447647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:42:59.448661 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:42:59.450653 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table "prodia_test"."public"."stg_appointments__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_appointments.sql



    select *
    from "prodia_test"."public"."appointments"

  );
  
[0m21:42:59.462760 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:42:59.469334 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:42:59.471347 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
alter table "prodia_test"."public"."stg_appointments" rename to "stg_appointments__dbt_backup"
[0m21:42:59.473347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:42:59.480897 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:42:59.481899 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
alter table "prodia_test"."public"."stg_appointments__dbt_tmp" rename to "stg_appointments"
[0m21:42:59.484880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:42:59.490431 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m21:42:59.492441 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:42:59.493465 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m21:42:59.497950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:42:59.504964 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:42:59.506967 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
drop table if exists "prodia_test"."public"."stg_appointments__dbt_backup" cascade
[0m21:42:59.513506 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:42:59.518501 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 21:42:59.359689 => 21:42:59.517498
[0m21:42:59.520023 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m21:42:59.523063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C1A0FD0>]}
[0m21:42:59.526060 [info ] [Thread-1 (]: 2 of 15 OK created sql table model public.stg_appointments ..................... [[32mSELECT 1000[0m in 0.18s]
[0m21:42:59.529059 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m21:42:59.531242 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m21:42:59.533239 [info ] [Thread-1 (]: 3 of 15 START sql table model public.stg_doctors ............................... [RUN]
[0m21:42:59.536244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_doctors)
[0m21:42:59.538245 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m21:42:59.548829 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m21:42:59.552358 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 21:42:59.539251 => 21:42:59.551337
[0m21:42:59.554359 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m21:42:59.574903 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m21:42:59.577813 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:42:59.578811 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m21:42:59.580812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:59.649557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:42:59.651553 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:42:59.652555 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table "prodia_test"."public"."stg_doctors__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_doctors.sql



    select *
    from "prodia_test"."public"."doctors"

  );
  
[0m21:42:59.668605 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:42:59.675615 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:42:59.677615 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
alter table "prodia_test"."public"."stg_doctors" rename to "stg_doctors__dbt_backup"
[0m21:42:59.680149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:42:59.688150 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:42:59.689140 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
alter table "prodia_test"."public"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m21:42:59.691660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:42:59.698677 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m21:42:59.699688 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:42:59.701205 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m21:42:59.705226 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:42:59.712773 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:42:59.713786 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
drop table if exists "prodia_test"."public"."stg_doctors__dbt_backup" cascade
[0m21:42:59.720757 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:42:59.726332 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 21:42:59.555364 => 21:42:59.725320
[0m21:42:59.727330 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m21:42:59.730305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C2D8950>]}
[0m21:42:59.731303 [info ] [Thread-1 (]: 3 of 15 OK created sql table model public.stg_doctors .......................... [[32mSELECT 1000[0m in 0.19s]
[0m21:42:59.734854 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m21:42:59.736849 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_invoices
[0m21:42:59.738878 [info ] [Thread-1 (]: 4 of 15 START sql table model public.stg_invoices .............................. [RUN]
[0m21:42:59.740879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_invoices)
[0m21:42:59.741881 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_invoices
[0m21:42:59.752464 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_invoices"
[0m21:42:59.755002 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (compile): 21:42:59.744465 => 21:42:59.753985
[0m21:42:59.756021 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_invoices
[0m21:42:59.769149 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_invoices"
[0m21:42:59.771149 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:42:59.773156 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: BEGIN
[0m21:42:59.774142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:59.850209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:42:59.851252 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:42:59.853252 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */

  
    

  create  table "prodia_test"."public"."stg_invoices__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_billings.sql



    select *
    from "prodia_test"."public"."invoices"

  );
  
[0m21:42:59.864163 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:42:59.874711 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:42:59.875709 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
alter table "prodia_test"."public"."stg_invoices" rename to "stg_invoices__dbt_backup"
[0m21:42:59.878709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:42:59.885269 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:42:59.886278 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
alter table "prodia_test"."public"."stg_invoices__dbt_tmp" rename to "stg_invoices"
[0m21:42:59.889271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:42:59.892811 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m21:42:59.894856 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:42:59.895845 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m21:42:59.898854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:42:59.905414 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:42:59.906412 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
drop table if exists "prodia_test"."public"."stg_invoices__dbt_backup" cascade
[0m21:42:59.911424 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:42:59.916189 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (execute): 21:42:59.757557 => 21:42:59.915197
[0m21:42:59.917197 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: Close
[0m21:42:59.920173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C2FA990>]}
[0m21:42:59.922171 [info ] [Thread-1 (]: 4 of 15 OK created sql table model public.stg_invoices ......................... [[32mSELECT 1000[0m in 0.18s]
[0m21:42:59.924734 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_invoices
[0m21:42:59.926772 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m21:42:59.928779 [info ] [Thread-1 (]: 5 of 15 START sql table model public.stg_patients .............................. [RUN]
[0m21:42:59.930774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_invoices, now model.prodia_dbt.stg_patients)
[0m21:42:59.932771 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m21:42:59.941341 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m21:42:59.944325 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 21:42:59.933776 => 21:42:59.944325
[0m21:42:59.946902 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m21:42:59.956916 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m21:42:59.959376 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:42:59.961350 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m21:42:59.962345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:00.042210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:00.043743 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:43:00.045762 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table "prodia_test"."public"."stg_patients__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_patients.sql



    select *
    from "prodia_test"."public"."patients"

  );
  
[0m21:43:00.059599 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:43:00.077278 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:43:00.080341 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
alter table "prodia_test"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m21:43:00.083341 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:00.092883 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:43:00.093882 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
alter table "prodia_test"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m21:43:00.097428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:00.101434 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m21:43:00.104424 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:43:00.104424 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m21:43:00.107962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:43:00.114956 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:43:00.116465 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
drop table if exists "prodia_test"."public"."stg_patients__dbt_backup" cascade
[0m21:43:00.122480 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:43:00.126475 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 21:42:59.947892 => 21:43:00.125475
[0m21:43:00.127985 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m21:43:00.129995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C1337D0>]}
[0m21:43:00.131987 [info ] [Thread-1 (]: 5 of 15 OK created sql table model public.stg_patients ......................... [[32mSELECT 998[0m in 0.20s]
[0m21:43:00.134991 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m21:43:00.135987 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m21:43:00.137990 [info ] [Thread-1 (]: 6 of 15 START sql table model public.stg_procedures ............................ [RUN]
[0m21:43:00.140515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m21:43:00.142511 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m21:43:00.150022 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m21:43:00.153054 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 21:43:00.143506 => 21:43:00.152044
[0m21:43:00.154054 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m21:43:00.165149 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m21:43:00.168150 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:43:00.169141 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m21:43:00.170653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:00.243282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:00.244819 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:43:00.246853 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table "prodia_test"."public"."stg_procedures__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_procedures.sql



    select *
    from "prodia_test"."public"."procedures"

  );
  
[0m21:43:00.259975 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:43:00.267495 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:43:00.269516 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
alter table "prodia_test"."public"."stg_procedures" rename to "stg_procedures__dbt_backup"
[0m21:43:00.271515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:00.280050 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:43:00.282062 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
alter table "prodia_test"."public"."stg_procedures__dbt_tmp" rename to "stg_procedures"
[0m21:43:00.285030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:00.289565 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m21:43:00.291566 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:43:00.293557 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m21:43:00.296557 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:43:00.305075 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:43:00.307078 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
drop table if exists "prodia_test"."public"."stg_procedures__dbt_backup" cascade
[0m21:43:00.312604 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:43:00.316602 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 21:43:00.156027 => 21:43:00.316602
[0m21:43:00.318600 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m21:43:00.321120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C07EBD0>]}
[0m21:43:00.323140 [info ] [Thread-1 (]: 6 of 15 OK created sql table model public.stg_procedures ....................... [[32mSELECT 1000[0m in 0.18s]
[0m21:43:00.326134 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m21:43:00.328129 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m21:43:00.339816 [info ] [Thread-1 (]: 7 of 15 START sql view model public.my_second_dbt_model ........................ [RUN]
[0m21:43:00.343749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m21:43:00.344257 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m21:43:00.352590 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m21:43:00.354594 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 21:43:00.345443 => 21:43:00.353590
[0m21:43:00.355587 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m21:43:00.416804 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m21:43:00.419794 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:43:00.421794 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m21:43:00.423797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:00.497114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:00.499111 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:43:00.500625 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view "prodia_test"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "prodia_test"."public"."my_first_dbt_model"
where id = 1
  );
[0m21:43:00.511155 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:43:00.520168 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:43:00.522167 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
alter table "prodia_test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:43:00.525460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:00.530478 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m21:43:00.531454 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:43:00.532970 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m21:43:00.537001 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:43:00.544527 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:43:00.546551 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists "prodia_test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m21:43:00.548543 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:43:00.552549 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 21:43:00.357611 => 21:43:00.552549
[0m21:43:00.554067 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m21:43:00.557113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C33C750>]}
[0m21:43:00.559623 [info ] [Thread-1 (]: 7 of 15 OK created sql view model public.my_second_dbt_model ................... [[32mCREATE VIEW[0m in 0.21s]
[0m21:43:00.563639 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m21:43:00.564635 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m21:43:00.567109 [info ] [Thread-1 (]: 8 of 15 START sql table model public.int_invoice_summary ....................... [RUN]
[0m21:43:00.570103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_second_dbt_model, now model.prodia_dbt.int_invoice_summary)
[0m21:43:00.572106 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_invoice_summary
[0m21:43:00.580661 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_invoice_summary"
[0m21:43:00.593311 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (compile): 21:43:00.573111 => 21:43:00.592311
[0m21:43:00.594300 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_invoice_summary
[0m21:43:00.605396 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_invoice_summary"
[0m21:43:00.608560 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:43:00.610563 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: BEGIN
[0m21:43:00.612562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:00.686388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:00.688394 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:43:00.690394 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */

  
    

  create  table "prodia_test"."public"."int_invoice_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_invoice_summary.sql



with invoice_summary as (
    select
        i.InvoiceID,
        i.PatientID,
        sum(i.Amount) as total_amount,
        count(i.Items) as item_count
    from
        "prodia_test"."public"."stg_invoices" i
    group by
        i.InvoiceID,
        i.PatientID
)

select * from invoice_summary
  );
  
[0m21:43:00.710448 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:43:00.716978 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:43:00.717978 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */
alter table "prodia_test"."public"."int_invoice_summary" rename to "int_invoice_summary__dbt_backup"
[0m21:43:00.720989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:00.729536 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:43:00.731536 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */
alter table "prodia_test"."public"."int_invoice_summary__dbt_tmp" rename to "int_invoice_summary"
[0m21:43:00.734534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:00.738829 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m21:43:00.739831 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:43:00.741837 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m21:43:00.744829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:43:00.750344 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:43:00.752342 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */
drop table if exists "prodia_test"."public"."int_invoice_summary__dbt_backup" cascade
[0m21:43:00.760414 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:43:00.764415 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (execute): 21:43:00.595307 => 21:43:00.764415
[0m21:43:00.765415 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: Close
[0m21:43:00.767418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C0A2B50>]}
[0m21:43:00.769945 [info ] [Thread-1 (]: 8 of 15 OK created sql table model public.int_invoice_summary .................. [[32mSELECT 1000[0m in 0.20s]
[0m21:43:00.773949 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m21:43:00.775943 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m21:43:00.776944 [info ] [Thread-1 (]: 9 of 15 START sql table model public.int_patient_summary ....................... [RUN]
[0m21:43:00.780468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_invoice_summary, now model.prodia_dbt.int_patient_summary)
[0m21:43:00.781460 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_patient_summary
[0m21:43:00.790992 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_patient_summary"
[0m21:43:00.793985 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (compile): 21:43:00.782467 => 21:43:00.792983
[0m21:43:00.795981 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_patient_summary
[0m21:43:00.807526 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_patient_summary"
[0m21:43:00.811087 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:43:00.813075 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: BEGIN
[0m21:43:00.815086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:00.886979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:00.887978 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:43:00.889989 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */

  
    

  create  table "prodia_test"."public"."int_patient_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_patient_summary.sql


with patient_appointments as (
    select
        p.PatientID,
        p.firstname,
        p.lastname,
        count(a.AppointmentID) as total_appointments
    from
        "prodia_test"."public"."stg_patients" p
    left join
        "prodia_test"."public"."stg_appointments" a on p.PatientID = a.PatientID
    group by
        p.PatientID,
        p.firstname,
        p.lastname
)

select * from patient_appointments
  );
  
[0m21:43:00.903485 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:43:00.912082 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:43:00.914078 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
alter table "prodia_test"."public"."int_patient_summary" rename to "int_patient_summary__dbt_backup"
[0m21:43:00.915065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:00.924618 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:43:00.926627 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
alter table "prodia_test"."public"."int_patient_summary__dbt_tmp" rename to "int_patient_summary"
[0m21:43:00.928835 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:00.934842 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m21:43:00.936035 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:43:00.936840 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m21:43:00.940092 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:43:00.947092 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:43:00.949617 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
drop table if exists "prodia_test"."public"."int_patient_summary__dbt_backup" cascade
[0m21:43:00.954615 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:43:00.959613 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (execute): 21:43:00.797983 => 21:43:00.958617
[0m21:43:00.960741 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: Close
[0m21:43:00.962740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C295F90>]}
[0m21:43:00.964734 [info ] [Thread-1 (]: 9 of 15 OK created sql table model public.int_patient_summary .................. [[32mSELECT 998[0m in 0.18s]
[0m21:43:00.967742 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m21:43:00.970248 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m21:43:00.972266 [info ] [Thread-1 (]: 10 of 15 START sql table model public.int_appointment_details .................. [RUN]
[0m21:43:00.975266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_patient_summary, now model.prodia_dbt.int_appointment_details)
[0m21:43:00.976265 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_appointment_details
[0m21:43:00.986803 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_appointment_details"
[0m21:43:00.989781 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (compile): 21:43:00.977261 => 21:43:00.989781
[0m21:43:00.992340 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_appointment_details
[0m21:43:01.002227 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_appointment_details"
[0m21:43:01.004275 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:43:01.006267 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: BEGIN
[0m21:43:01.007266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:01.081734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:01.087846 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:43:01.091883 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */

  
    

  create  table "prodia_test"."public"."int_appointment_details__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_appointment_details.sql



with appointment_info as (
    select
        a.AppointmentID,
        a.AppointmentDate,
        a.AppointmentTime,
        p.PatientID,
        concat(p.firstname, ' ', p.lastname) as patient_name,
        d.DoctorName,
        pr.ProcedureName,
        case when a.AppointmentDate < CURRENT_DATE then 1 else 0 end as is_overdue
    from
        "prodia_test"."public"."stg_appointments" a
    join
        "prodia_test"."public"."stg_patients" p on a.PatientID = p.PatientID
    join
        "prodia_test"."public"."stg_doctors" d on a.DoctorID = d.DoctorID
    left join
        "prodia_test"."public"."stg_procedures" pr on a.AppointmentID = pr.AppointmentID
)

select * from appointment_info
  );
  
[0m21:43:01.115266 [debug] [Thread-1 (]: SQL status: SELECT 1367 in 0.0 seconds
[0m21:43:01.123819 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:43:01.125820 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
alter table "prodia_test"."public"."int_appointment_details" rename to "int_appointment_details__dbt_backup"
[0m21:43:01.127808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:01.136351 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:43:01.138355 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
alter table "prodia_test"."public"."int_appointment_details__dbt_tmp" rename to "int_appointment_details"
[0m21:43:01.140885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:01.146916 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m21:43:01.147916 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:43:01.149909 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m21:43:01.154450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:43:01.159990 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:43:01.162025 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
drop table if exists "prodia_test"."public"."int_appointment_details__dbt_backup" cascade
[0m21:43:01.170522 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:43:01.174058 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (execute): 21:43:00.994353 => 21:43:01.174058
[0m21:43:01.175070 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: Close
[0m21:43:01.177077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C2F2210>]}
[0m21:43:01.180070 [info ] [Thread-1 (]: 10 of 15 OK created sql table model public.int_appointment_details ............. [[32mSELECT 1367[0m in 0.20s]
[0m21:43:01.182063 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m21:43:01.185621 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m21:43:01.187608 [info ] [Thread-1 (]: 11 of 15 START sql table model public.dm_patient_overview ...................... [RUN]
[0m21:43:01.191605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_appointment_details, now model.prodia_dbt.dm_patient_overview)
[0m21:43:01.192603 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_patient_overview
[0m21:43:01.203140 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_patient_overview"
[0m21:43:01.206670 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (compile): 21:43:01.194119 => 21:43:01.205667
[0m21:43:01.208676 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_patient_overview
[0m21:43:01.218177 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_patient_overview"
[0m21:43:01.220187 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:43:01.222192 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: BEGIN
[0m21:43:01.224181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:01.299290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:01.300832 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:43:01.302848 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */

  
    

  create  table "prodia_test"."public"."dm_patient_overview__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_patient_overview.sql



with patient_overview as (
    select
        ps.PatientID,
        ps.firstname,
        ps.lastname,
        SUM(ps.total_appointments) as total_appointments,
        COALESCE(SUM(ins.total_amount), 0) AS total_spent
    from
        "prodia_test"."public"."int_patient_summary" ps
    left join
        "prodia_test"."public"."int_invoice_summary" ins on ps.PatientID = ins.PatientID
    group by
        ps.PatientID, 
        ps.firstname, 
        ps.lastname
), patient_segment as (
    select 
        *,
        CASE
            WHEN total_spent > 1000 THEN 'High Spender'
            WHEN total_appointments > 10 THEN 'Frequent User'
            ELSE 'Occasional User'
        END AS customer_segment 
        from patient_overview
)

select * from patient_segment
  );
  
[0m21:43:01.326927 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:43:01.342550 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:43:01.344530 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */
alter table "prodia_test"."public"."dm_patient_overview" rename to "dm_patient_overview__dbt_backup"
[0m21:43:01.345815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:01.354478 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:43:01.355500 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */
alter table "prodia_test"."public"."dm_patient_overview__dbt_tmp" rename to "dm_patient_overview"
[0m21:43:01.358495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:01.363976 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: COMMIT
[0m21:43:01.364965 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:43:01.367235 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: COMMIT
[0m21:43:01.370227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:43:01.377811 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:43:01.379809 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */
drop table if exists "prodia_test"."public"."dm_patient_overview__dbt_backup" cascade
[0m21:43:01.386312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:43:01.391354 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (execute): 21:43:01.209670 => 21:43:01.390354
[0m21:43:01.393359 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: Close
[0m21:43:01.395325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C254850>]}
[0m21:43:01.397858 [info ] [Thread-1 (]: 11 of 15 OK created sql table model public.dm_patient_overview ................. [[32mSELECT 998[0m in 0.20s]
[0m21:43:01.400873 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m21:43:01.403868 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m21:43:01.405900 [info ] [Thread-1 (]: 12 of 15 START sql table model public.dm_appointment_summary ................... [RUN]
[0m21:43:01.408451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_patient_overview, now model.prodia_dbt.dm_appointment_summary)
[0m21:43:01.409448 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_appointment_summary
[0m21:43:01.417960 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_appointment_summary"
[0m21:43:01.420990 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (compile): 21:43:01.410445 => 21:43:01.419979
[0m21:43:01.422996 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_appointment_summary
[0m21:43:01.433511 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_appointment_summary"
[0m21:43:01.436516 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:43:01.438513 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: BEGIN
[0m21:43:01.440613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:01.514325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:01.515583 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:43:01.517572 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

  
    

  create  table "prodia_test"."public"."dm_appointment_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_appointment_summary.sql



with appointment_summary as (
    select
        ad.AppointmentDate,
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        COUNT(DISTINCT ad.ProcedureName) AS total_procedures
    from
        "prodia_test"."public"."int_appointment_details" ad
    group by
        ad.AppointmentDate, 
        ad.DoctorName
)

select * from appointment_summary
  );
  
[0m21:43:01.534128 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m21:43:01.542704 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:43:01.543710 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
alter table "prodia_test"."public"."dm_appointment_summary" rename to "dm_appointment_summary__dbt_backup"
[0m21:43:01.546221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:01.554272 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:43:01.556784 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
alter table "prodia_test"."public"."dm_appointment_summary__dbt_tmp" rename to "dm_appointment_summary"
[0m21:43:01.558819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:01.564972 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m21:43:01.569554 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:43:01.571555 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m21:43:01.574553 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:43:01.582102 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:43:01.587133 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
drop table if exists "prodia_test"."public"."dm_appointment_summary__dbt_backup" cascade
[0m21:43:01.597718 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:43:01.601244 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (execute): 21:43:01.423996 => 21:43:01.601244
[0m21:43:01.601244 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: Close
[0m21:43:01.603765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C0B3010>]}
[0m21:43:01.605762 [info ] [Thread-1 (]: 12 of 15 OK created sql table model public.dm_appointment_summary .............. [[32mSELECT 999[0m in 0.20s]
[0m21:43:01.608767 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m21:43:01.611302 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_cohort_analysis
[0m21:43:01.613320 [info ] [Thread-1 (]: 13 of 15 START sql table model public.dm_cohort_analysis ....................... [RUN]
[0m21:43:01.615325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_appointment_summary, now model.prodia_dbt.dm_cohort_analysis)
[0m21:43:01.617320 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_cohort_analysis
[0m21:43:01.626875 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_cohort_analysis"
[0m21:43:01.628866 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_cohort_analysis (compile): 21:43:01.618323 => 21:43:01.628866
[0m21:43:01.629873 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_cohort_analysis
[0m21:43:01.640414 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_cohort_analysis"
[0m21:43:01.643950 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:43:01.644948 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: BEGIN
[0m21:43:01.645944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:01.718641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:01.719634 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:43:01.720637 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_cohort_analysis"} */

  
    

  create  table "prodia_test"."public"."dm_cohort_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_cohort_analysis.sql



with cohort_analysis as (
    select 
        DATE_TRUNC('month', AppointmentDate) AS cohort_month,
        COUNT(DISTINCT PatientID) AS patients_in_cohort
    from
        "prodia_test"."public"."int_appointment_details"
    group by
        cohort_month  
)

select * from cohort_analysis
  );
  
[0m21:43:01.734812 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.0 seconds
[0m21:43:01.743320 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:43:01.745333 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_cohort_analysis"} */
alter table "prodia_test"."public"."dm_cohort_analysis__dbt_tmp" rename to "dm_cohort_analysis"
[0m21:43:01.747324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:01.751871 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: COMMIT
[0m21:43:01.753866 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:43:01.754866 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: COMMIT
[0m21:43:01.757871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:43:01.765986 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:43:01.767986 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_cohort_analysis"} */
drop table if exists "prodia_test"."public"."dm_cohort_analysis__dbt_backup" cascade
[0m21:43:01.769991 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:43:01.774519 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_cohort_analysis (execute): 21:43:01.631393 => 21:43:01.773523
[0m21:43:01.775519 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: Close
[0m21:43:01.778526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C0258D0>]}
[0m21:43:01.780540 [info ] [Thread-1 (]: 13 of 15 OK created sql table model public.dm_cohort_analysis .................. [[32mSELECT 48[0m in 0.16s]
[0m21:43:01.782710 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_cohort_analysis
[0m21:43:01.784741 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_doctor_performance
[0m21:43:01.786752 [info ] [Thread-1 (]: 14 of 15 START sql table model public.dm_doctor_performance .................... [RUN]
[0m21:43:01.789747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_cohort_analysis, now model.prodia_dbt.dm_doctor_performance)
[0m21:43:01.792306 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_doctor_performance
[0m21:43:01.802305 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_doctor_performance"
[0m21:43:01.805854 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_doctor_performance (compile): 21:43:01.793309 => 21:43:01.804860
[0m21:43:01.807855 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_doctor_performance
[0m21:43:01.823690 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_doctor_performance"
[0m21:43:01.827744 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_doctor_performance"
[0m21:43:01.829747 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: BEGIN
[0m21:43:01.831736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:01.925185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:01.927187 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_doctor_performance"
[0m21:43:01.928183 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_doctor_performance"} */

  
    

  create  table "prodia_test"."public"."dm_doctor_performance__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_doctor_performance.sql



with doctor_performance as (
    SELECT
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        SUM(i.Amount) AS total_revenue
    FROM
        "prodia_test"."public"."int_appointment_details" ad
    LEFT JOIN
        "prodia_test"."public"."int_invoice_summary" i ON ad.PatientID = i.PatientID
    GROUP BY
        ad.DoctorName
)

select * from doctor_performance
  );
  
[0m21:43:01.932325 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column i.amount does not exist
LINE 20:         SUM(i.Amount) AS total_revenue
                     ^

[0m21:43:01.934320 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: ROLLBACK
[0m21:43:01.936319 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_doctor_performance (execute): 21:43:01.808855 => 21:43:01.936319
[0m21:43:01.938319 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: Close
[0m21:43:01.957390 [debug] [Thread-1 (]: Database Error in model dm_doctor_performance (models\datamart\dm_doctor_performance.sql)
  column i.amount does not exist
  LINE 20:         SUM(i.Amount) AS total_revenue
                       ^
  compiled Code at target\run\prodia_dbt\models\datamart\dm_doctor_performance.sql
[0m21:43:01.959390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4C05B190>]}
[0m21:43:01.960381 [error] [Thread-1 (]: 14 of 15 ERROR creating sql table model public.dm_doctor_performance ........... [[31mERROR[0m in 0.17s]
[0m21:43:01.964147 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_doctor_performance
[0m21:43:01.965146 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_monthly_revenue
[0m21:43:01.967144 [info ] [Thread-1 (]: 15 of 15 START sql table model public.dm_monthly_revenue ....................... [RUN]
[0m21:43:01.970147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_doctor_performance, now model.prodia_dbt.dm_monthly_revenue)
[0m21:43:01.972661 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_monthly_revenue
[0m21:43:01.981678 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_monthly_revenue"
[0m21:43:01.984203 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_monthly_revenue (compile): 21:43:01.973678 => 21:43:01.984203
[0m21:43:01.986204 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_monthly_revenue
[0m21:43:01.997489 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_monthly_revenue"
[0m21:43:01.999484 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:43:02.001488 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: BEGIN
[0m21:43:02.002496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:02.076730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:43:02.077719 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:43:02.079232 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_monthly_revenue"} */

  
    

  create  table "prodia_test"."public"."dm_monthly_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_monthly_revenue.sql



WITH monthly_trends AS (
    SELECT
        DATE_TRUNC('month', AppointmentDate) AS month,
        COUNT(AppointmentID) AS total_appointments,
        SUM(total_amount) AS total_revenue
    FROM
        "prodia_test"."public"."int_appointment_details" ad
    JOIN
        "prodia_test"."public"."int_invoice_summary" i ON ad.PatientID = i.PatientID
    GROUP BY
        month
)

select * from monthly_trends
  );
  
[0m21:43:02.104533 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.0 seconds
[0m21:43:02.113077 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:43:02.114071 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_monthly_revenue"} */
alter table "prodia_test"."public"."dm_monthly_revenue__dbt_tmp" rename to "dm_monthly_revenue"
[0m21:43:02.116071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:02.120067 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: COMMIT
[0m21:43:02.122071 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:43:02.123591 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: COMMIT
[0m21:43:02.126600 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:43:02.133111 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:43:02.135158 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_monthly_revenue"} */
drop table if exists "prodia_test"."public"."dm_monthly_revenue__dbt_backup" cascade
[0m21:43:02.137153 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:43:02.142159 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_monthly_revenue (execute): 21:43:01.987201 => 21:43:02.141155
[0m21:43:02.143675 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: Close
[0m21:43:02.145720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e84e8b-b08c-4ee2-912d-b2731cccf656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4D314E10>]}
[0m21:43:02.147712 [info ] [Thread-1 (]: 15 of 15 OK created sql table model public.dm_monthly_revenue .................. [[32mSELECT 48[0m in 0.18s]
[0m21:43:02.150712 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_monthly_revenue
[0m21:43:02.155236 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:02.156235 [debug] [MainThread]: On master: BEGIN
[0m21:43:02.157241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:02.231699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:43:02.232692 [debug] [MainThread]: On master: COMMIT
[0m21:43:02.233697 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:02.234696 [debug] [MainThread]: On master: COMMIT
[0m21:43:02.236695 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:43:02.237691 [debug] [MainThread]: On master: Close
[0m21:43:02.239204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:02.241217 [debug] [MainThread]: Connection 'list_prodia_test' was properly closed.
[0m21:43:02.243235 [debug] [MainThread]: Connection 'list_prodia_test_public' was properly closed.
[0m21:43:02.244241 [debug] [MainThread]: Connection 'model.prodia_dbt.dm_monthly_revenue' was properly closed.
[0m21:43:02.246236 [info ] [MainThread]: 
[0m21:43:02.248235 [info ] [MainThread]: Finished running 14 table models, 1 view model in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m21:43:02.255302 [debug] [MainThread]: Command end result
[0m21:43:02.280372 [info ] [MainThread]: 
[0m21:43:02.282906 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:43:02.284931 [info ] [MainThread]: 
[0m21:43:02.286928 [error] [MainThread]: [33mDatabase Error in model dm_doctor_performance (models\datamart\dm_doctor_performance.sql)[0m
[0m21:43:02.289928 [error] [MainThread]:   column i.amount does not exist
[0m21:43:02.292938 [error] [MainThread]:   LINE 20:         SUM(i.Amount) AS total_revenue
[0m21:43:02.295299 [error] [MainThread]:                        ^
[0m21:43:02.298295 [error] [MainThread]:   compiled Code at target\run\prodia_dbt\models\datamart\dm_doctor_performance.sql
[0m21:43:02.300291 [info ] [MainThread]: 
[0m21:43:02.302295 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m21:43:02.304812 [debug] [MainThread]: Command `dbt run` failed at 21:43:02.304812 after 6.46 seconds
[0m21:43:02.306820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF45260B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF45260990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4BF7B210>]}
[0m21:43:02.308818 [debug] [MainThread]: Flushing usage events
[0m21:44:08.807354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A305DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A305E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A305F1D0>]}


============================== 21:44:08.812354 | 6b821e70-5f0d-46b2-9db5-a3852d06588e ==============================
[0m21:44:08.812354 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:44:08.814796 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\cortesdata\\Documents\\Prodia\\prodia_dbt\\logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\cortesdata\\.dbt', 'partial_parse': 'True'}
[0m21:44:09.046858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001559C0F5210>]}
[0m21:44:09.088162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001559C0F5210>]}
[0m21:44:09.113195 [debug] [MainThread]: checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, vars: {}, profile: , target: postgres, version: 1.5.0
[0m21:44:09.209473 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:44:09.210461 [debug] [MainThread]: previous checksum: 9a693f1e36fa9f2badc64ec544839e772f825c498989479a67d51b66728228be, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m21:44:09.211577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A3226410>]}
[0m21:44:10.647360 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_appointment_summary.sql
[0m21:44:10.676407 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_cohort_analysis.sql
[0m21:44:10.683938 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_doctor_performance.sql
[0m21:44:10.691456 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_monthly_revenue.sql
[0m21:44:10.705085 [debug] [MainThread]: 1699: static parser successfully parsed datamart\dm_patient_overview.sql
[0m21:44:10.713558 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m21:44:10.719670 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m21:44:10.727202 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_appointment_details.sql
[0m21:44:10.735333 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_invoice_summary.sql
[0m21:44:10.742860 [debug] [MainThread]: 1699: static parser successfully parsed intermediate\int_patient_summary.sql
[0m21:44:10.750875 [debug] [MainThread]: 1603: static parser failed on staging\stg_appointments.sql
[0m21:44:10.762413 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_appointments.sql
[0m21:44:10.766947 [debug] [MainThread]: 1603: static parser failed on staging\stg_doctors.sql
[0m21:44:10.776171 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_doctors.sql
[0m21:44:10.780190 [debug] [MainThread]: 1603: static parser failed on staging\stg_invoices.sql
[0m21:44:10.789701 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_invoices.sql
[0m21:44:10.794698 [debug] [MainThread]: 1603: static parser failed on staging\stg_patients.sql
[0m21:44:10.804234 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_patients.sql
[0m21:44:10.808765 [debug] [MainThread]: 1603: static parser failed on staging\stg_procedures.sql
[0m21:44:10.818267 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_procedures.sql
[0m21:44:11.164629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A31FF450>]}
[0m21:44:11.184704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A332D010>]}
[0m21:44:11.185701 [info ] [MainThread]: Found 15 models, 4 tests, 0 snapshots, 0 analyses, 318 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m21:44:11.187712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A32F3ED0>]}
[0m21:44:11.192214 [info ] [MainThread]: 
[0m21:44:11.194234 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:44:11.208812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test'
[0m21:44:11.234120 [debug] [ThreadPool]: Using postgres connection "list_prodia_test"
[0m21:44:11.235128 [debug] [ThreadPool]: On list_prodia_test: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test"} */

    select distinct nspname from pg_namespace
  
[0m21:44:11.236119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:11.326167 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:44:11.329680 [debug] [ThreadPool]: On list_prodia_test: Close
[0m21:44:11.335268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_prodia_test_public'
[0m21:44:11.347389 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m21:44:11.348390 [debug] [ThreadPool]: On list_prodia_test_public: BEGIN
[0m21:44:11.349390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:11.515621 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:44:11.516651 [debug] [ThreadPool]: Using postgres connection "list_prodia_test_public"
[0m21:44:11.517651 [debug] [ThreadPool]: On list_prodia_test_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "list_prodia_test_public"} */
select
      'prodia_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'prodia_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:44:11.529823 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m21:44:11.533950 [debug] [ThreadPool]: On list_prodia_test_public: ROLLBACK
[0m21:44:11.534952 [debug] [ThreadPool]: On list_prodia_test_public: Close
[0m21:44:11.553514 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:11.555053 [debug] [MainThread]: On master: BEGIN
[0m21:44:11.555053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:11.626660 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:44:11.628172 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:11.630191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:44:11.649789 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:44:11.653822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A32AD090>]}
[0m21:44:11.654822 [debug] [MainThread]: On master: ROLLBACK
[0m21:44:11.656805 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:11.657812 [debug] [MainThread]: On master: BEGIN
[0m21:44:11.658825 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:44:11.660357 [debug] [MainThread]: On master: COMMIT
[0m21:44:11.661378 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:11.662373 [debug] [MainThread]: On master: COMMIT
[0m21:44:11.664372 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:44:11.665389 [debug] [MainThread]: On master: Close
[0m21:44:11.667393 [info ] [MainThread]: Concurrency: 1 threads (target='postgres')
[0m21:44:11.669375 [info ] [MainThread]: 
[0m21:44:11.683447 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_first_dbt_model
[0m21:44:11.686448 [info ] [Thread-1 (]: 1 of 15 START sql table model public.my_first_dbt_model ........................ [RUN]
[0m21:44:11.690444 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.prodia_dbt.my_first_dbt_model'
[0m21:44:11.691448 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_first_dbt_model
[0m21:44:11.701657 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_first_dbt_model"
[0m21:44:11.708289 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (compile): 21:44:11.693648 => 21:44:11.707271
[0m21:44:11.711268 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_first_dbt_model
[0m21:44:11.818430 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_first_dbt_model"
[0m21:44:11.820427 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:44:11.822671 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: BEGIN
[0m21:44:11.823670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:44:11.886938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:11.887936 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:44:11.888939 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */

  
    

  create  table "prodia_test"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:44:11.896462 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m21:44:11.910977 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:44:11.912982 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:44:11.914978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:11.925540 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:44:11.927053 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
alter table "prodia_test"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:44:11.930071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:11.989579 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m21:44:11.992116 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:44:11.993136 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: COMMIT
[0m21:44:11.997135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:12.010684 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_first_dbt_model"
[0m21:44:12.013219 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_first_dbt_model"} */
drop table if exists "prodia_test"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:44:12.019232 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:12.022758 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_first_dbt_model (execute): 21:44:11.713816 => 21:44:12.022758
[0m21:44:12.024787 [debug] [Thread-1 (]: On model.prodia_dbt.my_first_dbt_model: Close
[0m21:44:12.027805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A3202210>]}
[0m21:44:12.029810 [info ] [Thread-1 (]: 1 of 15 OK created sql table model public.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.34s]
[0m21:44:12.032324 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_first_dbt_model
[0m21:44:12.034920 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_appointments
[0m21:44:12.036938 [info ] [Thread-1 (]: 2 of 15 START sql table model public.stg_appointments .......................... [RUN]
[0m21:44:12.039017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_first_dbt_model, now model.prodia_dbt.stg_appointments)
[0m21:44:12.040016 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_appointments
[0m21:44:12.049538 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_appointments"
[0m21:44:12.052525 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (compile): 21:44:12.042014 => 21:44:12.051531
[0m21:44:12.053524 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_appointments
[0m21:44:12.063080 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_appointments"
[0m21:44:12.066619 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:44:12.067611 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: BEGIN
[0m21:44:12.068610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:12.135028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:12.136033 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:44:12.137031 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */

  
    

  create  table "prodia_test"."public"."stg_appointments__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_appointments.sql



    select *
    from "prodia_test"."public"."appointments"

  );
  
[0m21:44:12.149556 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:44:12.155094 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:44:12.157129 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
alter table "prodia_test"."public"."stg_appointments" rename to "stg_appointments__dbt_backup"
[0m21:44:12.159106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:12.165629 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:44:12.166648 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
alter table "prodia_test"."public"."stg_appointments__dbt_tmp" rename to "stg_appointments"
[0m21:44:12.168632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:12.173170 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m21:44:12.175163 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:44:12.177162 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: COMMIT
[0m21:44:12.180162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:12.186374 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_appointments"
[0m21:44:12.187372 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_appointments"} */
drop table if exists "prodia_test"."public"."stg_appointments__dbt_backup" cascade
[0m21:44:12.192373 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:12.195885 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_appointments (execute): 21:44:12.053524 => 21:44:12.195885
[0m21:44:12.196891 [debug] [Thread-1 (]: On model.prodia_dbt.stg_appointments: Close
[0m21:44:12.198890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A333BE10>]}
[0m21:44:12.200907 [info ] [Thread-1 (]: 2 of 15 OK created sql table model public.stg_appointments ..................... [[32mSELECT 1000[0m in 0.16s]
[0m21:44:12.205445 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_appointments
[0m21:44:12.209481 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_doctors
[0m21:44:12.213463 [info ] [Thread-1 (]: 3 of 15 START sql table model public.stg_doctors ............................... [RUN]
[0m21:44:12.217039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_appointments, now model.prodia_dbt.stg_doctors)
[0m21:44:12.218548 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_doctors
[0m21:44:12.225573 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_doctors"
[0m21:44:12.228113 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (compile): 21:44:12.219582 => 21:44:12.227098
[0m21:44:12.229115 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_doctors
[0m21:44:12.239185 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_doctors"
[0m21:44:12.242192 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:44:12.243190 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: BEGIN
[0m21:44:12.244187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:12.314943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:12.315949 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:44:12.317949 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */

  
    

  create  table "prodia_test"."public"."stg_doctors__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_doctors.sql



    select *
    from "prodia_test"."public"."doctors"

  );
  
[0m21:44:12.335017 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:44:12.342022 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:44:12.343023 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
alter table "prodia_test"."public"."stg_doctors" rename to "stg_doctors__dbt_backup"
[0m21:44:12.345208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:12.352210 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:44:12.352210 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
alter table "prodia_test"."public"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m21:44:12.355745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:12.359755 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m21:44:12.360761 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:44:12.361762 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: COMMIT
[0m21:44:12.365287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:12.370291 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_doctors"
[0m21:44:12.372289 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_doctors"} */
drop table if exists "prodia_test"."public"."stg_doctors__dbt_backup" cascade
[0m21:44:12.378813 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:12.382814 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_doctors (execute): 21:44:12.231113 => 21:44:12.381819
[0m21:44:12.383813 [debug] [Thread-1 (]: On model.prodia_dbt.stg_doctors: Close
[0m21:44:12.385818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A3369390>]}
[0m21:44:12.387014 [info ] [Thread-1 (]: 3 of 15 OK created sql table model public.stg_doctors .......................... [[32mSELECT 1000[0m in 0.17s]
[0m21:44:12.389999 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_doctors
[0m21:44:12.391002 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_invoices
[0m21:44:12.393004 [info ] [Thread-1 (]: 4 of 15 START sql table model public.stg_invoices .............................. [RUN]
[0m21:44:12.394999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_doctors, now model.prodia_dbt.stg_invoices)
[0m21:44:12.396511 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_invoices
[0m21:44:12.403543 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_invoices"
[0m21:44:12.405545 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (compile): 21:44:12.397531 => 21:44:12.405545
[0m21:44:12.407058 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_invoices
[0m21:44:12.416102 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_invoices"
[0m21:44:12.418632 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:44:12.419637 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: BEGIN
[0m21:44:12.420649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:12.494263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:12.495267 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:44:12.497272 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */

  
    

  create  table "prodia_test"."public"."stg_invoices__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_billings.sql



    select *
    from "prodia_test"."public"."invoices"

  );
  
[0m21:44:12.511787 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:44:12.517940 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:44:12.518941 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
alter table "prodia_test"."public"."stg_invoices" rename to "stg_invoices__dbt_backup"
[0m21:44:12.520946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:12.527457 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:44:12.528461 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
alter table "prodia_test"."public"."stg_invoices__dbt_tmp" rename to "stg_invoices"
[0m21:44:12.531466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:12.534995 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m21:44:12.536128 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:44:12.537124 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: COMMIT
[0m21:44:12.540155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:12.545693 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_invoices"
[0m21:44:12.546718 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_invoices"} */
drop table if exists "prodia_test"."public"."stg_invoices__dbt_backup" cascade
[0m21:44:12.551716 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:12.554731 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_invoices (execute): 21:44:12.408079 => 21:44:12.554731
[0m21:44:12.556273 [debug] [Thread-1 (]: On model.prodia_dbt.stg_invoices: Close
[0m21:44:12.558291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A33DF0D0>]}
[0m21:44:12.560290 [info ] [Thread-1 (]: 4 of 15 OK created sql table model public.stg_invoices ......................... [[32mSELECT 1000[0m in 0.16s]
[0m21:44:12.562312 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_invoices
[0m21:44:12.564291 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_patients
[0m21:44:12.565291 [info ] [Thread-1 (]: 5 of 15 START sql table model public.stg_patients .............................. [RUN]
[0m21:44:12.568846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_invoices, now model.prodia_dbt.stg_patients)
[0m21:44:12.569867 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_patients
[0m21:44:12.577369 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_patients"
[0m21:44:12.579385 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (compile): 21:44:12.570867 => 21:44:12.578384
[0m21:44:12.581406 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_patients
[0m21:44:12.590929 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_patients"
[0m21:44:12.592931 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:44:12.593932 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: BEGIN
[0m21:44:12.594933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:12.661525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:12.664062 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:44:12.665059 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */

  
    

  create  table "prodia_test"."public"."stg_patients__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_patients.sql



    select *
    from "prodia_test"."public"."patients"

  );
  
[0m21:44:12.677657 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:44:12.684187 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:44:12.685219 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
alter table "prodia_test"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m21:44:12.687222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:12.693221 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:44:12.694735 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
alter table "prodia_test"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m21:44:12.696753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:12.700780 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m21:44:12.702783 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:44:12.703782 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: COMMIT
[0m21:44:12.705757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:12.718624 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_patients"
[0m21:44:12.719631 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_patients"} */
drop table if exists "prodia_test"."public"."stg_patients__dbt_backup" cascade
[0m21:44:12.724665 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:12.728172 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_patients (execute): 21:44:12.583405 => 21:44:12.728172
[0m21:44:12.729241 [debug] [Thread-1 (]: On model.prodia_dbt.stg_patients: Close
[0m21:44:12.730226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A3224090>]}
[0m21:44:12.731321 [info ] [Thread-1 (]: 5 of 15 OK created sql table model public.stg_patients ......................... [[32mSELECT 998[0m in 0.16s]
[0m21:44:12.734864 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_patients
[0m21:44:12.735863 [debug] [Thread-1 (]: Began running node model.prodia_dbt.stg_procedures
[0m21:44:12.736843 [info ] [Thread-1 (]: 6 of 15 START sql table model public.stg_procedures ............................ [RUN]
[0m21:44:12.740088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_patients, now model.prodia_dbt.stg_procedures)
[0m21:44:12.741107 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.stg_procedures
[0m21:44:12.748092 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.stg_procedures"
[0m21:44:12.749609 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (compile): 21:44:12.742093 => 21:44:12.749609
[0m21:44:12.750618 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.stg_procedures
[0m21:44:12.759119 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.stg_procedures"
[0m21:44:12.761129 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:44:12.763136 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: BEGIN
[0m21:44:12.764137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:12.828861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:12.829858 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:44:12.831863 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */

  
    

  create  table "prodia_test"."public"."stg_procedures__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_procedures.sql



    select *
    from "prodia_test"."public"."procedures"

  );
  
[0m21:44:12.842391 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:44:12.848931 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:44:12.850933 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
alter table "prodia_test"."public"."stg_procedures" rename to "stg_procedures__dbt_backup"
[0m21:44:12.851932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:12.858469 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:44:12.860471 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
alter table "prodia_test"."public"."stg_procedures__dbt_tmp" rename to "stg_procedures"
[0m21:44:12.862474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:12.865984 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m21:44:12.868015 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:44:12.869014 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: COMMIT
[0m21:44:12.872017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:12.877537 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.stg_procedures"
[0m21:44:12.878540 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.stg_procedures"} */
drop table if exists "prodia_test"."public"."stg_procedures__dbt_backup" cascade
[0m21:44:12.884855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:12.888399 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.stg_procedures (execute): 21:44:12.751616 => 21:44:12.888399
[0m21:44:12.889387 [debug] [Thread-1 (]: On model.prodia_dbt.stg_procedures: Close
[0m21:44:12.891387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A332E690>]}
[0m21:44:12.893388 [info ] [Thread-1 (]: 6 of 15 OK created sql table model public.stg_procedures ....................... [[32mSELECT 1000[0m in 0.15s]
[0m21:44:12.895371 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.stg_procedures
[0m21:44:12.897377 [debug] [Thread-1 (]: Began running node model.prodia_dbt.my_second_dbt_model
[0m21:44:12.899531 [info ] [Thread-1 (]: 7 of 15 START sql view model public.my_second_dbt_model ........................ [RUN]
[0m21:44:12.901531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.stg_procedures, now model.prodia_dbt.my_second_dbt_model)
[0m21:44:12.902532 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.my_second_dbt_model
[0m21:44:12.909071 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.my_second_dbt_model"
[0m21:44:12.911084 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (compile): 21:44:12.903512 => 21:44:12.910091
[0m21:44:12.912071 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.my_second_dbt_model
[0m21:44:12.956838 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.my_second_dbt_model"
[0m21:44:12.962380 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:44:12.968422 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: BEGIN
[0m21:44:12.969422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:13.034914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:13.034914 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:44:13.037455 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */

  create view "prodia_test"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "prodia_test"."public"."my_first_dbt_model"
where id = 1
  );
[0m21:44:13.045458 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:44:13.053001 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:44:13.053990 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
alter table "prodia_test"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:44:13.056005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:13.059525 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m21:44:13.061539 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:44:13.062526 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: COMMIT
[0m21:44:13.065524 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:13.071060 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.my_second_dbt_model"
[0m21:44:13.072059 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.my_second_dbt_model"} */
drop view if exists "prodia_test"."public"."my_second_dbt_model__dbt_backup" cascade
[0m21:44:13.073074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:44:13.077057 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.my_second_dbt_model (execute): 21:44:12.913070 => 21:44:13.077057
[0m21:44:13.078060 [debug] [Thread-1 (]: On model.prodia_dbt.my_second_dbt_model: Close
[0m21:44:13.080487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A340C590>]}
[0m21:44:13.082489 [info ] [Thread-1 (]: 7 of 15 OK created sql view model public.my_second_dbt_model ................... [[32mCREATE VIEW[0m in 0.18s]
[0m21:44:13.084492 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.my_second_dbt_model
[0m21:44:13.086486 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_invoice_summary
[0m21:44:13.088480 [info ] [Thread-1 (]: 8 of 15 START sql table model public.int_invoice_summary ....................... [RUN]
[0m21:44:13.090742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.my_second_dbt_model, now model.prodia_dbt.int_invoice_summary)
[0m21:44:13.091740 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_invoice_summary
[0m21:44:13.098743 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_invoice_summary"
[0m21:44:13.102270 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (compile): 21:44:13.092745 => 21:44:13.101274
[0m21:44:13.104286 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_invoice_summary
[0m21:44:13.113809 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_invoice_summary"
[0m21:44:13.116807 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:44:13.117798 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: BEGIN
[0m21:44:13.118799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:13.184753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:13.186315 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:44:13.187324 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */

  
    

  create  table "prodia_test"."public"."int_invoice_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_invoice_summary.sql



with invoice_summary as (
    select
        i.InvoiceID,
        i.PatientID,
        sum(i.Amount) as total_amount,
        count(i.Items) as item_count
    from
        "prodia_test"."public"."stg_invoices" i
    group by
        i.InvoiceID,
        i.PatientID
)

select * from invoice_summary
  );
  
[0m21:44:13.205386 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:44:13.217555 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:44:13.219300 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */
alter table "prodia_test"."public"."int_invoice_summary" rename to "int_invoice_summary__dbt_backup"
[0m21:44:13.221311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:13.226821 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:44:13.228334 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */
alter table "prodia_test"."public"."int_invoice_summary__dbt_tmp" rename to "int_invoice_summary"
[0m21:44:13.230347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:13.235416 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m21:44:13.236413 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:44:13.238938 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: COMMIT
[0m21:44:13.243979 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:13.252546 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_invoice_summary"
[0m21:44:13.253547 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_invoice_summary"} */
drop table if exists "prodia_test"."public"."int_invoice_summary__dbt_backup" cascade
[0m21:44:13.264102 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:13.268102 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_invoice_summary (execute): 21:44:13.105278 => 21:44:13.268102
[0m21:44:13.270100 [debug] [Thread-1 (]: On model.prodia_dbt.int_invoice_summary: Close
[0m21:44:13.273664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A33AB810>]}
[0m21:44:13.275661 [info ] [Thread-1 (]: 8 of 15 OK created sql table model public.int_invoice_summary .................. [[32mSELECT 1000[0m in 0.18s]
[0m21:44:13.278658 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_invoice_summary
[0m21:44:13.280660 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_patient_summary
[0m21:44:13.283187 [info ] [Thread-1 (]: 9 of 15 START sql table model public.int_patient_summary ....................... [RUN]
[0m21:44:13.287209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_invoice_summary, now model.prodia_dbt.int_patient_summary)
[0m21:44:13.289200 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_patient_summary
[0m21:44:13.300758 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_patient_summary"
[0m21:44:13.304278 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (compile): 21:44:13.290204 => 21:44:13.304278
[0m21:44:13.307280 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_patient_summary
[0m21:44:13.321840 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_patient_summary"
[0m21:44:13.324349 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:44:13.325368 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: BEGIN
[0m21:44:13.326369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:13.499167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:13.500166 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:44:13.501167 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */

  
    

  create  table "prodia_test"."public"."int_patient_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_patient_summary.sql


with patient_appointments as (
    select
        p.PatientID,
        p.firstname,
        p.lastname,
        count(a.AppointmentID) as total_appointments
    from
        "prodia_test"."public"."stg_patients" p
    left join
        "prodia_test"."public"."stg_appointments" a on p.PatientID = a.PatientID
    group by
        p.PatientID,
        p.firstname,
        p.lastname
)

select * from patient_appointments
  );
  
[0m21:44:13.517213 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:44:13.523227 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:44:13.524238 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
alter table "prodia_test"."public"."int_patient_summary" rename to "int_patient_summary__dbt_backup"
[0m21:44:13.525238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:13.532804 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:44:13.534805 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
alter table "prodia_test"."public"."int_patient_summary__dbt_tmp" rename to "int_patient_summary"
[0m21:44:13.535983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:13.540581 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m21:44:13.541547 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:44:13.542563 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: COMMIT
[0m21:44:13.545556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:13.551125 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_patient_summary"
[0m21:44:13.552125 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_patient_summary"} */
drop table if exists "prodia_test"."public"."int_patient_summary__dbt_backup" cascade
[0m21:44:13.557114 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:13.561467 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_patient_summary (execute): 21:44:13.308276 => 21:44:13.560457
[0m21:44:13.562454 [debug] [Thread-1 (]: On model.prodia_dbt.int_patient_summary: Close
[0m21:44:13.563456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A32D2090>]}
[0m21:44:13.565450 [info ] [Thread-1 (]: 9 of 15 OK created sql table model public.int_patient_summary .................. [[32mSELECT 998[0m in 0.28s]
[0m21:44:13.567459 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_patient_summary
[0m21:44:13.569441 [debug] [Thread-1 (]: Began running node model.prodia_dbt.int_appointment_details
[0m21:44:13.571568 [info ] [Thread-1 (]: 10 of 15 START sql table model public.int_appointment_details .................. [RUN]
[0m21:44:13.573553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_patient_summary, now model.prodia_dbt.int_appointment_details)
[0m21:44:13.574553 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.int_appointment_details
[0m21:44:13.585101 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.int_appointment_details"
[0m21:44:13.587117 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (compile): 21:44:13.575552 => 21:44:13.586131
[0m21:44:13.588105 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.int_appointment_details
[0m21:44:13.596429 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.int_appointment_details"
[0m21:44:13.599420 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:44:13.600430 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: BEGIN
[0m21:44:13.601434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:13.667683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:13.668694 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:44:13.669694 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */

  
    

  create  table "prodia_test"."public"."int_appointment_details__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_appointment_details.sql



with appointment_info as (
    select
        a.AppointmentID,
        a.AppointmentDate,
        a.AppointmentTime,
        p.PatientID,
        concat(p.firstname, ' ', p.lastname) as patient_name,
        d.DoctorName,
        pr.ProcedureName,
        case when a.AppointmentDate < CURRENT_DATE then 1 else 0 end as is_overdue
    from
        "prodia_test"."public"."stg_appointments" a
    join
        "prodia_test"."public"."stg_patients" p on a.PatientID = p.PatientID
    join
        "prodia_test"."public"."stg_doctors" d on a.DoctorID = d.DoctorID
    left join
        "prodia_test"."public"."stg_procedures" pr on a.AppointmentID = pr.AppointmentID
)

select * from appointment_info
  );
  
[0m21:44:13.690802 [debug] [Thread-1 (]: SQL status: SELECT 1367 in 0.0 seconds
[0m21:44:13.697773 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:44:13.699215 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
alter table "prodia_test"."public"."int_appointment_details" rename to "int_appointment_details__dbt_backup"
[0m21:44:13.701219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:13.707228 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:44:13.708759 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
alter table "prodia_test"."public"."int_appointment_details__dbt_tmp" rename to "int_appointment_details"
[0m21:44:13.713804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:13.722392 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m21:44:13.723393 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:44:13.725413 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: COMMIT
[0m21:44:13.729412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:13.735131 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.int_appointment_details"
[0m21:44:13.736148 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.int_appointment_details"} */
drop table if exists "prodia_test"."public"."int_appointment_details__dbt_backup" cascade
[0m21:44:13.746671 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:13.749671 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.int_appointment_details (execute): 21:44:13.589119 => 21:44:13.749671
[0m21:44:13.751181 [debug] [Thread-1 (]: On model.prodia_dbt.int_appointment_details: Close
[0m21:44:13.754195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A314DED0>]}
[0m21:44:13.756195 [info ] [Thread-1 (]: 10 of 15 OK created sql table model public.int_appointment_details ............. [[32mSELECT 1367[0m in 0.18s]
[0m21:44:13.759197 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.int_appointment_details
[0m21:44:13.761694 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_patient_overview
[0m21:44:13.762710 [info ] [Thread-1 (]: 11 of 15 START sql table model public.dm_patient_overview ...................... [RUN]
[0m21:44:13.765725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.int_appointment_details, now model.prodia_dbt.dm_patient_overview)
[0m21:44:13.767723 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_patient_overview
[0m21:44:13.775255 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_patient_overview"
[0m21:44:13.778261 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (compile): 21:44:13.768719 => 21:44:13.777255
[0m21:44:13.779260 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_patient_overview
[0m21:44:13.788799 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_patient_overview"
[0m21:44:13.790802 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:44:13.791793 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: BEGIN
[0m21:44:13.793801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:13.861990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:13.862990 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:44:13.864992 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */

  
    

  create  table "prodia_test"."public"."dm_patient_overview__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_patient_overview.sql



with patient_overview as (
    select
        ps.PatientID,
        ps.firstname,
        ps.lastname,
        SUM(ps.total_appointments) as total_appointments,
        COALESCE(SUM(ins.total_amount), 0) AS total_spent
    from
        "prodia_test"."public"."int_patient_summary" ps
    left join
        "prodia_test"."public"."int_invoice_summary" ins on ps.PatientID = ins.PatientID
    group by
        ps.PatientID, 
        ps.firstname, 
        ps.lastname
), patient_segment as (
    select 
        *,
        CASE
            WHEN total_spent > 1000 THEN 'High Spender'
            WHEN total_appointments > 10 THEN 'Frequent User'
            ELSE 'Occasional User'
        END AS customer_segment 
        from patient_overview
)

select * from patient_segment
  );
  
[0m21:44:13.888047 [debug] [Thread-1 (]: SQL status: SELECT 998 in 0.0 seconds
[0m21:44:13.895588 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:44:13.896594 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */
alter table "prodia_test"."public"."dm_patient_overview" rename to "dm_patient_overview__dbt_backup"
[0m21:44:13.898584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:13.905137 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:44:13.907139 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */
alter table "prodia_test"."public"."dm_patient_overview__dbt_tmp" rename to "dm_patient_overview"
[0m21:44:13.909134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:13.912659 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: COMMIT
[0m21:44:13.914656 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:44:13.915666 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: COMMIT
[0m21:44:13.918660 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:13.924082 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_patient_overview"
[0m21:44:13.925079 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_patient_overview"} */
drop table if exists "prodia_test"."public"."dm_patient_overview__dbt_backup" cascade
[0m21:44:13.932591 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:13.936106 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_patient_overview (execute): 21:44:13.780260 => 21:44:13.935593
[0m21:44:13.937113 [debug] [Thread-1 (]: On model.prodia_dbt.dm_patient_overview: Close
[0m21:44:13.939108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A33F6E10>]}
[0m21:44:13.941109 [info ] [Thread-1 (]: 11 of 15 OK created sql table model public.dm_patient_overview ................. [[32mSELECT 998[0m in 0.17s]
[0m21:44:13.943114 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_patient_overview
[0m21:44:13.945596 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_appointment_summary
[0m21:44:13.947608 [info ] [Thread-1 (]: 12 of 15 START sql table model public.dm_appointment_summary ................... [RUN]
[0m21:44:13.949605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_patient_overview, now model.prodia_dbt.dm_appointment_summary)
[0m21:44:13.950605 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_appointment_summary
[0m21:44:13.958664 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_appointment_summary"
[0m21:44:13.962686 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (compile): 21:44:13.951607 => 21:44:13.960695
[0m21:44:13.967270 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_appointment_summary
[0m21:44:13.976780 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_appointment_summary"
[0m21:44:13.979311 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:44:13.980301 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: BEGIN
[0m21:44:13.982306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:14.053503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:14.054505 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:44:14.055503 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */

  
    

  create  table "prodia_test"."public"."dm_appointment_summary__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_appointment_summary.sql



with appointment_summary as (
    select
        ad.AppointmentDate,
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        COUNT(DISTINCT ad.ProcedureName) AS total_procedures
    from
        "prodia_test"."public"."int_appointment_details" ad
    group by
        ad.AppointmentDate, 
        ad.DoctorName
)

select * from appointment_summary
  );
  
[0m21:44:14.068838 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m21:44:14.075373 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:44:14.076372 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
alter table "prodia_test"."public"."dm_appointment_summary" rename to "dm_appointment_summary__dbt_backup"
[0m21:44:14.078392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:14.084893 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:44:14.085896 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
alter table "prodia_test"."public"."dm_appointment_summary__dbt_tmp" rename to "dm_appointment_summary"
[0m21:44:14.087894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:14.092401 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m21:44:14.096421 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:44:14.097417 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: COMMIT
[0m21:44:14.100415 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:14.105933 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_appointment_summary"
[0m21:44:14.106927 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_appointment_summary"} */
drop table if exists "prodia_test"."public"."dm_appointment_summary__dbt_backup" cascade
[0m21:44:14.111936 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:14.115993 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_appointment_summary (execute): 21:44:13.970267 => 21:44:14.114966
[0m21:44:14.115993 [debug] [Thread-1 (]: On model.prodia_dbt.dm_appointment_summary: Close
[0m21:44:14.116973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A305EBD0>]}
[0m21:44:14.119254 [info ] [Thread-1 (]: 12 of 15 OK created sql table model public.dm_appointment_summary .............. [[32mSELECT 999[0m in 0.17s]
[0m21:44:14.122258 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_appointment_summary
[0m21:44:14.123259 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_cohort_analysis
[0m21:44:14.124758 [info ] [Thread-1 (]: 13 of 15 START sql table model public.dm_cohort_analysis ....................... [RUN]
[0m21:44:14.127787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_appointment_summary, now model.prodia_dbt.dm_cohort_analysis)
[0m21:44:14.128795 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_cohort_analysis
[0m21:44:14.137438 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_cohort_analysis"
[0m21:44:14.140420 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_cohort_analysis (compile): 21:44:14.130793 => 21:44:14.139426
[0m21:44:14.141426 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_cohort_analysis
[0m21:44:14.150971 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_cohort_analysis"
[0m21:44:14.152992 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:44:14.154978 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: BEGIN
[0m21:44:14.154978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:14.225850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:14.226867 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:44:14.227871 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_cohort_analysis"} */

  
    

  create  table "prodia_test"."public"."dm_cohort_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_cohort_analysis.sql



with cohort_analysis as (
    select 
        DATE_TRUNC('month', AppointmentDate) AS cohort_month,
        COUNT(DISTINCT PatientID) AS patients_in_cohort
    from
        "prodia_test"."public"."int_appointment_details"
    group by
        cohort_month  
)

select * from cohort_analysis
  );
  
[0m21:44:14.239777 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.0 seconds
[0m21:44:14.246884 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:44:14.247884 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_cohort_analysis"} */
alter table "prodia_test"."public"."dm_cohort_analysis" rename to "dm_cohort_analysis__dbt_backup"
[0m21:44:14.249887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:14.256432 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:44:14.257443 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_cohort_analysis"} */
alter table "prodia_test"."public"."dm_cohort_analysis__dbt_tmp" rename to "dm_cohort_analysis"
[0m21:44:14.259432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:14.263992 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: COMMIT
[0m21:44:14.265983 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:44:14.266981 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: COMMIT
[0m21:44:14.269986 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:14.275557 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_cohort_analysis"
[0m21:44:14.276567 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_cohort_analysis"} */
drop table if exists "prodia_test"."public"."dm_cohort_analysis__dbt_backup" cascade
[0m21:44:14.281561 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:14.284565 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_cohort_analysis (execute): 21:44:14.142412 => 21:44:14.284565
[0m21:44:14.286942 [debug] [Thread-1 (]: On model.prodia_dbt.dm_cohort_analysis: Close
[0m21:44:14.288937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A341DA90>]}
[0m21:44:14.290934 [info ] [Thread-1 (]: 13 of 15 OK created sql table model public.dm_cohort_analysis .................. [[32mSELECT 48[0m in 0.16s]
[0m21:44:14.292952 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_cohort_analysis
[0m21:44:14.293951 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_doctor_performance
[0m21:44:14.295476 [info ] [Thread-1 (]: 14 of 15 START sql table model public.dm_doctor_performance .................... [RUN]
[0m21:44:14.298484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_cohort_analysis, now model.prodia_dbt.dm_doctor_performance)
[0m21:44:14.299484 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_doctor_performance
[0m21:44:14.306665 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_doctor_performance"
[0m21:44:14.309655 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_doctor_performance (compile): 21:44:14.300488 => 21:44:14.308663
[0m21:44:14.310664 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_doctor_performance
[0m21:44:14.320181 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_doctor_performance"
[0m21:44:14.322195 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_doctor_performance"
[0m21:44:14.324199 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: BEGIN
[0m21:44:14.325198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:14.391830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:14.392831 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_doctor_performance"
[0m21:44:14.394820 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_doctor_performance"} */

  
    

  create  table "prodia_test"."public"."dm_doctor_performance__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_doctor_performance.sql



with doctor_performance as (
    SELECT
        ad.DoctorName,
        COUNT(ad.AppointmentID) AS total_appointments,
        SUM(i.total_amount) AS total_revenue
    FROM
        "prodia_test"."public"."int_appointment_details" ad
    LEFT JOIN
        "prodia_test"."public"."int_invoice_summary" i ON ad.PatientID = i.PatientID
    GROUP BY
        ad.DoctorName
)

select * from doctor_performance
  );
  
[0m21:44:14.413460 [debug] [Thread-1 (]: SQL status: SELECT 416 in 0.0 seconds
[0m21:44:14.420488 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_doctor_performance"
[0m21:44:14.421477 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_doctor_performance"} */
alter table "prodia_test"."public"."dm_doctor_performance__dbt_tmp" rename to "dm_doctor_performance"
[0m21:44:14.424016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:14.428024 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: COMMIT
[0m21:44:14.429026 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_doctor_performance"
[0m21:44:14.430027 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: COMMIT
[0m21:44:14.433520 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:14.441048 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_doctor_performance"
[0m21:44:14.443053 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_doctor_performance"} */
drop table if exists "prodia_test"."public"."dm_doctor_performance__dbt_backup" cascade
[0m21:44:14.444565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:14.448597 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_doctor_performance (execute): 21:44:14.311673 => 21:44:14.448597
[0m21:44:14.449598 [debug] [Thread-1 (]: On model.prodia_dbt.dm_doctor_performance: Close
[0m21:44:14.452588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A314DED0>]}
[0m21:44:14.453596 [info ] [Thread-1 (]: 14 of 15 OK created sql table model public.dm_doctor_performance ............... [[32mSELECT 416[0m in 0.15s]
[0m21:44:14.457148 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_doctor_performance
[0m21:44:14.459127 [debug] [Thread-1 (]: Began running node model.prodia_dbt.dm_monthly_revenue
[0m21:44:14.463128 [info ] [Thread-1 (]: 15 of 15 START sql table model public.dm_monthly_revenue ....................... [RUN]
[0m21:44:14.470732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.prodia_dbt.dm_doctor_performance, now model.prodia_dbt.dm_monthly_revenue)
[0m21:44:14.472715 [debug] [Thread-1 (]: Began compiling node model.prodia_dbt.dm_monthly_revenue
[0m21:44:14.478258 [debug] [Thread-1 (]: Writing injected SQL for node "model.prodia_dbt.dm_monthly_revenue"
[0m21:44:14.481788 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_monthly_revenue (compile): 21:44:14.473717 => 21:44:14.480791
[0m21:44:14.482789 [debug] [Thread-1 (]: Began executing node model.prodia_dbt.dm_monthly_revenue
[0m21:44:14.492303 [debug] [Thread-1 (]: Writing runtime sql for node "model.prodia_dbt.dm_monthly_revenue"
[0m21:44:14.494307 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:44:14.495301 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: BEGIN
[0m21:44:14.496303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:14.668167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:44:14.669693 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:44:14.671685 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_monthly_revenue"} */

  
    

  create  table "prodia_test"."public"."dm_monthly_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/datamart/dm_monthly_revenue.sql



WITH monthly_trends AS (
    SELECT
        DATE_TRUNC('month', AppointmentDate) AS month,
        COUNT(AppointmentID) AS total_appointments,
        SUM(total_amount) AS total_revenue
    FROM
        "prodia_test"."public"."int_appointment_details" ad
    JOIN
        "prodia_test"."public"."int_invoice_summary" i ON ad.PatientID = i.PatientID
    GROUP BY
        month
)

select * from monthly_trends
  );
  
[0m21:44:14.693755 [debug] [Thread-1 (]: SQL status: SELECT 48 in 0.0 seconds
[0m21:44:14.703275 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:44:14.704277 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_monthly_revenue"} */
alter table "prodia_test"."public"."dm_monthly_revenue" rename to "dm_monthly_revenue__dbt_backup"
[0m21:44:14.706274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:14.715811 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:44:14.717811 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_monthly_revenue"} */
alter table "prodia_test"."public"."dm_monthly_revenue__dbt_tmp" rename to "dm_monthly_revenue"
[0m21:44:14.719807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:14.730771 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: COMMIT
[0m21:44:14.733296 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:44:14.734298 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: COMMIT
[0m21:44:14.736807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:44:14.743328 [debug] [Thread-1 (]: Using postgres connection "model.prodia_dbt.dm_monthly_revenue"
[0m21:44:14.744338 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "prodia_dbt", "target_name": "postgres", "node_id": "model.prodia_dbt.dm_monthly_revenue"} */
drop table if exists "prodia_test"."public"."dm_monthly_revenue__dbt_backup" cascade
[0m21:44:14.750333 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:14.753847 [debug] [Thread-1 (]: Timing info for model.prodia_dbt.dm_monthly_revenue (execute): 21:44:14.483783 => 21:44:14.753847
[0m21:44:14.755865 [debug] [Thread-1 (]: On model.prodia_dbt.dm_monthly_revenue: Close
[0m21:44:14.757858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b821e70-5f0d-46b2-9db5-a3852d06588e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A442EE10>]}
[0m21:44:14.758859 [info ] [Thread-1 (]: 15 of 15 OK created sql table model public.dm_monthly_revenue .................. [[32mSELECT 48[0m in 0.29s]
[0m21:44:14.761860 [debug] [Thread-1 (]: Finished running node model.prodia_dbt.dm_monthly_revenue
[0m21:44:14.765388 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:14.766384 [debug] [MainThread]: On master: BEGIN
[0m21:44:14.767382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:44:14.832566 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:44:14.833566 [debug] [MainThread]: On master: COMMIT
[0m21:44:14.835577 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:14.835577 [debug] [MainThread]: On master: COMMIT
[0m21:44:14.838119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:44:14.839123 [debug] [MainThread]: On master: Close
[0m21:44:14.840654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:14.842667 [debug] [MainThread]: Connection 'list_prodia_test' was properly closed.
[0m21:44:14.843672 [debug] [MainThread]: Connection 'list_prodia_test_public' was properly closed.
[0m21:44:14.844684 [debug] [MainThread]: Connection 'model.prodia_dbt.dm_monthly_revenue' was properly closed.
[0m21:44:14.845678 [info ] [MainThread]: 
[0m21:44:14.847668 [info ] [MainThread]: Finished running 14 table models, 1 view model in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m21:44:14.856791 [debug] [MainThread]: Command end result
[0m21:44:14.875823 [info ] [MainThread]: 
[0m21:44:14.877825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:44:14.879832 [info ] [MainThread]: 
[0m21:44:14.881824 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m21:44:14.885194 [debug] [MainThread]: Command `dbt run` succeeded at 21:44:14.884185 after 6.11 seconds
[0m21:44:14.886185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A2F30390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001559C31BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A32BD350>]}
[0m21:44:14.887179 [debug] [MainThread]: Flushing usage events
